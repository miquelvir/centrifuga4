{"version":3,"sources":["theme.js","_context/user-context.js","_components/PrivateRoute.js","_helpers/auth-header.js","config.js","_services/service-factory.js","_services/students.service.js","_skeletons/iconButton.js","_components/dirtytextfield.component.js","_data/countries.js","_components/contry-select.component.js","_helpers/handle-response.js","_helpers/normik.js","_data/education.js","_components/formik_discard_button.js","_helpers/needs.js","_components/formik_save_button.js","_data/password_regex.js","_yup/validators.js","_components/students.student.person.component.js","_services/guardians.service.js","_services/payments.service.js","_data/payment_methods.js","_data/empty_objects.js","_context/loading-context.js","_context/confirm-context.js","_components/students.student.attendee.component.js","_services/emailsGrants.service.js","_services/emailsEnrollment.service.js","_services/student_guardians.service.js","_data/relations.js","_components/students.student.guardian.component.js","_components/students.student.payments.payment.component.js","_services/emailsReceipts.service.js","_components/students.student.payments.component.js","_services/schedules.service.js","_context/tab-context.js","_components/scheduler.component.js","_components/students.student.schedule.component.js","_services/student_courses.service.js","_services/courses.service.js","_components/searchbar.component.js","_context/theme-context.js","_components/ExportSearchChip.component.js","_components/items_list.component.js","_components/items_list_secondary.component.js","_components/items_list_terciary.component.js","_components/subresource_add_delete.component.js","_components/tab.js","_components/students.student.component.js","_components/items_list_main.component.js","_components/students.component.js","_components/user.role-select.component.js","_services/userInvites.service.js","_services/users.service.js","_services/teachers.service.js","_components/users.user.userperson.component.js","_services/user_needs.service.js","_components/dirty_checkbox.js","_helpers/set_operations.js","_components/users.user.permissions.component.js","_components/users.user.component.js","_components/users.component.js","_components/payments.component.js","_services/rooms.service.js","_components/rooms.room.schedule.component.js","_components/rooms.room.details.component.js","_components/rooms.room.component.js","_components/rooms.component.js","_services/teachers_courses.service.js","_services/calendar.service.js","_components/teachers.teacher.details.component.js","_components/teachers.teacher.schedule.component.js","_components/teachers.teacher.component.js","_components/teachers.component.js","_services/course_rooms.service.js","_services/course_students.service.js","_services/course_teachers.service.js","_components/courses.course.details.component.js","_data/price_term.js","_services/course_labels.service.js","_components/labels_selection.component.js","_components/courses.course.labels.component.js","_components/courses.course.schedule.component.js","_components/courses.course.component.js","_components/courses.component.js","_services/bulkEmail.service.js","_components/emailTo.component.js","_components/email.component.js","HomePage/routes.js","_services/god.service.js","_services/auth.service.js","i18nextConf.js","_translations/utils.js","_components/translate_button.component.js","_components/theme_button.component.js","_components/teacher_dashboard_button.js","_components/toolbar.home.component.js","HomePage/HomePage.js","_services/password-reset.service.js","_helpers/on-mount.js","LoginPage/LoginPage.js","_services/signup.service.js","SignupPage/SignupPage.js","ResetPage/ResetPage.js","_components/xamfra.logo.component.js","_services/pre-enrolment.service.js","utils/localized-weekdays.js","_components/xamfra.header.component.js","PreEnrolmentPage/PreEnrolmentPage.js","_components/home_button.js","TeacherDashboardPage/components/WelcomeTitle.js","TeacherDashboardPage/components/CourseCard.js","TeacherDashboardPage/components/MoreButton.js","TeacherDashboardPage/components/NotATeacherTitle.js","TeacherDashboardPage/TeacherDashboardPage.js","_components/not_found.js","_services/attendance.service.js","AttendancePage/components/attendance.component.item.js","AttendancePage/components/status.js","AttendancePage/components/commentDialog.js","AttendancePage/components/attendance.component.js","AttendancePage/AttendancePage.js","App/App.js","reportWebVitals.js","index.js"],"names":["lightTheme","createMuiTheme","palette","type","primary","main","light","dark","contrastText","emphasisText","high","medium","low","secondary","neutral","status","dirty","success","error","darkTheme","userContext","React","createContext","user","setUser","needs","setNeeds","teacher","setTeacher","PrivateRoute","Component","component","rest","userCtx","useContext","render","props","to","pathname","state","from","location","authHeader","Cookies","get","API_VERSION","process","BACKEND_URL","RECAPTCHA","PUBLIC_URL","CHECK_NEEDS","REACT_CHECK_NEEDS","axios","require","serviceFactory","resource","subresource","serviceName","baseUrl","apiVersion","url","likeSearchText","page","include","filters","parent_id","Promise","resolve","reject","myFilters","JSON","stringify","name","value","Object","keys","forEach","key","method","params","headers","then","response","data","catch","err","id","ids","length","getOne","join","res","body","initial_values","dirtyBody","reduce","filtered","subresourcId","subresourceid","subresourceId","all","map","delete","searchtermfield","searchterm","responseType","filename","split","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","appendChild","click","remove","IconButtonSkeleton","Skeleton","variant","IconButton","useStyles","makeStyles","theme","createStyles","root","color","borderBottomColor","DirtyTextField","formik","noDirty","values","initialValues","classes","formikProps","undefined","onChange","handleChange","onBlur","handleBlur","errors","helperText","touched","TextField","className","InputLabelProps","shrink","countries","code","label","phone","suggested","textField","borderColor","option","fontSize","marginRight","DirtyCountrySelect","style","width","getInitialOption","find","x","useState","_setOption","useEffect","inputValue","setInputValue","t","useTranslation","Autocomplete","options","autoHighlight","getOptionLabel","getOptionSelected","o","event","newValue","newOption","setFieldValue","setOption","onInputChange","newInputValue","renderOption","Fragment","isoCode","String","fromCodePoint","toUpperCase","replace","char","charCodeAt","renderInput","inputProps","autoComplete","useErrorHandler","useSnackbar","enqueueSnackbar","closeSnackbar","successHandlerFactory","snackbarSuccess","successHandler","failureHandler401","logged","ping","failureHandler403","failureHandler","handle401","handle403","handle400","errorOut","reportUnexpected","handler","request","text","showSnackbar","parse","message","autoHideDuration","action","src","alt","height","Button","onClick","navigator","clipboard","writeText","platform","userAgent","appVersion","vendor","r","alert","failureHandlerUnexpected","failureHandlerFactory","useNormik","onlyChangedValuesOnSubmit","allowArrays","originalInitialValues","nullSafeInitialValues","entries","oldOnSubmit","onSubmit","nullSafeOnSubmit","actions","normalizedValues","normalizedValue","Array","isArray","useFormik","education_years","DiscardButton","handleReset","disabled","isSubmitting","Tooltip","title","NEEDS","patch","post","send_email","invite_users","students","courses","guardians","payments","rooms","schedules","teachers","users","paymentReceipts","attendance","useNeeds","every","need","includes","SaveButton","hasNeeds","longer_8","shorter_64","has_lowercase","has_uppercase","has_digit","has_special","no_plus","safe_password","RegExp","source","yup","required","matches","safe_password_repetition","oneOf","safe_username_email","email","safe_username_email_required","safe_username_required","safe_email_required","safe_email","one_of","test","toString","v","line","marginTop","spacing","composite","display","flexDirection","flex","flexWrap","gap","actionIcon","float","Person","elements","currentPerson","dataService","patchService","newPerson","updateCurrentPerson","updateCurrentStudent","additionalFields","additionalValidation","onUpdate","studentId","loading","errorHandler","validationSchema","is_studying","is_working","career","when","is","education_entity","education_year","enableReinitialize","changedValues","setStatus","setSubmitting","new_id","finally","patched_body","resetForm","Box","clear","idx","py","handleSubmit","my","Divider","select","MenuItem","level","idx2","cloneElement","payment_methods","surname1","surname2","address","city","zip","dni","gender","country_of_origin","emptyGuardian","relation","emptyAttendee","price_term","payment_comments","birth_date","other_comments","image_agreement","enrolment_status","default_payment_method","loadingContext","startLoading","stopLoading","confirmContext","confirm","subtitle","successCallable","button","margin","Attendee","children","setNewStudent","addStudentId","newStudent","currentStudent","deleteStudent","addNewGuardian","loadingCtx","sendGrantLetter","sendEnrollmentAgreement","p","px","e","StudentsDataService","PaymentsDataService","deleteMany","GuardiansDataService","deleteFullStudent","changedBody","InputProps","endAdornment","InputAdornment","position","multiline","rowsMax","s","startIcon","downloadSubresource","student_guardian_relations","Guardian","guardianId","deleteGuardianId","addGuardianId","deleteNewGuardian","newGuardian","guardian","setGuardian","StudentGuardianDataService","postWithId","maxWidth","backgroundColor","expand","transform","marginLeft","transition","transitions","create","duration","shortest","expandOpen","avatar","PaymentCard","payment","updatePayment","deletePayment","newPayment","addPaymentId","student_id","expanded","setExpanded","sendReceipt","sendReceiptEmail","quantity","date","Card","CardHeader","Avatar","subheader","CardActions","disableSpacing","clsx","Collapse","in","timeout","unmountOnExit","CardContent","DialogActions","getDefaultValues","Date","dd","getDate","mm","getMonth","yyyy","getFullYear","newLine","Payments","paymentIds","deletePaymentFromStudent","setPayments","newPaymentCard","setNewPaymentCard","getMany","sort","p1","p2","localeCompare","_","Typography","tabContext","currentTab","goTo","eventFromSchedule","schedule","daysOfWeek","groupId","startTime","endTime","textColor","extendedProps","evaluate","expression","console","log","args","Scheduler","snapDuration","allowView","viewUrl","allowDelete","selectable","scheduleIds","viewStudent","deleteCustom","setScheduleIds","onEventSelected","onEventClick","onEventChange","editable","useTheme","calendarRef","createRef","StyleWrapper","styled","div","setSchedules","SchedulesDataService","withScheduleInfo","info","getDay","toLocaleTimeString","hour12","open","currentSchedule","setCurrentSchedule","handleClose","minHeight","Dialog","onClose","DialogTitle","filter","plugins","timeGridPlugin","interactionPlugin","initialView","firstDay","ref","buttonText","prev","next","prevYear","nextYear","today","month","week","day","selectMirror","dayMaxEvents","weekends","events","eventAdd","eventChange","clickInfo","eventRemove","selectInfo","view","calendar","unselect","start","end","eventContent","eventClick","handleClickOpen","eventTimeFormat","hour","minute","eventResize","eventDrop","Schedule","padding","alignItems","input","iconButton","SearchBar","searchTitle","onSearch","Paper","InputBase","placeholder","onKeyPress","preventDefault","themeContext","switchTheme","ExportSearchChip","searchTermField","searchTerm","exportAll","getFilters","Chip","size","downloadCsv","overflow","list","searchAndFilters","pagination","chip","selectedAvatar","chips","heading","typography","pxToRem","fontWeight","fontWeightRegular","noResults","textAlign","ItemsList","setCurrentItemId","auxFields","displayText","onItemClick","secondaryDisplayNameField","secondaryAction","secondaryActionNeeds","secondaryActionTooltip","secondaryActionIcon","secondaryActionCallable","withAvatar","withFiltersBox","currentItemId","items","setItems","displayNameField","usableFilters","defaultSearchBy","searchByOptions","searchBarLabel","exportPage","exportAllPages","setSearchTerm","f","initialValue","setFilters","searchBy","setSearchBy","setPage","count","setCount","fromEntries","search","getAll","Set","target","Accordion","AccordionSummary","expandIcon","AccordionDetails","tooltip","Pagination","showFirstButton","showLastButton","siblingCount","boundaryCount","List","item","ListItem","ListItemAvatar","charAt","ListItemText","ListItemSecondaryAction","edge","ItemsListSecondary","deleteTooltip","delete_message","onItemDeleted","ItemsListTerciary","dataServiceSR","add_message","onAdded","newItem","Transition","forwardRef","Slide","direction","box","appBar","AddDeleteSubresource","parentItemDataService","itemDataService","add_message_confirm","resourceName","onSubresourceAdded","onSubresourceDeleted","addDialogOpen","setAddDialogOpen","handleAddDialogClose","fullScreen","TransitionComponent","AppBar","Toolbar","autoFocus","m","a11yProps","index","TabFrame","other","role","hidden","contentPanel","boxSizing","content","overflowX","overflowY","tab","Student","currentStudentId","student","setStudent","setNewGuardian","setValue","elevation","square","Tabs","indicatorColor","scrollButtons","Tab","contact","axis","containerStyle","onChangeIndex","dir","is_base","course_id","day_week","start_time","end_time","newEvent","calendarApi","addEvent","revert","payment_id","StudentsCourseDataService","CoursesDataService","gId","ItemsListMain","downloadOneCsv","left","fab","bottom","right","RoleSelect","invitationsService","inviteUser","userEmail","user_email","role_id","UserPerson","nullable","UsersDataService","TeachersDataService","setFieldTouched","deleteFullUser","DirtyCheckbox","Checkbox","checked","symmetricDifference","setA","setB","_difference","elem","has","add","User","currentUserId","deleteUser","root2","formControl","maxHeight","minWidth","dialog","RoomSchedule","RoomDetails","setNewRoom","newRoom","RoomsDataService","Room","currentRoomId","deleteRoom","addRoomId","room","setRoom","downloadCalendar","resource_id","calendar_id","TeacherDetails","TeacherSchedule","setSchedulesIds","Teacher","currentTeacherId","setNewTeacher","newTeacher","addTeacherId","deleteTeacher","TeachersCoursesDataService","c","choose","marginBottom","CourseDetails","addCourseId","setNewCourse","newCourse","currentCourse","updateCurrentCourse","deleteCourse","history","useHistory","openDownloadAttendanceList","setOpenDownloadAttendanceList","is_published","formik2","startDate","endDate","DialogContent","id_","deleteFullCourse","LabelsSelection","FormControlLabel","control","CourseLabels","a","b","difference","jobs","CourseLabelsDataService","labels","CourseSchedule","Course","currentCourseId","course","setCourse","CourseStudentsDataService","CourseTeachersDataService","CourseRoomsDataService","bulkEmailService","bulkSend","courseIds","subject","emailPreference","studentEnrolmentStatus","files","FormData","append","EmailTo","addTo","defaultValue","fullWidth","textBox","border","attach","card","Routes","path","setStudents","setCurrentStudentId","handleError","URLSearchParams","Grid","container","xs","Fab","icon","PersonIcon","setCourses","setCurrentCourseId","ClassIcon","setTeachers","setCurrentTeacherId","SchoolIcon","setRooms","setCurrentRoomId","RoomIcon","AccountBalanceIcon","setUsers","setCurrentUserId","setOpen","userId","ContactMailIcon","groups","setGroups","setTo","selectedFiles","setSelectedFiles","g","rows","selectedFile","titleTypographyProps","multiple","htmlFor","EmailIcon","authenticationService","login","username","password","auth","logout","isLoggedIn","fallbackLng","resources","eng","translation","translationEN","cat","translationCAT","i18n","use","Backend","LanguageDetector","initReactI18next","init","detection","checkWhitelist","debug","whitelist","interpolation","escapeValue","getCurrentLanguage","localStorage","getItem","TranslateButton","selectedLanguage","i18next","changeLanguage","ThemeButton","themeCtx","TeacherDashboardButton","languageMap","active","toolbar","justifyContent","mixins","grow","flexGrow","withRouter","selected","anchorEl","setAnchorEl","isMenuOpen","Boolean","handleMenuClose","anchorElLan","setAnchorElLan","isLanguageMenuOpen","handleLanguageMenuClose","languageMenu","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","language","userMenuId","userMenu","handleDrawerOpen","menuButton","hide","noWrap","currentTarget","drawerWidth","zIndex","drawer","easing","sharp","leavingScreen","background","appBarShift","enteringScreen","flexShrink","whiteSpace","drawerOpen","drawerClose","breakpoints","up","backdrop","flexFlow","selectedIcon","HomePage","baseRouter","currentRoute","useRouteMatch","useLocation","handleDrawerClose","setLoading","cancel","confirmDialog","setConfirmDialog","handleCloseConfirm","routerRef","CssBaseline","Provider","cancelCallable","changeTheme","Drawer","paper","route","prop","Link","ListItemIcon","exact","Backdrop","CircularProgress","DialogContentText","passwordResetService","reset","token","recaptcha","startReset","useOnMount","field","down","cursor","LoginPage","mobile","useMediaQuery","setRecaptcha","showRecaptcha","setShowRecaptcha","setLogged","push","align","justify","sitekey","signup","SignupPage","query","password2","signupService","result","ResetPage","XamfraLogo","mx","preEnrolmentService","getCourses","postPreEnrollment","getLocalisedWeekday","dayOfWeek","resultDate","getTime","setDate","getNextDayOfWeek","toLocaleString","weekday","textSchedulesForCourse","slice","XamfraHeader","cards","buttons","bullet","pos","isUnderage","birthDateString","birthDate","age","PreEnrolmentPage","can_pay_70","can_pay_60","can_pay_50","skipped","setSkipped","availableCourses","setAvailableCourses","filteredCourses","setFilteredCourses","chosenCourses","setChosenCourses","raw_economic_comments","setRawEconomicComments","isStepSkipped","step","activeStep","setActiveStep","steps","handleSkip","isStepOptional","Error","prevActiveStep","prevSkipped","newSkipped","__person1__name","__person2__name","__person1__surname1","__person1__surname2","__person1__email","__person1__phone","__person1__relation","__person1__is_studying","__person1__is_working","__person1__career","__person1__education_entity","__person1__education_year","__person2__surname1","__person2__surname2","__person2__email","__person2__phone","__person2__relation","__person2__is_studying","__person2__is_working","__person2__career","__person2__education_entity","__person2__education_year","schema","notOneOf","years_in_xamfra","prefix","some","l","fieldsToValidatePerStep","secondaryListItemTextForCourse","description","canNotGoNext","courseToListItem","disableRipple","tabIndex","autocomplete","defaultChecked","BottomNavigation","showLabels","MobileStepper","nextButton","scrollTo","backButton","HomeButton","welcomeMessage","WelcomeTitle","hi","welcomeEmoji","setWelcomeEmoji","onMouseOver","onMouseOut","CourseCard","courseId","gutterBottom","MoreButton","clickable","NotATeacherTitle","rootBase","more","TeacherDashboardPage","maxPage","setMaxPage","loadedUntilPage","setLoadedUntilPage","attemptLoadedUntilPage","setAttemptLoadedUntilPage","attemptingLoad","setAttemptingLoad","TeacherCoursesService","newCourses","sm","md","NotFound","selectStatus","AttendanceItem","setAttendance","handleOpenCommentBox","labelId","newStatus","outlinedInputClasses","focused","notchedOutline","useOutlinedInputStyles","dense","FormControl","Select","stopPropagation","OutlinedInput","CommentDialog","commentBox","setCommentBoxValue","handleCloseCommentBox","commentBoxValue","handleCloseCancelCommentBox","paddingBottom","fabs","Attendance","initialAttendances","setInitialAttendances","attendances","setAttendances","getAddedStudentIds","studentsInInitial","hasChanges","initial","updated","hasChangesGlobal","hasUpdatedAttendances","setDirty","allDone","setAllDone","createEmptyAttendances","newAttendances","comment","loadAttendances","AttendanceService","toISOString","setCommentBox","commentBoxId","setCommentBoxId","targetStatus","markAll","promises","addedStudentIds","obj","getNewAttendances","updatedAttendances","initialAttendance","listCard","header","AttendancePage","App","setTheme","appliedTheme","_setNeeds","ThemeProvider","maxSnack","setItem","basename","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","Helmet","nonce","rel","getElementById"],"mappings":"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","file":"static/js/main.2468ce26.chunk.js","sourcesContent":["import {createMuiTheme} from \"@material-ui/core/styles\";\r\n\r\nexport const lightTheme = createMuiTheme({\r\n  palette: {\r\n    type: 'light',\r\n    primary: {\r\n      main: '#e98300',\r\n      light: '#ffb342',\r\n      dark: '#b05500',\r\n      contrastText: '#000000',  // todo deprecate\r\n      emphasisText: {\r\n        high: '#000000DF',\r\n        medium: '#00000098',\r\n        low: '#0000005E',\r\n      },\r\n    },\r\n    secondary: {\r\n      main: '#934d98',\r\n      light: '#c57bc9',\r\n      dark: '#63206a',\r\n      contrastText: '#000000',  // todo deprecate\r\n      emphasisText: {\r\n        high: '#000000DF',\r\n        medium: '#00000098',\r\n        low: '#0000005E',\r\n      },\r\n\r\n    },\r\n    neutral: {\r\n      main: '#ffffff',\r\n      contrastText: '#000000',\r\n      emphasisText: {\r\n        high: '#000000DF',\r\n        medium: '#00000098',\r\n        low: '#0000005E',\r\n      },\r\n      status: {\r\n        dirty: '#fbc02d',\r\n        success: '#43a047',\r\n        error: '#ff5252'\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nexport const darkTheme = createMuiTheme({\r\n  palette: {\r\n    type: 'dark',\r\n    primary: {\r\n      main: '#934d98',\r\n      light: '#c57bc9',\r\n      dark: '#63206a',\r\n      contrastText: '#000000',  // todo deprecate\r\n      emphasisText: {\r\n        high: '#000000DF',\r\n        medium: '#00000098',\r\n        low: '#0000005E',\r\n      },\r\n    },\r\n    secondary: {\r\n      main: '#ffcc80',\r\n      light: '#ffffb0',\r\n      dark: '#ca9b52',\r\n      contrastText: '#000000',  // todo deprecate\r\n      emphasisText: {\r\n        high: '#000000DF',\r\n        medium: '#00000098',\r\n        low: '#0000005E',\r\n      },\r\n    },\r\n    neutral: {\r\n      main: '#1f1f1f',\r\n      contrastText: '#ffffff',  // todo deprecate\r\n      emphasisText: {\r\n        high: '#ffffffDF',\r\n        medium: '#ffffff98',\r\n        low: '#ffffff5E',\r\n      },\r\n      status: {\r\n        dirty: '#ffcf3d',\r\n        success: '#c0e882',\r\n        error: '#ff5252'\r\n      }\r\n    }\r\n  }\r\n})\r\n","import React from \"react\";\r\n\r\nconst userContext = React.createContext({\r\n  user: null, \r\n  setUser: () => {}, \r\n  needs: [], \r\n  setNeeds: () => {},\r\n  teacher: [],\r\n  setTeacher: () => {}\r\n}); // Create a context object\r\n\r\nexport {\r\n  userContext // Export it so it can be used by other Components\r\n};","import {Redirect, Route} from 'react-router-dom';\r\nimport React from \"react\";\r\nimport {userContext} from '../_context/user-context';\r\n\r\nfunction PrivateRoute({ component: Component, ...rest }) {\r\n    const userCtx = React.useContext(userContext);\r\n    return (\r\n        <Route {...rest} render={props =>\r\n        {\r\n          if (!userCtx[\"user\"][\"logged\"]) {\r\n            // not logged in so redirect to login page with the return url\r\n            return <Redirect to={{ pathname: `/login`, state: { from: props.location } }} />\r\n            }\r\n\r\n            // authorised so return component\r\n            return <Component {...props} {...rest}/>\r\n      }}/>\r\n    );\r\n}\r\n\r\n\r\nexport default PrivateRoute;","import Cookies from 'js-cookie';\r\n\r\nexport function authHeader() {\r\n    // return authorization header with jwt token\r\n    return { 'X-CSRFToken': Cookies.get('X-CSRF-TOKEN')};\r\n}","export const API_VERSION = process.env.REACT_APP_API_VERSION;\r\nexport const BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\r\nexport const RECAPTCHA = process.env.REACT_APP_RECAPTCHA;\r\nexport const PUBLIC_URL = process.env.PUBLIC_URL;\r\nexport const CHECK_NEEDS = process.env.REACT_CHECK_NEEDS === \"true\";\r\nexport const DOCS_URL = process.env.REACT_APP_DOCS_URL;","import {authHeader} from \"../_helpers/auth-header\";\r\nimport {API_VERSION, BACKEND_URL} from \"../config\";\r\n\r\nconst axios = require('axios');  // todo default headers\r\n\r\nexport default function serviceFactory(resource, subresource=null, serviceName=null, baseUrl=null, apiVersion=null){  // todo subresource for all methods?\r\n    \r\n    baseUrl = baseUrl === null? BACKEND_URL: baseUrl;\r\n    serviceName = serviceName === null? 'api': serviceName;\r\n    apiVersion = apiVersion === null? API_VERSION: apiVersion;\r\n    const url = `${baseUrl}/${serviceName}/${apiVersion}`;\r\n\r\n    return class {\r\n        \r\n\r\n        getAll(likeSearchText=null, page = 1, include=null, filters=null, parent_id=null) {\r\n            return new Promise(function (resolve, reject) {\r\n\r\n                let myFilters = {\r\n                        \"page\": page,\r\n                        \"include\": include === null? null: JSON.stringify(include)\r\n                    };\r\n                if (likeSearchText !== null) {\r\n                    myFilters[`filter.${likeSearchText.name}.like`] = '%' + likeSearchText.value + '%';\r\n                }\r\n\r\n                if (filters !== null) {\r\n                    Object.keys(filters).forEach((key) => {\r\n                    myFilters[`filter.${key}.eq`] = filters[key];\r\n                })\r\n                }\r\n                \r\n                axios({\r\n                    method: 'get',\r\n                    url: `${url}/${resource}${subresource===null? '': `/${parent_id}/${subresource}`}`,\r\n                    params: myFilters,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()  // todo are auth headers needed for gets?\r\n                    }\r\n                }).then(function (response) {\r\n                        resolve(response.data);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        getOne(id, include=null, expect_batch=false) {\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'get',\r\n                    url: `${url}/${resource}/${id}`,\r\n                    params: {\r\n                        \"include\": include === null? null: JSON.stringify(include)\r\n                    },\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()  // todo are auth headers needed for gets?\r\n                    }\r\n                }).then(function (response) {\r\n                        resolve(response.data);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        getMany(ids) {\r\n            return new Promise((resolve, reject) => {\r\n                if (ids.length === 0) {\r\n                    resolve([]);\r\n                }\r\n                this.getOne(ids.join(','))\r\n                    .then(res => {\r\n                    if (ids.length === 1) {\r\n                        resolve([res]);\r\n                    } else {\r\n                        resolve(res);\r\n                    }\r\n                    })\r\n                    .catch(err => {\r\n                        reject(err);\r\n                    })\r\n            });\r\n        }\r\n\r\n        patch({id, body, initial_values = null}) {\r\n            if (initial_values !== null) {\r\n                var dirtyBody = Object.keys(body).reduce(function (filtered, key) {\r\n                    if (!(key in initial_values && initial_values[key] === body[key])){\r\n                        filtered[key] = body[key];\r\n                    }\r\n                    return filtered;\r\n                }, {});\r\n            }\r\n\r\n            if (\"id\" in dirtyBody) {\r\n                delete dirtyBody[\"id\"];  // no id is to be sent in the body, since it is sent as url param\r\n            }\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'patch',\r\n                    url: `${url}/${resource}/${id}`,\r\n                    data: dirtyBody,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (response) {\r\n                        resolve(response.data);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        post(body, subresourcId=null) {\r\n            if (\"id\" in body) delete body[\"id\"];  // no id is to be sent in the body, since it is sent as url param\r\n\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'post',\r\n                    url: `${url}/${resource}${subresource !== null? `/${subresourcId}/${subresource}`: ''}`,\r\n                    data: body,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (res) {\r\n                        resolve(res.data);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        // todo arent post and postwith id nearly same? merge\r\n\r\n        postWithId(id, subresourceid=null) {\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'post',\r\n                    url: `${url}/${resource}/${id}${subresourceid === null?\r\n                    '': `/${subresource}/${subresourceid}`}`,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (res) {\r\n                        resolve(res);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        delete(id, subresourceId=null) {\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'delete',\r\n                    url: `${url}/${resource}/${id}${subresource !== null? `/${subresource}/${subresourceId}`: ''}`,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (response) {\r\n                        resolve(response);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        }\r\n\r\n        deleteMany(ids) {\r\n            return Promise.all(ids.map(id => (this.delete(id))));\r\n        }\r\n\r\n        downloadCsv(searchtermfield, searchterm, page = 1, filters=null) {\r\n            return new Promise(function (resolve, reject) {\r\n                let myFilters = {\r\n                        \"page\": page\r\n                    };\r\n\r\n                if (searchtermfield !== null){\r\n                    myFilters[`filter.${searchtermfield}.like`]= `%${searchterm}%`;\r\n                }\r\n\r\n                if (filters !== null){\r\n                    Object.keys(filters).forEach((key) => {\r\n                    myFilters[`filter.${key}.eq`] = filters[key];\r\n                })\r\n                }\r\n\r\n                axios({\r\n                    url: `${url}/${resource}`,\r\n                    method: 'GET',\r\n                    responseType: 'blob', // important\r\n                    params: myFilters,\r\n                    headers: {\r\n                        ...{\r\n                            'Accept': 'text/csv',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(response => {\r\n                    let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n                    if (filename === null) filename = \"export.csv\";\r\n\r\n                    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.setAttribute('download', filename);\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                    link.remove();\r\n                    resolve();\r\n                }).catch(function (err) {\r\n                    reject(err);\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n\r\n        downloadOneCsv(id) {\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    url: `${url}/${resource}/${id}`,\r\n                    method: 'GET',\r\n                    responseType: 'blob', // important\r\n                    headers: {\r\n                        ...{\r\n                            'Accept': 'text/csv',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(response => {\r\n                    /*\r\n                    _download(response){\r\n                let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n                if (filename === null) filename = \"export.csv\";\r\n\r\n                const url = window.URL.createObjectURL(new Blob([response.data]));\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.setAttribute('download', filename);\r\n                document.body.appendChild(link);\r\n                link.click();\r\n                link.remove();\r\n                resolve();\r\n        }\r\n                    **/\r\n                    let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n                    if (filename === null) filename = \"export.csv\";\r\n\r\n                    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.setAttribute('download', filename);\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                    link.remove();\r\n                    resolve();\r\n                }).catch(function (err) {\r\n                    reject(err);\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n\r\n        downloadSubresource(id, subresource, params) {\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    url: `${url}/${resource}/${id}/${subresource}`,\r\n                    method: 'POST',\r\n                    params: params,\r\n                    responseType: 'blob', // important\r\n                    headers: {\r\n                        ...{\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(response => {\r\n                    let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n                    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.setAttribute('download', filename);\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                    link.remove();\r\n                    resolve();\r\n                }).catch(function (err) {\r\n                    reject(err);\r\n                });\r\n\r\n            });\r\n        }\r\n    }\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('students'))();\r\n\r\n","import IconButton from \"@material-ui/core/IconButton\";\r\nimport PersonAddIcon from \"@material-ui/icons/PersonAdd\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport React from \"react\";\r\n\r\nexport const IconButtonSkeleton = ({...props}) => {\r\n    return <Skeleton {...props} variant=\"circle\">\r\n                <IconButton><PersonAddIcon /></IconButton>\r\n          </Skeleton>\r\n}","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport {makeStyles} from \"@material-ui/core\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\n\r\n\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n  root: dirty => ({\r\n          '& label.Mui-focused':  {color: dirty? theme.palette.neutral.status.dirty: theme.palette.primary.main},\r\n          '& .MuiInput-underline:after': {borderBottomColor: dirty? theme.palette.neutral.status.dirty: theme.palette.primary.main},\r\n          '& label':  {color: dirty? theme.palette.neutral.status.dirty: theme.palette.neutral.emphasisText.medium}\r\n  })\r\n})));\r\n\r\n\r\nconst DirtyTextField = (props) => {\r\n    const name = props.name;\r\n    const formik = props.formik;\r\n    const dirty = props.noDirty === true? false: formik.values[name] !== formik.initialValues[name];\r\n    const classes = useStyles(dirty);\r\n    const formikProps = {\r\n        value: formik.values[name] === undefined? '': formik.values[name],  // todo why is this being called with undefined tho\r\n        onChange: formik.handleChange,\r\n        onBlur: formik.handleBlur,\r\n        error: formik.status  || formik.errors[name] !== undefined,\r\n        helperText: formik.touched[name] && formik.errors[name]\r\n    }\r\n    return <TextField className={classes.root}\r\n       InputLabelProps={{shrink: formik.values[name] !== ''}}\r\n      {...formikProps}\r\n       {...props}\r\n                  />\r\n}\r\n\r\nexport default DirtyTextField;","export const countries = [\r\n    { code: 'ES', label: 'Spain', phone: '34' },\r\n  { code: 'AD', label: 'Andorra', phone: '376' },\r\n  { code: 'AE', label: 'United Arab Emirates', phone: '971' },\r\n  { code: 'AF', label: 'Afghanistan', phone: '93' },\r\n  { code: 'AG', label: 'Antigua and Barbuda', phone: '1-268' },\r\n  { code: 'AI', label: 'Anguilla', phone: '1-264' },\r\n  { code: 'AL', label: 'Albania', phone: '355' },\r\n  { code: 'AM', label: 'Armenia', phone: '374' },\r\n  { code: 'AO', label: 'Angola', phone: '244' },\r\n  { code: 'AQ', label: 'Antarctica', phone: '672' },\r\n  { code: 'AR', label: 'Argentina', phone: '54' },\r\n  { code: 'AS', label: 'American Samoa', phone: '1-684' },\r\n  { code: 'AT', label: 'Austria', phone: '43' },\r\n  { code: 'AU', label: 'Australia', phone: '61', suggested: true },\r\n  { code: 'AW', label: 'Aruba', phone: '297' },\r\n  { code: 'AX', label: 'Alland Islands', phone: '358' },\r\n  { code: 'AZ', label: 'Azerbaijan', phone: '994' },\r\n  { code: 'BA', label: 'Bosnia and Herzegovina', phone: '387' },\r\n  { code: 'BB', label: 'Barbados', phone: '1-246' },\r\n  { code: 'BD', label: 'Bangladesh', phone: '880' },\r\n  { code: 'BE', label: 'Belgium', phone: '32' },\r\n  { code: 'BF', label: 'Burkina Faso', phone: '226' },\r\n  { code: 'BG', label: 'Bulgaria', phone: '359' },\r\n  { code: 'BH', label: 'Bahrain', phone: '973' },\r\n  { code: 'BI', label: 'Burundi', phone: '257' },\r\n  { code: 'BJ', label: 'Benin', phone: '229' },\r\n  { code: 'BL', label: 'Saint Barthelemy', phone: '590' },\r\n  { code: 'BM', label: 'Bermuda', phone: '1-441' },\r\n  { code: 'BN', label: 'Brunei Darussalam', phone: '673' },\r\n  { code: 'BO', label: 'Bolivia', phone: '591' },\r\n  { code: 'BR', label: 'Brazil', phone: '55' },\r\n  { code: 'BS', label: 'Bahamas', phone: '1-242' },\r\n  { code: 'BT', label: 'Bhutan', phone: '975' },\r\n  { code: 'BV', label: 'Bouvet Island', phone: '47' },\r\n  { code: 'BW', label: 'Botswana', phone: '267' },\r\n  { code: 'BY', label: 'Belarus', phone: '375' },\r\n  { code: 'BZ', label: 'Belize', phone: '501' },\r\n  { code: 'CA', label: 'Canada', phone: '1', suggested: true },\r\n  { code: 'CC', label: 'Cocos (Keeling) Islands', phone: '61' },\r\n  { code: 'CD', label: 'Congo, Democratic Republic of the', phone: '243' },\r\n  { code: 'CF', label: 'Central African Republic', phone: '236' },\r\n  { code: 'CG', label: 'Congo, Republic of the', phone: '242' },\r\n  { code: 'CH', label: 'Switzerland', phone: '41' },\r\n  { code: 'CI', label: \"Cote d'Ivoire\", phone: '225' },\r\n  { code: 'CK', label: 'Cook Islands', phone: '682' },\r\n  { code: 'CL', label: 'Chile', phone: '56' },\r\n  { code: 'CM', label: 'Cameroon', phone: '237' },\r\n  { code: 'CN', label: 'China', phone: '86' },\r\n  { code: 'CO', label: 'Colombia', phone: '57' },\r\n  { code: 'CR', label: 'Costa Rica', phone: '506' },\r\n  { code: 'CU', label: 'Cuba', phone: '53' },\r\n  { code: 'CV', label: 'Cape Verde', phone: '238' },\r\n  { code: 'CW', label: 'Curacao', phone: '599' },\r\n  { code: 'CX', label: 'Christmas Island', phone: '61' },\r\n  { code: 'CY', label: 'Cyprus', phone: '357' },\r\n  { code: 'CZ', label: 'Czech Republic', phone: '420' },\r\n  { code: 'DE', label: 'Germany', phone: '49', suggested: true },\r\n  { code: 'DJ', label: 'Djibouti', phone: '253' },\r\n  { code: 'DK', label: 'Denmark', phone: '45' },\r\n  { code: 'DM', label: 'Dominica', phone: '1-767' },\r\n  { code: 'DO', label: 'Dominican Republic', phone: '1-809' },\r\n  { code: 'DZ', label: 'Algeria', phone: '213' },\r\n  { code: 'EC', label: 'Ecuador', phone: '593' },\r\n  { code: 'EE', label: 'Estonia', phone: '372' },\r\n  { code: 'EG', label: 'Egypt', phone: '20' },\r\n  { code: 'EH', label: 'Western Sahara', phone: '212' },\r\n  { code: 'ER', label: 'Eritrea', phone: '291' },\r\n  { code: 'ET', label: 'Ethiopia', phone: '251' },\r\n  { code: 'FI', label: 'Finland', phone: '358' },\r\n  { code: 'FJ', label: 'Fiji', phone: '679' },\r\n  { code: 'FK', label: 'Falkland Islands (Malvinas)', phone: '500' },\r\n  { code: 'FM', label: 'Micronesia, Federated States of', phone: '691' },\r\n  { code: 'FO', label: 'Faroe Islands', phone: '298' },\r\n  { code: 'FR', label: 'France', phone: '33', suggested: true },\r\n  { code: 'GA', label: 'Gabon', phone: '241' },\r\n  { code: 'GB', label: 'United Kingdom', phone: '44' },\r\n  { code: 'GD', label: 'Grenada', phone: '1-473' },\r\n  { code: 'GE', label: 'Georgia', phone: '995' },\r\n  { code: 'GF', label: 'French Guiana', phone: '594' },\r\n  { code: 'GG', label: 'Guernsey', phone: '44' },\r\n  { code: 'GH', label: 'Ghana', phone: '233' },\r\n  { code: 'GI', label: 'Gibraltar', phone: '350' },\r\n  { code: 'GL', label: 'Greenland', phone: '299' },\r\n  { code: 'GM', label: 'Gambia', phone: '220' },\r\n  { code: 'GN', label: 'Guinea', phone: '224' },\r\n  { code: 'GP', label: 'Guadeloupe', phone: '590' },\r\n  { code: 'GQ', label: 'Equatorial Guinea', phone: '240' },\r\n  { code: 'GR', label: 'Greece', phone: '30' },\r\n  { code: 'GS', label: 'South Georgia and the South Sandwich Islands', phone: '500' },\r\n  { code: 'GT', label: 'Guatemala', phone: '502' },\r\n  { code: 'GU', label: 'Guam', phone: '1-671' },\r\n  { code: 'GW', label: 'Guinea-Bissau', phone: '245' },\r\n  { code: 'GY', label: 'Guyana', phone: '592' },\r\n  { code: 'HK', label: 'Hong Kong', phone: '852' },\r\n  { code: 'HM', label: 'Heard Island and McDonald Islands', phone: '672' },\r\n  { code: 'HN', label: 'Honduras', phone: '504' },\r\n  { code: 'HR', label: 'Croatia', phone: '385' },\r\n  { code: 'HT', label: 'Haiti', phone: '509' },\r\n  { code: 'HU', label: 'Hungary', phone: '36' },\r\n  { code: 'ID', label: 'Indonesia', phone: '62' },\r\n  { code: 'IE', label: 'Ireland', phone: '353' },\r\n  { code: 'IL', label: 'Israel', phone: '972' },\r\n  { code: 'IM', label: 'Isle of Man', phone: '44' },\r\n  { code: 'IN', label: 'India', phone: '91' },\r\n  { code: 'IO', label: 'British Indian Ocean Territory', phone: '246' },\r\n  { code: 'IQ', label: 'Iraq', phone: '964' },\r\n  { code: 'IR', label: 'Iran, Islamic Republic of', phone: '98' },\r\n  { code: 'IS', label: 'Iceland', phone: '354' },\r\n  { code: 'IT', label: 'Italy', phone: '39' },\r\n  { code: 'JE', label: 'Jersey', phone: '44' },\r\n  { code: 'JM', label: 'Jamaica', phone: '1-876' },\r\n  { code: 'JO', label: 'Jordan', phone: '962' },\r\n  { code: 'JP', label: 'Japan', phone: '81', suggested: true },\r\n  { code: 'KE', label: 'Kenya', phone: '254' },\r\n  { code: 'KG', label: 'Kyrgyzstan', phone: '996' },\r\n  { code: 'KH', label: 'Cambodia', phone: '855' },\r\n  { code: 'KI', label: 'Kiribati', phone: '686' },\r\n  { code: 'KM', label: 'Comoros', phone: '269' },\r\n  { code: 'KN', label: 'Saint Kitts and Nevis', phone: '1-869' },\r\n  { code: 'KP', label: \"Korea, Democratic People's Republic of\", phone: '850' },\r\n  { code: 'KR', label: 'Korea, Republic of', phone: '82' },\r\n  { code: 'KW', label: 'Kuwait', phone: '965' },\r\n  { code: 'KY', label: 'Cayman Islands', phone: '1-345' },\r\n  { code: 'KZ', label: 'Kazakhstan', phone: '7' },\r\n  { code: 'LA', label: \"Lao People's Democratic Republic\", phone: '856' },\r\n  { code: 'LB', label: 'Lebanon', phone: '961' },\r\n  { code: 'LC', label: 'Saint Lucia', phone: '1-758' },\r\n  { code: 'LI', label: 'Liechtenstein', phone: '423' },\r\n  { code: 'LK', label: 'Sri Lanka', phone: '94' },\r\n  { code: 'LR', label: 'Liberia', phone: '231' },\r\n  { code: 'LS', label: 'Lesotho', phone: '266' },\r\n  { code: 'LT', label: 'Lithuania', phone: '370' },\r\n  { code: 'LU', label: 'Luxembourg', phone: '352' },\r\n  { code: 'LV', label: 'Latvia', phone: '371' },\r\n  { code: 'LY', label: 'Libya', phone: '218' },\r\n  { code: 'MA', label: 'Morocco', phone: '212' },\r\n  { code: 'MC', label: 'Monaco', phone: '377' },\r\n  { code: 'MD', label: 'Moldova, Republic of', phone: '373' },\r\n  { code: 'ME', label: 'Montenegro', phone: '382' },\r\n  { code: 'MF', label: 'Saint Martin (French part)', phone: '590' },\r\n  { code: 'MG', label: 'Madagascar', phone: '261' },\r\n  { code: 'MH', label: 'Marshall Islands', phone: '692' },\r\n  { code: 'MK', label: 'Macedonia, the Former Yugoslav Republic of', phone: '389' },\r\n  { code: 'ML', label: 'Mali', phone: '223' },\r\n  { code: 'MM', label: 'Myanmar', phone: '95' },\r\n  { code: 'MN', label: 'Mongolia', phone: '976' },\r\n  { code: 'MO', label: 'Macao', phone: '853' },\r\n  { code: 'MP', label: 'Northern Mariana Islands', phone: '1-670' },\r\n  { code: 'MQ', label: 'Martinique', phone: '596' },\r\n  { code: 'MR', label: 'Mauritania', phone: '222' },\r\n  { code: 'MS', label: 'Montserrat', phone: '1-664' },\r\n  { code: 'MT', label: 'Malta', phone: '356' },\r\n  { code: 'MU', label: 'Mauritius', phone: '230' },\r\n  { code: 'MV', label: 'Maldives', phone: '960' },\r\n  { code: 'MW', label: 'Malawi', phone: '265' },\r\n  { code: 'MX', label: 'Mexico', phone: '52' },\r\n  { code: 'MY', label: 'Malaysia', phone: '60' },\r\n  { code: 'MZ', label: 'Mozambique', phone: '258' },\r\n  { code: 'NA', label: 'Namibia', phone: '264' },\r\n  { code: 'NC', label: 'New Caledonia', phone: '687' },\r\n  { code: 'NE', label: 'Niger', phone: '227' },\r\n  { code: 'NF', label: 'Norfolk Island', phone: '672' },\r\n  { code: 'NG', label: 'Nigeria', phone: '234' },\r\n  { code: 'NI', label: 'Nicaragua', phone: '505' },\r\n  { code: 'NL', label: 'Netherlands', phone: '31' },\r\n  { code: 'NO', label: 'Norway', phone: '47' },\r\n  { code: 'NP', label: 'Nepal', phone: '977' },\r\n  { code: 'NR', label: 'Nauru', phone: '674' },\r\n  { code: 'NU', label: 'Niue', phone: '683' },\r\n  { code: 'NZ', label: 'New Zealand', phone: '64' },\r\n  { code: 'OM', label: 'Oman', phone: '968' },\r\n  { code: 'PA', label: 'Panama', phone: '507' },\r\n  { code: 'PE', label: 'Peru', phone: '51' },\r\n  { code: 'PF', label: 'French Polynesia', phone: '689' },\r\n  { code: 'PG', label: 'Papua New Guinea', phone: '675' },\r\n  { code: 'PH', label: 'Philippines', phone: '63' },\r\n  { code: 'PK', label: 'Pakistan', phone: '92' },\r\n  { code: 'PL', label: 'Poland', phone: '48' },\r\n  { code: 'PM', label: 'Saint Pierre and Miquelon', phone: '508' },\r\n  { code: 'PN', label: 'Pitcairn', phone: '870' },\r\n  { code: 'PR', label: 'Puerto Rico', phone: '1' },\r\n  { code: 'PS', label: 'Palestine, State of', phone: '970' },\r\n  { code: 'PT', label: 'Portugal', phone: '351' },\r\n  { code: 'PW', label: 'Palau', phone: '680' },\r\n  { code: 'PY', label: 'Paraguay', phone: '595' },\r\n  { code: 'QA', label: 'Qatar', phone: '974' },\r\n  { code: 'RE', label: 'Reunion', phone: '262' },\r\n  { code: 'RO', label: 'Romania', phone: '40' },\r\n  { code: 'RS', label: 'Serbia', phone: '381' },\r\n  { code: 'RU', label: 'Russian Federation', phone: '7' },\r\n  { code: 'RW', label: 'Rwanda', phone: '250' },\r\n  { code: 'SA', label: 'Saudi Arabia', phone: '966' },\r\n  { code: 'SB', label: 'Solomon Islands', phone: '677' },\r\n  { code: 'SC', label: 'Seychelles', phone: '248' },\r\n  { code: 'SD', label: 'Sudan', phone: '249' },\r\n  { code: 'SE', label: 'Sweden', phone: '46' },\r\n  { code: 'SG', label: 'Singapore', phone: '65' },\r\n  { code: 'SH', label: 'Saint Helena', phone: '290' },\r\n  { code: 'SI', label: 'Slovenia', phone: '386' },\r\n  { code: 'SJ', label: 'Svalbard and Jan Mayen', phone: '47' },\r\n  { code: 'SK', label: 'Slovakia', phone: '421' },\r\n  { code: 'SL', label: 'Sierra Leone', phone: '232' },\r\n  { code: 'SM', label: 'San Marino', phone: '378' },\r\n  { code: 'SN', label: 'Senegal', phone: '221' },\r\n  { code: 'SO', label: 'Somalia', phone: '252' },\r\n  { code: 'SR', label: 'Suriname', phone: '597' },\r\n  { code: 'SS', label: 'South Sudan', phone: '211' },\r\n  { code: 'ST', label: 'Sao Tome and Principe', phone: '239' },\r\n  { code: 'SV', label: 'El Salvador', phone: '503' },\r\n  { code: 'SX', label: 'Sint Maarten (Dutch part)', phone: '1-721' },\r\n  { code: 'SY', label: 'Syrian Arab Republic', phone: '963' },\r\n  { code: 'SZ', label: 'Swaziland', phone: '268' },\r\n  { code: 'TC', label: 'Turks and Caicos Islands', phone: '1-649' },\r\n  { code: 'TD', label: 'Chad', phone: '235' },\r\n  { code: 'TF', label: 'French Southern Territories', phone: '262' },\r\n  { code: 'TG', label: 'Togo', phone: '228' },\r\n  { code: 'TH', label: 'Thailand', phone: '66' },\r\n  { code: 'TJ', label: 'Tajikistan', phone: '992' },\r\n  { code: 'TK', label: 'Tokelau', phone: '690' },\r\n  { code: 'TL', label: 'Timor-Leste', phone: '670' },\r\n  { code: 'TM', label: 'Turkmenistan', phone: '993' },\r\n  { code: 'TN', label: 'Tunisia', phone: '216' },\r\n  { code: 'TO', label: 'Tonga', phone: '676' },\r\n  { code: 'TR', label: 'Turkey', phone: '90' },\r\n  { code: 'TT', label: 'Trinidad and Tobago', phone: '1-868' },\r\n  { code: 'TV', label: 'Tuvalu', phone: '688' },\r\n  { code: 'TW', label: 'Taiwan, Province of China', phone: '886' },\r\n  { code: 'TZ', label: 'United Republic of Tanzania', phone: '255' },\r\n  { code: 'UA', label: 'Ukraine', phone: '380' },\r\n  { code: 'UG', label: 'Uganda', phone: '256' },\r\n  { code: 'US', label: 'United States', phone: '1', suggested: true },\r\n  { code: 'UY', label: 'Uruguay', phone: '598' },\r\n  { code: 'UZ', label: 'Uzbekistan', phone: '998' },\r\n  { code: 'VA', label: 'Holy See (Vatican City State)', phone: '379' },\r\n  { code: 'VC', label: 'Saint Vincent and the Grenadines', phone: '1-784' },\r\n  { code: 'VE', label: 'Venezuela', phone: '58' },\r\n  { code: 'VG', label: 'British Virgin Islands', phone: '1-284' },\r\n  { code: 'VI', label: 'US Virgin Islands', phone: '1-340' },\r\n  { code: 'VN', label: 'Vietnam', phone: '84' },\r\n  { code: 'VU', label: 'Vanuatu', phone: '678' },\r\n  { code: 'WF', label: 'Wallis and Futuna', phone: '681' },\r\n  { code: 'WS', label: 'Samoa', phone: '685' },\r\n  { code: 'XK', label: 'Kosovo', phone: '383' },\r\n  { code: 'YE', label: 'Yemen', phone: '967' },\r\n  { code: 'YT', label: 'Mayotte', phone: '262' },\r\n  { code: 'ZA', label: 'South Africa', phone: '27' },\r\n  { code: 'ZM', label: 'Zambia', phone: '260' },\r\n  { code: 'ZW', label: 'Zimbabwe', phone: '263' },\r\n    { code: '', label: \"empty\", phone: '-'},\r\n    { code: 'OTHER', label: 'other', phone: '-'}\r\n];\r\n\r\nexport default countries;","import {makeStyles} from \"@material-ui/core/styles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport {Autocomplete} from \"@material-ui/lab\";\r\nimport {countries} from \"../_data/countries\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\n\r\n// ISO 3166-1 alpha-2\r\n// ⚠️ No support for IE 11\r\nfunction countryToFlag(isoCode) {\r\n  return typeof String.fromCodePoint !== 'undefined'\r\n    ? isoCode\r\n        .toUpperCase()\r\n        .replace(/./g, (char) => String.fromCodePoint(char.charCodeAt(0) + 127397))\r\n    : isoCode;\r\n}\r\n\r\n\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n  textField: dirty => ({\r\n    '& label.Mui-focused':  {color: dirty? theme.palette.neutral.status.dirty: theme.palette.primary.main},  // todo color to theme\r\n    '& .MuiInput-underline:after': {borderBottomColor: dirty? theme.palette.neutral.status.dirty: theme.palette.primary.main},\r\n      '& label':  {color: dirty? theme.palette.neutral.status.dirty: theme.palette.neutral.emphasisText.medium},\r\n      '& fieldset': {borderColor: dirty? theme.palette.neutral.status.dirty: theme.palette.neutral.emphasisText.medium},\r\n  }\r\n  ),\r\n    option: {\r\n    fontSize: 15,\r\n    '& > span': {\r\n      marginRight: 10,\r\n      fontSize: 18,\r\n    },\r\n  },})));\r\n\r\nexport default function DirtyCountrySelect({formik, noDirty, name, label, style={ width: 300 }, ...textFieldProps}) {\r\n  const getInitialOption = (code) => {\r\n      if (code === undefined) return countries.find(x=>x.code==='');\r\n      return countries.find(x=>x.code===code);\r\n  }\r\n\r\n  const [option, _setOption] = React.useState(getInitialOption(formik.values[name]));\r\n\r\n  React.useEffect(() => {\r\n    _setOption(getInitialOption(formik.values[name]));\r\n  }, [formik.values, name]);\r\n\r\n  const setOption = (option) => {\r\n      const newOption = (option !== null)? option.code: '';\r\n      formik.setFieldValue(name, newOption);\r\n      _setOption(option);\r\n  }\r\n\r\n  const dirty = noDirty === true? false: formik.values[name] !== formik.initialValues[name];\r\n  const classes = useStyles(dirty);\r\n\r\n  const [inputValue, setInputValue] = React.useState('');\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Autocomplete\r\n      style={style}\r\n      options={countries}\r\n      classes={{\r\n        option: classes.option,\r\n      }}\r\n      autoHighlight\r\n      getOptionLabel={(option) => t(option.code) }\r\n      getOptionSelected={(o) => o.code === option.code}\r\n      value={option}\r\n        onChange={(event, newValue) => {\r\n          setOption(newValue);\r\n        }}\r\n        inputValue={inputValue}\r\n        onInputChange={(event, newInputValue) => {\r\n          setInputValue(newInputValue);\r\n        }}\r\n        name={name}\r\n      onBlur={formik.handleBlur}\r\n      renderOption={(option) => (\r\n        <React.Fragment key={option.code}>\r\n          <span>{option.code !== \"\" && option.code !== \"OTHER\"? countryToFlag(option.code): \"\"}</span>\r\n          {option.code !== \"\" && option.code !== \"OTHER\"? t(option.code): t(option.label)} {option.code !== \"\" && option.code !== \"OTHER\"? \"(\"+option.code+\") +\"+option.phone: \"\"}\r\n        </React.Fragment>\r\n      )}\r\n\r\n      renderInput={(params) => (\r\n        <TextField\r\n          {...params}\r\n          label={label}\r\n          noDirty={noDirty}\r\n          className={classes.textField}\r\n          inputProps={{\r\n            ...params.inputProps,\r\n            autoComplete: 'new-password', // disable autocomplete and autofill\r\n          }}\r\n          error={formik.status  || formik.errors[name] !== undefined}\r\n        helperText={formik.touched[name] && formik.errors[name]}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n}","import {userContext} from \"../_context/user-context\";\r\nimport React from 'react';\r\nimport {useSnackbar} from \"notistack\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Button} from \"@material-ui/core\";\r\n\r\n\r\nexport function useErrorHandler() {\r\n\r\n    const userCtx = React.useContext(userContext);\r\n    const {enqueueSnackbar, closeSnackbar} = useSnackbar();\r\n    const {t} = useTranslation();\r\n\r\n    const successHandler = (res, snackbarSuccess) => {\r\n        if (snackbarSuccess) enqueueSnackbar(t(\"success\"), {variant: \"success\"});\r\n        return Promise.resolve(res);\r\n    }\r\n\r\n    const successHandlerFactory = (snackbarSuccess) => {\r\n        return (res) => successHandler(res, snackbarSuccess)\r\n    }\r\n\r\n    const failureHandler401 = (res) => {\r\n        // auto logout if 401 unauthenticated\r\n        userCtx[\"setUser\"]({logged: false, ping: false});\r\n\r\n        enqueueSnackbar(t(\"warning_not_logged_in\"), {variant: \"warning\"});\r\n\r\n        return Promise.reject(res);\r\n    }\r\n\r\n    const failureHandler403 = (res) => {\r\n        // unauthorized\r\n        enqueueSnackbar(t(\"warning_not_enough_privileges\"), {variant: \"warning\"});\r\n\r\n        return Promise.reject(res);\r\n    }\r\n\r\n    const failureHandlerUnexpected = (res, reportUnexpected) => {\r\n        // an unexpected error happened\r\n        if (res.request.responseType == 'blob'){\r\n            res.response.data.text().then(res => {\r\n                showSnackbar(JSON.parse(res)['message']);\r\n            });\r\n        } else {\r\n            showSnackbar('');\r\n        }\r\n        \r\n        const showSnackbar = (message) => {\r\n            enqueueSnackbar(`Something went wrong! 😣 ${message}`,\r\n            {\r\n                variant: \"error\",\r\n                autoHideDuration: 10000,\r\n                action: key => {\r\n                    return <React.Fragment>\r\n                        <img src={true ? \"logo_centrifuga4_dark_error.svg\" : \"logo_centrifuga4_light_error.svg\"}\r\n                             alt=\"Logo Centrífuga\" style={{height: \"35px\"}}/>\r\n\r\n                        {reportUnexpected? <Button onClick={() => {\r\n                            navigator.clipboard.writeText(\r\n                                \"TO: vazquezrius.miquel@gmail.com\\n\\n\" +\r\n                                \"To mark an item, use a cross, like this: [X]\\n\\n\" +\r\n                                \"🛎️ TRIAGE\\n\" +\r\n                                \"[ ] This issue has been reported previously and has NOT been marked as solved\\n\" +\r\n                                \"[ ] This issue has been reported previously and has been marked as solved\\n\" +\r\n                                \"[ ] This issue has not been reported previously\\n\" +\r\n                                \"[ ] I have written the steps to reproduce the issue in the specified section below - ⚠️required!\\n\\n\" +\r\n                                \"🙋 TYPE OF REQUEST\\n\" +\r\n                                \"[ ] Feature request\\n\" +\r\n                                \"[X] Error report\\n\\n\" +\r\n                                \"📋 STEPS\\n\" +\r\n                                \"Describe what were you doing when this error happened!\\n\" +\r\n                                \"\\n    example\\n\" +\r\n                                \"    1. Searched 'john' in the students section, two students appeared.\\n\" +\r\n                                \"    2. Clicked the CSV export option.\\n\" +\r\n                                \"    3. Nothing happened, the the error message appeared.\\n\\n\" +\r\n                                \"Write your steps for repeating the issue here:\\n1. ...\\n\\n\\n\" +\r\n                                \"📚 STACK TRACE\\n\" + JSON.stringify(res) + \"\\n\\n\\n\" +\r\n                                \"🌩️ RESPONSE\\n\" + JSON.stringify(res.response) + \"\\n\\n\\n\" +\r\n                                \"⚙️ DEVICE CONTEXT\\n\" + navigator.platform + \"\\n\" + navigator.userAgent + \"\\n\" +\r\n                                navigator.appVersion + \"\\n\" + navigator.vendor + \"\\n\")\r\n                                .then(r => {\r\n                                    closeSnackbar(key);\r\n                                    alert(\"Okey, so something got messed up... 😣 Let's fix it!\\n\\n\" +\r\n                                        \"📤 Open your email client\\n\" +\r\n                                        \"📋 Ctrl+V\\n\" +\r\n                                        \"✏️ Fill in the details\\n\" +\r\n                                        \"📨 Send it to the support team!\\n\\n\")\r\n                                });\r\n                        }}>\r\n                            {t(\"Report\")}\r\n                        </Button>: null}\r\n                        <Button onClick={() => {\r\n                            closeSnackbar(key)\r\n                        }}>\r\n                            {t(\"Dismiss\")}\r\n                        </Button>\r\n\r\n                    </React.Fragment>\r\n                }\r\n            });\r\n        }\r\n\r\n        return Promise.reject(res);\r\n    }\r\n\r\n    const failureHandler = (res, handle401, handle403, handle400, errorOut, reportUnexpected) => {\r\n        // decide which handler is going to handle the error response depending on status code\r\n        let handler = (res) => failureHandlerUnexpected(res, reportUnexpected);\r\n        if (res.request.status === 401) {\r\n            if (handle401) { handler = failureHandler401; }\r\n            else { return Promise.reject(res) }\r\n        }\r\n        if (res.request.status === 403) {\r\n            if (handle403) { handler = failureHandler403; }\r\n            else { return Promise.reject(res) }\r\n        }\r\n        if (res.request.status === 400) {\r\n            if (!handle400) { return Promise.reject(res) }\r\n            // else just use the default handler\r\n        }\r\n\r\n        // use the handler, return a rejected promise if errorOut,\r\n        // else just execute the handler but don't return a rejected catch\r\n        // (otherwise there will be either empty rejection handlers or unhandled rejections everywhere)\r\n        if (errorOut) {\r\n            return handler(res);\r\n        } else {\r\n            handler(res).catch(()=>{});  // ignores the rejection response\r\n            return null;\r\n        }\r\n    }\r\n\r\n    const failureHandlerFactory = (handle401, handle403, handle400, errorOut, reportUnexpected) => {\r\n        return (res) => (failureHandler(res, handle401, handle403, handle400, errorOut, reportUnexpected))\r\n    }\r\n\r\n    return ({\r\n                handle401 = true,\r\n                handle403 = true,\r\n                handle400 = true,\r\n                errorOut = true,\r\n                reportUnexpected = true,\r\n                snackbarSuccess = false\r\n            }) => {\r\n        return [successHandlerFactory(snackbarSuccess),\r\n                failureHandlerFactory(handle401, handle403, handle400, errorOut, reportUnexpected)]\r\n    };\r\n}","import {useFormik} from \"formik\";\r\n\r\n\r\nexport function useNormik(onlyChangedValuesOnSubmit, props, allowArrays=false) {\r\n    let originalInitialValues = {};\r\n    if (\"initialValues\" in props) {\r\n        let nullSafeInitialValues = {};\r\n        originalInitialValues = props.initialValues;\r\n        for (const [key, value] of Object.entries(originalInitialValues)) {\r\n          if (value === null) {\r\n              nullSafeInitialValues[key] = '';\r\n          } else {\r\n              nullSafeInitialValues[key] = value;\r\n          }\r\n        }\r\n        props.initialValues = nullSafeInitialValues;\r\n    }\r\n\r\n    if (\"onSubmit\" in props){\r\n        const oldOnSubmit = props.onSubmit;\r\n        const nullSafeOnSubmit = (values, actions) => {\r\n            let normalizedValues = {};\r\n            for (const [key, value] of Object.entries(values)) {\r\n                const normalizedValue = value === ''? null : value;\r\n                if (!onlyChangedValuesOnSubmit ||\r\n                    (onlyChangedValuesOnSubmit && normalizedValue !== originalInitialValues[key] &&\r\n                        (allowArrays || !Array.isArray(originalInitialValues[key])) )){\r\n                  normalizedValues[key] = normalizedValue;\r\n                }\r\n\r\n            }\r\n            oldOnSubmit(normalizedValues, actions);\r\n        }\r\n        props.onSubmit = nullSafeOnSubmit;\r\n    }\r\n\r\n    return useFormik(props);\r\n}","export const education_years = [\r\n    \"kindergarten_p1\",\r\n    \"kindergarten_p2\",\r\n    \"kindergarten_p3\",\r\n    \"kindergarten_p4\",\r\n    \"kindergarten_p5\",\r\n    \"primary_1\",\r\n    \"primary_2\",\r\n    \"primary_3\",\r\n    \"primary_4\",\r\n    \"primary_5\",\r\n    \"primary_6\",\r\n    \"eso_1\",\r\n    \"eso_2\",\r\n    \"eso_3\",\r\n    \"eso_4\",\r\n    \"baccalaureate_1\",\r\n    \"baccalaureate_2\",\r\n    \"FP_lower\",\r\n    \"FP_higher\",\r\n    \"undergraduate\",\r\n    \"master\",\r\n    \"phd\",\r\n    \"other\"\r\n];\r\n","import React, {useEffect} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Checkbox, FormControlLabel} from \"@material-ui/core\";\r\nimport {allNeeds} from \"../_data/needs\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport RestoreIcon from \"@material-ui/icons/Restore\";\r\n\r\n\r\nconst DiscardButton = ({formik, ...props}) => {\r\n    const {t} = useTranslation();\r\n\r\n    return   <IconButton\r\n                                     onClick={formik.handleReset}\r\n                                     disabled={!formik.dirty || formik.isSubmitting}\r\n                         {...props}>\r\n                            <Tooltip title={t(\"reset\")} aria-label={t(\"reset\")}>\r\n                                <RestoreIcon/>\r\n                            </Tooltip>\r\n                        </IconButton>\r\n}\r\n\r\nexport default DiscardButton;","import {userContext} from \"../_context/user-context\";\r\nimport React from 'react';\r\nimport {useSnackbar} from \"notistack\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Button} from \"@material-ui/core\";\r\nimport {CHECK_NEEDS} from \"../config\";\r\n\r\n\r\nexport const NEEDS = {\r\n        get: \"get\",\r\n        patch: \"patch\",\r\n        delete: \"delete\",\r\n        post: \"post\",\r\n        send_email: \"send_email\",\r\n        invite_users: \"invite_users\",\r\n        students: \"students\",\r\n        courses: \"courses\",\r\n        guardians: \"guardians\",\r\n        payments: \"payments\",\r\n        rooms: \"rooms\",\r\n        schedules: \"schedules\",\r\n        teachers: \"teachers\",\r\n        users: \"users\",\r\n        paymentReceipts: \"payments-receipts\",\r\n        attendance: \"attendance\"\r\n    };\r\n\r\n\r\nexport function useNeeds() {\r\n\r\n    const userCtx = React.useContext(userContext);\r\n\r\n    const hasNeed = (needs) => (!CHECK_NEEDS || needs.every(need => userCtx.needs.includes(need)));\r\n\r\n    return [hasNeed, NEEDS];\r\n}","import React, {useEffect} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Checkbox, FormControlLabel} from \"@material-ui/core\";\r\nimport {allNeeds} from \"../_data/needs\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\n\r\n\r\nconst SaveButton = ({formik, ...props}) => {\r\n    const {t} = useTranslation();\r\n    const [hasNeeds, NEEDS] = useNeeds();\r\n    return   hasNeeds([NEEDS.patch]) && <IconButton  type=\"submit\"\r\n                                    disabled={!formik.dirty || formik.isSubmitting}\r\n                          {...props}>\r\n                            <Tooltip title={t(\"save\")} aria-label={t(\"save\")}>\r\n                                <SaveIcon/>\r\n                            </Tooltip>\r\n                        </IconButton>\r\n}\r\n\r\nexport default SaveButton;","export const longer_8 = /^.{8,}$/;\r\nexport const shorter_64 = /^.{0,64}$/;\r\nexport const has_lowercase = /(?=.*[a-z])/;\r\nexport const has_uppercase = /(?=.*[A-Z])/;\r\nexport const has_digit = /(?=.*\\d)/;\r\nexport const has_special = /(?=.*[-/:-@[-`{-~]{1,})/;\r\nexport const no_plus = /^((?!\\+).)*$/;\r\n","import * as yup from \"yup\";\r\nimport {\r\n    has_digit,\r\n    has_lowercase,\r\n    has_special,\r\n    has_uppercase,\r\n    longer_8,\r\n    no_plus,\r\n    shorter_64\r\n} from \"../_data/password_regex\";\r\n\r\nexport const DNI_REGEX = /^[0-9]{8}[TRWAGMYFPDXBNJZSQVHLCKE]$/i;\r\nexport const NIE_REGEX =  /^[XYZ][0-9]{7}[A-Z]$/i;\r\nexport const DNI_OR_NIE_REGEX = new RegExp(DNI_REGEX.source + \"|\" + NIE_REGEX.source).source;\r\nexport const safe_password = (t) => (\r\n    yup.string()\r\n        .required(t(\"password_required\"))\r\n        .matches(longer_8, t(\"longer_8\"))\r\n        .matches(shorter_64, t(\"shorter_64\"))\r\n        .matches(has_lowercase, t(\"has_lowercase\"))\r\n        .matches(has_uppercase, t(\"has_uppercase\"))\r\n        .matches(has_digit, t(\"has_digit\"))\r\n        .matches(has_special, t(\"has_special\"))\r\n)\r\n\r\nexport const safe_password_repetition = (t) => (\r\n    yup.string()\r\n        .required(t(\"password_required\"))\r\n        .oneOf([yup.ref('password'), null], t(\"passwords_unmatched\"))\r\n)\r\n\r\n\r\nconst safe_username_email = (t) => (\r\n    yup.string()\r\n        .email(t(\"invalid_email\"))\r\n        .matches(no_plus, t(\"no_plus\"))\r\n)\r\n\r\nconst safe_username_email_required = (t) => (\r\n    safe_username_email(t).required(t(\"email_required\"))\r\n);\r\n\r\n\r\nexport const safe_username_required = safe_username_email_required;\r\nexport const safe_email_required = safe_username_email_required;\r\nexport const safe_email = safe_username_email;\r\n\r\nexport const one_of = (t, options) => yup.string().required(t('field_required'))\r\n                                .test(  // one of the array\r\n                                  'oneOfRequired',\r\n                                  `${t(\"one_of\")}: ${options.toString()}`,\r\n                                  v => options.includes(v)\r\n                                )","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {MenuItem} from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport * as yup from 'yup';\r\nimport DirtyCountrySelect from \"./contry-select.component\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport {education_years} from \"../_data/education\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport {safe_email} from \"../_yup/validators\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    },\r\n    actionIcon: {\r\n        float: 'right'\r\n    }\r\n}));\r\n\r\nfunction Person(props) {\r\n    const currentPerson = props.currentPerson;\r\n    const dataService = props.patchService;\r\n    const newPerson = props.newPerson;\r\n    const updateCurrentPerson = props.updateCurrentStudent;\r\n    const additionalFields = props.additionalFields;\r\n    const additionalValidation = props.additionalValidation === undefined? {}: props.additionalValidation;\r\n    const studentId = props.studentId;\r\n    const onUpdate = props.onUpdate;\r\n    const loading = currentPerson === null;\r\n\r\n    const {t} = useTranslation();\r\n    const classes = useStyles();\r\n    const errorHandler = useErrorHandler();\r\n    let initialValues = loading ? {} : currentPerson;\r\n\r\n\r\n    const formik = useNormik(!newPerson, {\r\n        initialValues: initialValues,\r\n        validationSchema: yup.object({...{\r\n            email: safe_email(t),\r\n            name: yup.string().required(t(\"name_required\")),\r\n            is_studying: yup.boolean().required(t(\"studying_required\")),\r\n            is_working: yup.boolean().required(t(\"working_required\")),\r\n            career: yup.string().when('is_working', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(t(\"career_required\"))\r\n                                                }),\r\n            education_entity: yup.string().when('is_studying', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(t(\"education_entity_required\"))\r\n                                                }),\r\n            education_year: yup.string().when('is_studying', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(t(\"education_year_required\"))\r\n                                                })\r\n        }, ...additionalValidation}),\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n            if (newPerson) {\r\n                setStatus();\r\n                dataService.post({...changedValues})\r\n                    .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (new_id) {\r\n                        updateCurrentPerson(new_id['id']);\r\n                        if (typeof onUpdate === 'function') onUpdate(changedValues);\r\n                    }).catch(function (err) {\r\n                    setStatus(true);\r\n                    }).finally(() => {\r\n                    setSubmitting(false);\r\n                });\r\n            } else {\r\n                if (Object.keys(changedValues).length > 0) {\r\n                setStatus();\r\n                dataService.patch({\r\n                    id: initialValues[\"id\"],\r\n                    body: changedValues,\r\n                    initial_values: initialValues\r\n                }).then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (patched_body) {\r\n                        formik.resetForm(patched_body);\r\n                        updateCurrentPerson(patched_body);\r\n\r\n                        if (typeof onUpdate === 'function') onUpdate(changedValues);\r\n                    }).catch(function (err) {\r\n                        setStatus(true);\r\n                    }).finally(() => {\r\n                        setSubmitting(false);\r\n                    });\r\n\r\n\r\n            } else {\r\n                setSubmitting(false);\r\n            }\r\n            }\r\n        }\r\n    });\r\n\r\n    function recursiveForm(elements) {\r\n        if (elements === undefined) return null;\r\n\r\n        return <div>\r\n            <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n            {\r\n            elements.map((res, idx) => (\r\n                res == null? <Box my={3}>\r\n            <Divider />\r\n            </Box>:\r\n                <Box key={idx} className={`${classes.line} ${classes.composite}`}>\r\n                    {res instanceof Array ?\r\n                        res.map((r, idx2) => (\r\n                            React.cloneElement(r, {formik: formik, key: idx+\"-\"+idx2})\r\n                        ))\r\n                        : React.cloneElement(res, {formik: formik})}\r\n                </Box>))\r\n        }\r\n        </div>;\r\n    }\r\n\r\n\r\n    return (\r\n        <Box>\r\n            {loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               {   [\"100%\", \"100%\", \"100%\", \"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0} >\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })}\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"id\")}\r\n                            name=\"id\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                        />\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name=\"name\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname1\")}\r\n                                style={{flex: 1}}\r\n                                name=\"surname1\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname2\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"surname2\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"email\")}\r\n                                type=\"email\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"email\"\r\n                                helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                            />\r\n                        </Box>\r\n\r\n                       <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"address\")}\r\n                                formik={formik}\r\n                                style={{flex: 4}}\r\n                                name=\"address\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"city\")}\r\n                                style={{flex: 2}}\r\n                                formik={formik}\r\n                                name=\"city\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"zip\")}\r\n                                formik={formik}\r\n                                type=\"number\"\r\n                                style={{flex: 1}}\r\n                                name=\"zip\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"dni\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"dni\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"phone\")}\r\n                                type=\"tel\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"phone\"\r\n                            />\r\n\r\n\r\n\r\n                        </Box>\r\n\r\n\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n\r\n                            <DirtyCountrySelect\r\n                                formik={formik}\r\n                                style={{flex: 1}}\r\n                                name={\"country_of_origin\"}\r\n                                label={t(\"country_of_origin\")}\r\n                            />\r\n<DirtyTextField\r\n                                label={t(\"gender\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"gender\"\r\n                                select>\r\n                                <MenuItem value=\"m\">{t(\"male\")}</MenuItem>\r\n                                <MenuItem value=\"f\">{t(\"female\")}</MenuItem>\r\n                                <MenuItem value=\"nb\">{t(\"nb\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n<Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"is_studying\")}\r\n                                style={{flex: 1}}\r\n                                name=\"is_studying\"\r\n                                formik={formik}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                            <DirtyTextField\r\n                                label={t(\"education_entity\")}\r\n                                style={{flex: 2}}\r\n                                formik={formik}\r\n                                name=\"education_entity\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"education_year\")}\r\n                                style={{flex: 2}}\r\n                                name=\"education_year\"\r\n                                formik={formik}\r\n                                select>\r\n                                {education_years.map((level) => (\r\n                                    <MenuItem key={level} value={level}>{t(level)}</MenuItem>\r\n                                ))}\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n\r\n\r\n                            <DirtyTextField\r\n                                label={t(\"is_working\")}\r\n                                style={{flex: 1}}\r\n                                name=\"is_working\"\r\n                                formik={formik}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                            <DirtyTextField\r\n                                label={t(\"career\")}\r\n                                style={{flex: 4}}\r\n                                formik={formik}\r\n                                name=\"career\"\r\n                            />\r\n                        </Box>\r\n\r\n                        {recursiveForm(additionalFields)}\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n        </Box>\r\n    );\r\n}\r\n\r\n\r\nexport default Person;","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('guardians'))();\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('payments'))();\r\n\r\n","export const payment_methods = [\r\n    \"bank-transfer\",\r\n    \"cash\",\r\n    \"bank-direct-debit\"\r\n]","const newPerson = {\r\n                name: null,\r\n                surname1: null,\r\n                surname2: null,\r\n                email: null,\r\n                address: null,\r\n                city: null,\r\n                zip: null,\r\n                dni: null,\r\n                phone: null,\r\n                gender: null,\r\n\r\n                country_of_origin: null,\r\n                is_studying: null,\r\n                education_entity: null,\r\n                education_year: null,\r\n                is_working: null,\r\n                career: null\r\n              };\r\nexport const emptyGuardian = {...newPerson, relation: null};\r\nexport const emptyAttendee = {...newPerson,\r\n    price_term: null,\r\n    payment_comments: null,\r\n    birth_date: null,\r\n    other_comments: null,\r\n    image_agreement: null,\r\n    enrolment_status: null,\r\n    default_payment_method: null\r\n};\r\n","import React from \"react\";\r\n\r\nconst loadingContext = React.createContext({loading: false,\r\n  startLoading: () => {},\r\n  stopLoading: () => {},\r\n}); // Create a context object\r\n\r\nexport {\r\n  loadingContext // Export it so it can be used by other Components\r\n};","import React from \"react\";\r\n\r\nconst confirmContext = React.createContext(\r\n    {confirm: (title, subtitle, successCallable, cancelCallable=null) => {}}); // Create a context object\r\n\r\nexport {\r\n  confirmContext // Export it so it can be used by other Components\r\n};","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport PersonAddIcon from '@material-ui/icons/PersonAdd';\r\nimport {MenuItem} from \"@material-ui/core\";\r\nimport PropTypes from \"prop-types\";\r\nimport React from \"react\";\r\nimport StudentsDataService from \"../_services/students.service\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport * as yup from 'yup';\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\"\r\nimport Person from \"./students.student.person.component\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport GuardiansDataService from \"../_services/guardians.service\";\r\nimport PaymentsDataService from \"../_services/payments.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport SendIcon from \"@material-ui/icons/Send\";\r\nimport {sendEnrollmentEmail} from \"../_services/emailsEnrollment.service\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {sendGrantEmail} from \"../_services/emailsGrants.service\";\r\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\r\nimport {payment_methods} from \"../_data/payment_methods\";\r\nimport {emptyAttendee} from \"../_data/empty_objects\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nfunction Attendee({ children, setNewStudent, addStudentId, newStudent, title, currentStudent, updateCurrentStudent, patchService, deleteStudent, addNewGuardian, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentStudent === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n  const [hasNeeds, NEEDS] = useNeeds();\r\n  const confirm = React.useContext(confirmContext);\r\n\r\n  const deleteFullStudent = () => {\r\n    StudentsDataService\r\n              .delete(currentStudent['id'])\r\n              .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n              .then(function (res) {\r\n                PaymentsDataService\r\n                      .deleteMany(currentStudent['payments'])\r\n                      .then(...errorHandler({}))  // todo everywhere\r\n                      .then(function (res) {\r\n\r\n                      });\r\n\r\n                GuardiansDataService\r\n                      .deleteMany(currentStudent['guardians'])\r\n                      .then(...errorHandler({}))  // todo everywhere\r\n                      .then(function (res) {\r\n\r\n                      });\r\n\r\n\r\n                // todo schedules, courses\r\n\r\n\r\n                deleteStudent(currentStudent['id']);\r\n              });\r\n  }\r\n  const loadingCtx = React.useContext(loadingContext);\r\n  const sendGrantLetter = () => {\r\n      loadingCtx.startLoading();\r\n      sendGrantEmail(currentStudent['id'])\r\n          .then(...errorHandler({snackbarSuccess: true}))\r\n          .finally(() => {\r\n              loadingCtx.stopLoading();\r\n          });\r\n  }\r\n  const sendEnrollmentAgreement = () => {\r\n      loadingCtx.startLoading();\r\n      sendEnrollmentEmail(currentStudent['id'])\r\n          .then(...errorHandler({snackbarSuccess: true}))\r\n          .finally(() => {\r\n              loadingCtx.stopLoading();\r\n          });\r\n  }\r\n\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n              {loading?\r\n                  !newStudent && <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n              !newStudent && hasNeeds([NEEDS.guardians, NEEDS.post]) && <Tooltip style={{float: 'right'}} title={t(\"new_guardian\")} aria-label={t(\"new_guardian\")}>\r\n                <IconButton onClick={(e) => {\r\n                  addNewGuardian();\r\n                }}>\r\n                  <PersonAddIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n\r\n              {loading && !newStudent ?\r\n                   <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n                hasNeeds([NEEDS.delete]) && <Tooltip style={{float: 'right'}} title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                <IconButton onClick={(e) => {\r\n                    if (newStudent) {\r\n                        setNewStudent(false);\r\n                    } else {\r\n                        confirm.confirm(\"delete_student_question\",\r\n      \"student_also_deletes\",\r\n      () => {\r\n                            deleteFullStudent(currentStudent['id'])\r\n      });\r\n                    }\r\n\r\n                }}>\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              <Person\r\n                      currentPerson={newStudent? emptyAttendee: currentStudent}\r\n                      newPerson={newStudent}\r\n                      updateCurrentStudent={(x) => {\r\n                        if (!newStudent) return updateCurrentStudent(x);\r\n                        addStudentId(x);\r\n                      }}\r\n                      patchService={patchService}\r\n                      onUpdate={(changedBody) => {\r\n                        if (\"enrolment_status\" in changedBody && changedBody[\"enrolment_status\"] === \"enrolled\"){\r\n                          confirm.confirm(\"send_grant_letter_question\",\r\n                          \"this_will_be_sent\",\r\n                          () => {\r\n                                sendGrantLetter();\r\n                          });\r\n                        }\r\n                      }}\r\n                      additionalValidation={{\r\n                        enrolment_status: yup.string().required(t(\"status_required\")),\r\n                        image_agreement: yup.boolean().required(t(\"image_required\")),\r\n                        birth_date: yup.date().required(t(\"birthdate_required\"))\r\n                      }}\r\n                      additionalFields={\r\n                        [[<DirtyTextField\r\n                                label={t(\"price_term\")}\r\n                                style={{flex: 1}}\r\n                                name=\"price_term\"\r\n                                type=\"number\"\r\n                                InputProps={{endAdornment: <InputAdornment position=\"end\">€</InputAdornment>,}}\r\n                            />,\r\n                            <DirtyTextField\r\n                                label={t(\"default_payment_method\")}\r\n                                style={{flex: 1}}\r\n                                name=\"default_payment_method\"\r\n                                select>\r\n                                { payment_methods.map(\r\n                                                    (method) => (\r\n                                                        <MenuItem key={method} value={method}>{t(method)}</MenuItem>\r\n                                                    )\r\n                                                )\r\n                                                }\r\n                            </DirtyTextField>],\r\n                            <DirtyTextField\r\n                                label={t(\"payment_comments\")}\r\n                                style={{flex: 1}}\r\n                                multiline\r\n                                rowsMax={8}\r\n                                name=\"payment_comments\"\r\n                            />,\r\n                            null,\r\n                            [<DirtyTextField\r\n                                label={t(\"birthdate\")}\r\n                                type=\"date\"\r\n                                style={{flex: 1}}\r\n                                name=\"birth_date\"\r\n                                InputLabelProps={{shrink: true}}/>,\r\n                            <DirtyTextField\r\n                              label={t(\"years_in_xamfra\")}\r\n                              type=\"number\"\r\n                              style={{flex: 1}}\r\n                              name=\"years_in_xamfra\"/>],\r\n                          [\r\n                              <DirtyTextField\r\n                                label={t(\"status\")}\r\n                                style={{flex: 1}}\r\n                                name=\"enrolment_status\"\r\n                                select>\r\n                                {['enrolled', 'early-unenrolled', 'pre-enrolled'].map((s) => (\r\n                                    <MenuItem key={s} value={s}>{t(s)}</MenuItem>\r\n                                ))}\r\n                            </DirtyTextField>,\r\n                              <DirtyTextField\r\n                                label={t(\"image_agreement\")}\r\n                                style={{flex: 1}}\r\n                                name=\"image_agreement\"\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                          ], [<DirtyTextField\r\n                                label={t(\"pre_enrolment_date\")}\r\n                                type=\"date\"\r\n                                style={{flex: 1}}\r\n                                name=\"pre_enrolment_date\"\r\n                                InputLabelProps={{shrink: true}}/>,\r\n                                <DirtyTextField\r\n                                label={t(\"enrolment_date\")}\r\n                                type=\"date\"\r\n                                style={{flex: 1}}\r\n                                name=\"enrolment_date\"\r\n                                InputLabelProps={{shrink: true}}/>,\r\n                                <DirtyTextField\r\n                                label={t(\"early_unenrolment_date\")}\r\n                                type=\"date\"\r\n                                style={{flex: 1}}\r\n                                name=\"early_unenrolment_date\"\r\n                                InputLabelProps={{shrink: true}}/>\r\n                            ],\r\n                        <DirtyTextField\r\n                                label={t(\"other_comments\")}\r\n                                style={{flex: 1}}\r\n                                multiline\r\n                                rowsMax={8}\r\n                                name=\"other_comments\"\r\n                            />]}\r\n              >\r\n\r\n              </Person>\r\n\r\n              {!loading && !newStudent && <Box my={3}>\r\n            <Divider />\r\n            </Box>}\r\n\r\n              <Box className={[classes.line, classes.composite]}>\r\n                {!loading && !newStudent && hasNeeds([NEEDS.send_email]) &&\r\n                <Tooltip style={{flex: 1}} title={t(\"send_grant_letter\")} aria-label={t(\"send_grant_letter\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      disabled={loadingCtx.loading}\r\n                      startIcon={<SendIcon/>}\r\n                      onClick={(e) => {\r\n                        sendGrantLetter();\r\n                      }}\r\n                  >\r\n                    {t(\"grant_letter\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n\r\n                {!loading && !newStudent &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_grant_letter\")} aria-label={t(\"export_grant_letter\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      disabled={loadingCtx.loading}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={(e) => {\r\n                          if (loadingCtx.loading) return;\r\n                          loadingCtx.startLoading();\r\n                        StudentsDataService\r\n                            .downloadSubresource(currentStudent[\"id\"], 'grantLetter')\r\n                            .then(...errorHandler({snackbarSuccess: true}))\r\n                            .finally(() => {\r\n                                loadingCtx.stopLoading();\r\n                            })\r\n                      }}\r\n                  >\r\n                    {t(\"grant_letter\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n              </Box>\r\n\r\n              <Box className={[classes.line, classes.composite]}>\r\n                {!loading && !newStudent && hasNeeds([NEEDS.send_email]) &&\r\n                <Tooltip style={{flex: 1}} title={t(\"send_enrolment_agreement\")}\r\n                                                     aria-label={t(\"enrolment_agreement\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<SendIcon/>}\r\n                      disabled={loadingCtx.loading}\r\n                      onClick={(e) => {\r\n                        sendEnrollmentAgreement();\r\n                      }}\r\n                  >\r\n                    {t(\"enrolment_agreement\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n\r\n                {!loading && !newStudent && <Tooltip style={{flex: 1}} title={t(\"export_enrolment_agreement\")}\r\n                                                     aria-label={t(\"export_enrolment_agreement\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<GetAppIcon/>}\r\n                      disabled={loadingCtx.loading}\r\n                      onClick={(e) => {\r\n                          if (loadingCtx.loading) return;\r\n                          loadingCtx.startLoading();\r\n                        StudentsDataService\r\n                            .downloadSubresource(currentStudent[\"id\"], 'enrolmentAgreement')\r\n                            .then(...errorHandler({snackbarSuccess: true}))\r\n                            .finally(() => {\r\n                                loadingCtx.stopLoading();\r\n                            })\r\n                      }}\r\n                  >\r\n                    {t(\"enrolment_agreement\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n              </Box>\r\n            </Box>\r\n        </Box>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nexport default Attendee;","import serviceFactory from \"./service-factory\";\r\nimport {API_VERSION, BACKEND_URL} from \"../config\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport axios from \"axios\";\r\n\r\n\r\nexport const sendGrantEmail = (id) => {  // todo abstract\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'post',\r\n                    url: `${BACKEND_URL}/emails/v1/grantEmail/${id}`,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (res) {\r\n                        resolve(res);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        };\r\n\r\n","import serviceFactory from \"./service-factory\";\r\nimport {API_VERSION, BACKEND_URL} from \"../config\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport axios from \"axios\";\r\n\r\n\r\nexport const sendEnrollmentEmail = (id) => {  // todo abstract\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'post',\r\n                    url: `${BACKEND_URL}/emails/v1/enrolmentEmail/${id}`,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (res) {\r\n                        resolve(res);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        };\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('students', 'guardians'))();\r\n\r\n","export const student_guardian_relations = [\r\n    'father',\r\n    'mother',\r\n    'grandfather',\r\n    'grandmother',\r\n    'brother',\r\n    'sister',\r\n    'uncle',\r\n    'aunt',\r\n    'cousin',\r\n    'legal_guardian',\r\n    'ss_agent',\r\n    'other'\r\n]","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {MenuItem} from \"@material-ui/core\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport StudentGuardianDataService from \"../_services/student_guardians.service\"\r\nimport {student_guardian_relations} from \"../_data/relations\"\r\nimport Person from \"./students.student.person.component\";\r\nimport GuardiansDataService from \"../_services/guardians.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport * as yup from \"yup\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {emptyGuardian} from \"../_data/empty_objects\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\n\r\nfunction Guardian({  studentId, title, guardianId, deleteGuardianId, addGuardianId, deleteNewGuardian, newGuardian=false, ...other }) {\r\n  const { t } = useTranslation();\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [guardian, setGuardian] = useState(null);\r\n\r\n   const [hasNeeds, NEEDS] = useNeeds();\r\n  useEffect(() => {\r\n    if (newGuardian) return;\r\n\r\n    GuardiansDataService\r\n            .getOne(guardianId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setGuardian(res[\"data\"]);\r\n\r\n                });\r\n  }, [guardianId]);\r\nconst confirm = React.useContext(confirmContext);\r\n  return (\r\n    <React.Fragment>\r\n\r\n\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n\r\n              {hasNeeds([NEEDS.delete]) && <IconButton style={{float: 'right'}} onClick={(e) => {\r\n                if (!newGuardian) {\r\n                  confirm.confirm(\"delete_guardian_question\", \"not_undone\", () => {\r\n                    GuardiansDataService\r\n                      .delete(guardianId)\r\n                      .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n                      .then(function (res) {\r\n                        deleteGuardianId(guardianId);\r\n                      });\r\n                  })\r\n                  return;\r\n                }\r\n                deleteNewGuardian();\r\n              }}>\r\n                <Tooltip title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                  <DeleteIcon/>\r\n                </Tooltip>\r\n              </IconButton>}\r\n\r\n\r\n              <Person currentPerson={newGuardian? emptyGuardian: guardian}\r\n                      studentId={studentId}\r\n                      newPerson={newGuardian}\r\n                      updateCurrentStudent={(x) => {\r\n                        if (!newGuardian) return setGuardian(x);\r\n                        StudentGuardianDataService.postWithId(studentId, x)\r\n                          .then(...errorHandler({snackbarSuccess: true}))\r\n                          .then(() => {\r\n                          addGuardianId(x);\r\n                        });\r\n                      }}\r\n                      patchService={GuardiansDataService}\r\n                      additionalValidation={{\r\n                        relation: yup.string().required(t(\"relation_required\"))}}\r\n                      additionalFields={\r\n                        [[<DirtyTextField\r\n                                label={t(\"relation\")}\r\n                                style={{flex: 1}}\r\n                                name=\"relation\"\r\n                                select\r\n                            >\r\n                          {student_guardian_relations.map((r) => (\r\n                                   <MenuItem key={r} value={r}>{t(r)}</MenuItem>\r\n                                ))}\r\n                                ))}\r\n\r\n                        </DirtyTextField>]]}\r\n              />\r\n\r\n            </Box>\r\n        </Box>\r\n\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default Guardian;","import {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport AccountBalanceIcon from '@material-ui/icons/AccountBalance';\r\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport clsx from 'clsx';\r\nimport AccountBalanceWalletIcon from '@material-ui/icons/AccountBalanceWallet';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ReceiptIcon from '@material-ui/icons/Receipt';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport EuroIcon from '@material-ui/icons/Euro';\r\nimport PaymentsDataService from '../_services/payments.service';\r\nimport {sendReceiptEmail} from '../_services/emailsReceipts.service';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {Button, DialogActions, MenuItem} from \"@material-ui/core\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport * as yup from \"yup\";\r\nimport {one_of} from \"../_yup/validators\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {payment_methods} from \"../_data/payment_methods\"\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    maxWidth: '100%',\r\n    backgroundColor: theme.palette.type === 'dark'? '#575757': null\r\n  },\r\n  expand: {\r\n    transform: 'rotate(0deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n      duration: theme.transitions.duration.shortest,\r\n    }),\r\n  },\r\n  expandOpen: {\r\n    transform: 'rotate(180deg)',\r\n  },\r\n  avatar: {\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nexport default function PaymentCard({ payment, updatePayment, deletePayment, newPayment=false, addPaymentId, student_id} ) {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const [expanded, setExpanded] = React.useState(newPayment);\r\n  const errorHandler = useErrorHandler();\r\n  const [hasNeeds, NEEDS] = useNeeds();\r\n  const handleExpandClick = () => {\r\n    setExpanded(!expanded);\r\n  };\r\n\r\n  const confirm = React.useContext(confirmContext);\r\nconst loadingCtx = React.useContext(loadingContext);\r\n\r\nconst sendReceipt = (id) => {\r\n     loadingCtx.startLoading();\r\n      sendReceiptEmail(id)\r\n          .then(...errorHandler({snackbarSuccess:true}))\r\n          .finally(() => {\r\n              loadingCtx.stopLoading();\r\n          });\r\n}\r\n  const formik = useNormik(!newPayment, {\r\n        initialValues: payment,\r\n        validationSchema: yup.object({method: one_of(t, payment_methods),\r\n                                        quantity: yup.number().required(t(\"import_required\")),\r\n                                        date: yup.date().required(t(\"date_required\"))}),  // todo\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n            if (Object.keys(changedValues).length > 0){\r\n                setStatus();\r\n\r\n                if (newPayment) {\r\n                    PaymentsDataService\r\n                        .post({...changedValues, student_id: student_id})\r\n                        .then(...errorHandler({snackbarSuccess:true}))\r\n                        .then(function (res) {\r\n                            addPaymentId(res['id']);\r\n                            confirm.confirm(\"send_receipt\", \"send_receipt\",\r\n                                () => sendReceipt(res['id']))\r\n                            }).catch(function (err){\r\n                                setStatus(true);\r\n                            })\r\n                        .finally(() => {\r\n                                setSubmitting(false);\r\n\r\n                        });\r\n                } else {\r\n                    PaymentsDataService.patch({\r\n                      id: payment[\"id\"],    // id\r\n                      body: changedValues,\r\n                      initial_values: payment  // todo doesnt normik do this?\r\n                  }).then(...errorHandler({snackbarSuccess:true}))\r\n                        .then(function (patched_body) {\r\n                                formik.resetForm(patched_body);\r\n                                updatePayment(patched_body['id'], patched_body);\r\n                            }).catch(function (err){\r\n                                setStatus(true);\r\n                    })\r\n                        .finally(() => {\r\n                                setSubmitting(false);\r\n                        });\r\n\r\n                }\r\n\r\n                    } else {\r\n                setSubmitting(false);\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n\r\n  return (\r\n      <Box my={2}>\r\n    <Card className={classes.root}>\r\n      <CardHeader\r\n        avatar={\r\n          <Tooltip title={payment[\"method\"] === 'cash'? t('has_paid_cash'):\r\n                payment[\"method\"] === 'bank-transfer' ? t('tooltip-bank-transfer'):\r\n                    payment[\"method\"] === 'bank-direct-debit'? t('tooltip-bank-direct-debit'):\r\n                        t('other-payment-method')\r\n            }>\r\n          <Avatar aria-label=\"recipe\" className={classes.avatar}>\r\n            {payment[\"method\"] === 'cash'? <EuroIcon/>:\r\n                payment[\"method\"] === 'bank-transfer'? <AccountBalanceWalletIcon/>:\r\n                    payment[\"method\"] === 'bank-direct-debit'? <AccountBalanceIcon/>:\r\n                    <MoreHorizIcon/>\r\n            }\r\n          </Avatar>\r\n        </Tooltip>\r\n\r\n        }\r\n        action={\r\n         hasNeeds([NEEDS.delete]) && <Tooltip title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n          <IconButton onClick={(e) => {\r\n              confirm.confirm(\"delete_payment\", \"not_undone\", () => {\r\n                  deletePayment(payment['id'])\r\n              });\r\n\r\n          }}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n        }\r\n        title={newPayment? t('new_payment') : `${t(\"has_paid\")} ${payment['quantity']}€`}\r\n        subheader={payment['date']}\r\n      />\r\n\r\n        {!newPayment && <CardActions disableSpacing>\r\n            {hasNeeds([NEEDS.paymentReceipts]) &&\r\n            <Tooltip title={t(\"export_receipt\")} aria-label={t(\"export_receipt\")}>\r\n          <IconButton disabled={loadingCtx.loading} aria-label={t(\"export_receipt\")} onClick={(e) => {\r\n              loadingCtx.startLoading();\r\n              PaymentsDataService\r\n                  .downloadSubresource(payment[\"id\"], 'receipt')\r\n                  .then(...errorHandler({snackbarSuccess:true}))\r\n                  .finally(() => {\r\n                      loadingCtx.stopLoading();\r\n                  })\r\n          }}>\r\n            <ReceiptIcon />\r\n          </IconButton>\r\n        </Tooltip>}\r\n            {hasNeeds([NEEDS.paymentReceipts, NEEDS.send_email]) &&\r\n        <Tooltip title={t(\"send_receipt\")} aria-label={t(\"send_receipt\")}>\r\n          <IconButton  disabled={loadingCtx.loading} aria-label={t(\"send_receipt\")} onClick={() => sendReceipt(payment['id'])}>\r\n            <SendIcon />\r\n          </IconButton>\r\n        </Tooltip>}\r\n        <IconButton\r\n          className={clsx(classes.expand, {\r\n            [classes.expandOpen]: expanded,\r\n          })}\r\n          onClick={handleExpandClick}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n        >\r\n          <ExpandMoreIcon />\r\n        </IconButton>\r\n      </CardActions>}\r\n      <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n        <CardContent>\r\n          <Box>\r\n            {payment === null\r\n                ?\r\n                (\r\n\r\n                    <Box>\r\n                        {\r\n                            [\"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0}>\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })\r\n                        }\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                        <form onSubmit={formik.handleSubmit}>\r\n                                        <DirtyTextField\r\n                                            label={t(\"id\")}\r\n                                            name=\"id\"\r\n                                            disabled\r\n                                            className={classes.line}\r\n                                            formik={formik}\r\n                                            />\r\n\r\n                                        <Box className={[classes.line, classes.composite]}>\r\n                                            <DirtyTextField\r\n                                                label={t(\"method\")}\r\n                                                style={{flex: 1}}\r\n                                                formik={formik}\r\n                                                name=\"method\"\r\n                                                select>\r\n                                                { payment_methods.map(\r\n                                                    (method) => (\r\n                                                        <MenuItem key={method} value={method}>{t(method)}</MenuItem>\r\n                                                    )\r\n                                                )\r\n                                                }\r\n                                            </DirtyTextField>\r\n                                            <DirtyTextField\r\n                                                label={t(\"import\")}\r\n                                                formik={formik}\r\n                                                type=\"number\"\r\n                                                style={{flex: 1}}\r\n                                                name=\"quantity\"\r\n                                                InputProps={{\r\n                                                    endAdornment: <InputAdornment position=\"end\">€</InputAdornment>,\r\n                                                  }}\r\n                                            />\r\n                                            <DirtyTextField\r\n                                                label={t(\"date\")}\r\n                                                formik={formik}\r\n                                                type=\"date\"\r\n                                                style={{flex: 1}}\r\n                                                name=\"date\"\r\n                                                InputLabelProps={{shrink: true}}/>\r\n                                        </Box>\r\n\r\n                             <Box className={[classes.line, classes.composite]}>\r\n                                            <DirtyTextField\r\n                                                label={t(\"concept\")}\r\n                                                formik={formik}\r\n                                                style={{flex: 1}}\r\n                                                multiline\r\n                                                rowsMax={8}\r\n                                                name=\"concept\"\r\n                                            />\r\n                                        </Box>\r\n\r\n\r\n                                        <DialogActions>\r\n                                            <Button\r\n                                                type=\"button\"\r\n                                                className=\"outline\"\r\n                                                onClick={formik.handleReset}\r\n                                                disabled={!formik.dirty || formik.isSubmitting}\r\n                                            >\r\n                                                {t(\"reset\")}\r\n                                            </Button>\r\n                                            {hasNeeds([NEEDS.patch]) && <Button type=\"submit\" disabled={!formik.dirty || formik.isSubmitting}>\r\n                                                {newPayment ? t(\"create\") : t(\"save\")}\r\n                                            </Button>}\r\n                                        </DialogActions>\r\n                                    </form>\r\n                )\r\n\r\n            }\r\n        </Box>\r\n        </CardContent>\r\n      </Collapse>\r\n    </Card></Box>\r\n  );\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\nimport {API_VERSION, BACKEND_URL} from \"../config\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport axios from \"axios\";\r\n\r\n\r\nexport const sendReceiptEmail = (id) => {  // todo abstract\r\n            return new Promise(function (resolve, reject) {\r\n                axios({\r\n                    method: 'post',\r\n                    url: `${BACKEND_URL}/emails/v1/paymentReceipt/${id}`,\r\n                    headers: {\r\n                        ...{\r\n                            'Content-Type': 'application/json',\r\n                            'Cache-Control': 'no-cache'\r\n                        }, ...authHeader()\r\n                    }\r\n                }).then(function (res) {\r\n                        resolve(res);\r\n                    }).catch(function (err) {\r\n                        reject(err);\r\n                });\r\n            });\r\n        };\r\n\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport PaymentsDataService from \"../_services/payments.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport PaymentCard from \"./students.student.payments.payment.component\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\n\r\nconst getDefaultValues = () => {\r\n    const date = new Date();\r\n    const dd = date.getDate();\r\n    const mm = date.getMonth() + 1; //Month from 0 to 11\r\n    const yyyy = date.getFullYear();\r\n    return {'id': null, 'date': `${yyyy}-${mm<=9 ? '0' + mm : mm}-${dd <= 9 ? '0' + dd : dd}`, 'quantity': null, 'concept': null, 'method': null}\r\n}\r\nconst useStyles = makeStyles((theme) => ({\r\n\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  newLine: {\r\n    width: '100%',\r\n       marginTop: theme.spacing(1),\r\n        display: \"flex\",\r\n    flexDirection: \"column\"\r\n  }\r\n}));\r\n\r\nfunction Payments({ children,  title, paymentIds, deletePaymentFromStudent, addPaymentId, student_id, ...other }) {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n  const loading = paymentIds === null;\r\n\r\n  const [payments, setPayments] = useState([]);\r\n  const [newPaymentCard, setNewPaymentCard] = useState(false);\r\n\r\n  useEffect(()=>{\r\n    setNewPaymentCard(false);\r\n  }, [payments])\r\n\r\n  const updatePayment = (id, body) => {\r\n    setPayments(payments.map(payment => {\r\n      if (payment.id !== id) return payment;\r\n      return body;\r\n    }))\r\n  }\r\n  const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n  const deletePayment = (id) => {\r\n    PaymentsDataService.delete(id)\r\n        .then(...errorHandler({snackbarSuccess:true}))\r\n        .then(function (r) {\r\n             deletePaymentFromStudent(id);\r\n        });\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (paymentIds === null) return;\r\n\r\n    if (paymentIds.length === 0){\r\n      setPayments([]);\r\n    } else {\r\n      PaymentsDataService\r\n            .getMany(paymentIds)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setPayments(res.map(res => res[\"data\"]).sort((p1, p2) => p1.date.localeCompare(p2.date)));\r\n                });\r\n    }\r\n  }, [paymentIds])\r\n\r\n  return (\r\n    <Box p={3}>  {// todo simplify everywhere\r\n        } <Box px={2}>\r\n\r\n              {loading?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n              hasNeeds([NEEDS.post]) && <Tooltip className={classes.actionIcon} title={t(\"new_payment\")} aria-label={t(\"new_payment\")}>\r\n                <IconButton onClick={(e) => { setNewPaymentCard(true); }}>\r\n                  <AddCircleIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              <div className={classes.newLine}>\r\n\r\n              {\r\n                payments && payments.map(payment =>\r\n                    (<PaymentCard payment={payment} key={payment['id']} updatePayment={updatePayment} deletePayment={deletePayment}/>)\r\n                )\r\n              }\r\n\r\n              {newPaymentCard &&\r\n                <PaymentCard payment={getDefaultValues()}\r\n                             updatePayment={updatePayment}\r\n                             deletePayment={(_) => {setNewPaymentCard(false)}}\r\n                            newPayment={true}\r\n                             student_id={student_id}\r\n                addPaymentId={addPaymentId}/>\r\n              }\r\n\r\n              {loading &&\r\n                <Skeleton width=\"100%\" height=\"250px\"/>  // todo we can do better\r\n              }\r\n\r\n              {!loading && payments.length === 0 && !newPaymentCard &&\r\n                <Typography>{t(\"no_payments\")}</Typography>\r\n              }\r\n              </div>\r\n            </Box>\r\n        </Box>\r\n  );\r\n}\r\n\r\nPayments.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n};\r\n\r\nexport default Payments;","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('schedules'))();\r\n\r\n","import React from \"react\";\r\n\r\nconst tabContext = React.createContext(\r\n    {currentTab: null, goTo: (res) => {}}); // Create a context object\r\n\r\nexport {\r\n  tabContext // Export it so it can be used by other Components\r\n};","import Box from \"@material-ui/core/Box\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport SchedulesDataService from \"../_services/schedules.service\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport FullCalendar from \"@fullcalendar/react\";\r\nimport timeGridPlugin from '@fullcalendar/timegrid';\r\nimport styled from \"@emotion/styled\";\r\nimport {useTheme} from '@material-ui/core/styles';\r\nimport interactionPlugin from '@fullcalendar/interaction';\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport {Dialog, DialogActions, DialogContent, DialogTitle, TextField} from \"@material-ui/core\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nimport {tabContext} from \"../_context/tab-context\";\r\n\r\n\r\nexport const eventFromSchedule = (theme, schedule) => {\r\n    return {\r\n        daysOfWeek: [schedule['day_week']],\r\n        title: schedule['display_name'],\r\n        groupId: [schedule['id']],\r\n        id: schedule['id'],\r\n        startTime: schedule['start_time'],\r\n        endTime: schedule['end_time'],\r\n        color: schedule[\"is_base\"] ? theme.palette.secondary.main : theme.palette.secondary.light,\r\n        textColor: schedule[\"is_base\"] ? theme.palette.secondary.contrastText : theme.palette.secondary.contrastText,\r\n        extendedProps: {\r\n            schedule: schedule\r\n        },\r\n    }\r\n}\r\n\r\nfunction evaluate(expression, ...args){\r\n    console.log(typeof expression);\r\n    if (typeof expression === 'function'){\r\n        return expression(...args);\r\n    }\r\n\r\n    return expression;\r\n}\r\n\r\nfunction Scheduler({snapDuration = '00:15',\r\n                       allowView=false, viewUrl=null,\r\n                        allowDelete=false,\r\n                    selectable=false,\r\n                       viewStudent=false, deleteCustom=false,\r\n                      scheduleIds,\r\n                    setScheduleIds,\r\n                       onEventClick, onEventSelected,\r\n                       onEventChange, editable=false, ...other}) {\r\n    const errorHandler = useErrorHandler();\r\n    const theme = useTheme();\r\n    const calendarRef = React.createRef();\r\n    const StyleWrapper = styled.div`\r\n      .fc-button, .fc-button.fc-button-primary {\r\n        background: ${theme.palette.primary.main};\r\n        color: ${theme.palette.primary.contrastText};\r\n        border-color: ${theme.palette.primary.main};\r\n        background-image: none;\r\n    }\r\n    .fc-button:enabled:hover {\r\n        background: ${theme.palette.primary.dark};\r\n        color: ${theme.palette.primary.contrastText};\r\n        border-color: ${theme.palette.primary.dark};\r\n        background-image: none;\r\n    }\r\n    `\r\n\r\n    const [schedules, setSchedules] = useState(null);\r\n\r\n\r\n    const loading = scheduleIds === null;\r\n    const {t} = useTranslation();\r\n    // todo right click menu to delete\r\n\r\n\r\n    useEffect(() => {\r\n        if (scheduleIds === null) return;\r\n\r\n        if (scheduleIds.length === 0) {\r\n            setSchedules([]);\r\n        } else {\r\n            SchedulesDataService\r\n                .getMany(scheduleIds)\r\n                .then(...errorHandler({}))\r\n                .then(function (res) {\r\n                    setSchedules(res.map(res => res[\"data\"]).map(schedule => {\r\n                        return eventFromSchedule(theme, schedule);\r\n                    }));\r\n                });\r\n        }\r\n    }, [scheduleIds, theme]);\r\n\r\n    const withScheduleInfo = (method, info) => {\r\n        return method(info,\r\n            info.event['start'].getDay(),\r\n            info.event['start'].toLocaleTimeString('en-US', {hour12: false}),\r\n            info.event['end'].toLocaleTimeString('en-US', {hour12: false}),\r\n            info.event.extendedProps[\"schedule\"]);\r\n    }\r\n    const navigator = React.useContext(tabContext);\r\n\r\n    const [currentSchedule, setCurrentSchedule] = React.useState({open: false, event: null, schedule: null})\r\n\r\n      const handleClickOpen = (info) => {\r\n        setCurrentSchedule({open: true, event: info.event, schedule: info.event.extendedProps['schedule']});\r\n      };\r\n\r\n      const handleClose = () => {\r\n        setCurrentSchedule({open: false, event: null, schedule: null});\r\n      };\r\n      const handleView = () => {\r\n          navigator.goTo(...evaluate(viewUrl, currentSchedule.schedule));\r\n          handleClose();\r\n      }\r\n      const handleDelete = () => {\r\n          SchedulesDataService\r\n               .delete(currentSchedule.schedule.id)\r\n               .then(...errorHandler({snackbarSuccess: true}))\r\n               .then(function (res) {\r\n                  handleClose();\r\n                    setScheduleIds(scheduleIds.filter(id => id !== currentSchedule.schedule.id));\r\n                    setSchedules(schedules.filter(s => s.id !== currentSchedule.schedule.id));\r\n               });\r\n      }\r\n\r\n    return (\r\n        <Box p={2} style={{height: '100%', flex: 1, minHeight: \"70vh\" }}>\r\n            {loading ? <Skeleton variant=\"rect\" width=\"100%\" height=\"100%\"/>\r\n                :\r\n                <React.Fragment>\r\n                    <Dialog open={currentSchedule.open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n                        <DialogTitle id=\"form-dialog-title\">{currentSchedule.schedule? currentSchedule.schedule[\"display_name\"]: \"\"}</DialogTitle>\r\n                        <DialogActions>\r\n                          <Button onClick={handleClose} color=\"primary\">\r\n                              {t(\"cancel\")}\r\n                          </Button>\r\n\r\n                             <Button\r\n                                 disabled={!(currentSchedule.schedule !== null &&\r\n                                            evaluate(allowView, currentSchedule.schedule))}\r\n                                 onClick={handleView}\r\n                                 color=\"primary\">\r\n                                {t(\"view\")}\r\n                            </Button>\r\n\r\n                            <Button\r\n                                    disabled={!(currentSchedule.schedule !== null &&\r\n                                            evaluate(allowDelete, currentSchedule.schedule))}\r\n                                    onClick={handleDelete}\r\n                                    color=\"secondary\">\r\n                                    {t(\"delete\")}\r\n                            </Button>\r\n                        </DialogActions>\r\n                      </Dialog>\r\n                    <StyleWrapper style={{height: \"100%\"}}>\r\n                    <FullCalendar\r\n                        plugins={[timeGridPlugin, interactionPlugin]}\r\n                        initialView=\"timeGridWeek\"\r\n                        height=\"100%\"\r\n                        firstDay={1}\r\n                        ref={calendarRef}\r\n                        editable={editable}\r\n                        buttonText={{\r\n                            prev:     '<', // <\r\n                              next:     '>', // >\r\n                              prevYear: '<<',  // <<\r\n                              nextYear: '>>',  // >>\r\n                              today:    'today',\r\n                              month:    'month',\r\n                              week:     'week',\r\n                              day:      'day'\r\n                        }}\r\n                        selectable={selectable}\r\n                        selectMirror={true}\r\n                        dayMaxEvents={true}\r\n                        weekends={true}\r\n                        snapDuration={snapDuration}\r\n                        events={schedules}\r\n                        eventAdd={function () {\r\n                        }}\r\n                        eventChange={function (clickInfo) {\r\n                            // const schedule = clickInfo.event.extendedProps[\"schedule\"];\r\n                            // if (schedule[\"is_base\"] === true) return enqueueSnackbar(t(\"cant_remove_schedule\"), {'variant': 'warning'});\r\n                        }}\r\n                        eventRemove={function () {\r\n                        }}\r\n                        select={function (selectInfo) {\r\n                            selectInfo.view.calendar.unselect();\r\n                            onEventSelected( selectInfo.start.getDay(),\r\n            selectInfo.start.toLocaleTimeString('en-US', {hour12: false}),\r\n            selectInfo.end.toLocaleTimeString('en-US', {hour12: false}),)\r\n                        }}\r\n                        eventContent={function () {\r\n                        }} // custom render function\r\n                        eventClick={(info) => {\r\n                            /* let calendarApi = calendarRef.current.getApi();\r\n                              console.log(calendarApi.getEventById(info.event.id).remove());\r\n                              setSchedules(schedules.filter(s=>s.id !== info.event.id));*/\r\n                            handleClickOpen(info);\r\n                        }}\r\n                        eventTimeFormat={{\r\n                            hour: '2-digit',\r\n                            minute: '2-digit',\r\n                            hour12: false\r\n                        }}\r\n                        eventResize={(info) => (withScheduleInfo(onEventChange, info))}\r\n                        eventDrop={(info) => (withScheduleInfo(onEventChange, info))}\r\n                    />\r\n                </StyleWrapper>\r\n                </React.Fragment>\r\n                }\r\n        </Box>\r\n    );\r\n}\r\n\r\nexport default Scheduler;","import {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport SchedulesDataService from \"../_services/schedules.service\";\r\nimport {makeStyles, useTheme} from \"@material-ui/core/styles\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport Scheduler, {eventFromSchedule} from \"./scheduler.component\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    calendar: {\r\n      margin: theme.spacing(2)\r\n    }\r\n\r\n}));\r\n\r\n\r\nfunction Schedule({ title, scheduleIds, setScheduleIds, student_id, ...other }) {\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <div style={{height: '100%', flex: 1, minHeight: \"70vh\" }}>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Schedule;","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('students', 'courses'))();\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('courses'))();\r\n\r\n","import React from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: '2px 4px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    width: '100%',\r\n  },\r\n  input: {\r\n    marginLeft: theme.spacing(1),\r\n    flex: 1,\r\n  },\r\n  iconButton: {\r\n    padding: 10,\r\n  }\r\n}));\r\n\r\nexport default function SearchBar({label, searchTitle, onChange, onSearch}) {\r\n  const classes = useStyles();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Paper className={classes.root}>\r\n      <InputBase\r\n        className={classes.input}\r\n        placeholder={t(\"search\")+ \" \" + label}\r\n        inputProps={{ 'aria-label': 'search ' + label}}\r\n        value={searchTitle}\r\n        onChange={onChange}\r\n        onKeyPress={(e) =>\r\n        { if(e.key === 'Enter'){\r\n            onSearch();\r\n            e.preventDefault();\r\n        } }}\r\n\r\n      />\r\n      <IconButton\r\n          type=\"submit\"\r\n          className={classes.iconButton}\r\n          aria-label=\"search\"\r\n            onClick={onSearch}>\r\n        <SearchIcon/>\r\n      </IconButton>\r\n    </Paper>\r\n  );\r\n}","import React from \"react\";\r\n\r\nconst themeContext = React.createContext({theme: null, switchTheme: () => {}, label: null}); // Create a context object\r\n\r\nexport {\r\n  themeContext // Export it so it can be used by other Components\r\n};","import React from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Chip, CircularProgress} from \"@material-ui/core\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: '2px 4px',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    flexWrap: 'wrap'\r\n  },\r\n}));\r\n\r\nexport default function ExportSearchChip({searchTermField=\"full_name\", searchTerm=null, page=null, dataService, exportAll=false, getFilters=null}) {\r\n  const classes = useStyles();\r\n\r\n  const {t} = useTranslation();\r\n  const errorHandler = useErrorHandler();\r\n  const loadingCtx = React.useContext(loadingContext);\r\n\r\n  return (\r\n      <Tooltip title={t(exportAll ? \"export_all_csv\" : \"export_results_csv\")}\r\n               aria-label={t(exportAll ? \"export_all_csv\" : \"export_results_csv\")}>\r\n\r\n        <Chip variant=\"outlined\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              disabled={loadingCtx.loading}\r\n              avatar={<Avatar>csv</Avatar>}\r\n              label={t(exportAll ? \"export_all\" : \"export\")}\r\n              onClick={() => {\r\n                if (loadingCtx.loading) return;\r\n\r\n                loadingCtx.startLoading();\r\n                dataService\r\n                    .downloadCsv(searchTermField, searchTerm,\r\n                        exportAll ? \"*\" : page,\r\n                        getFilters === null ? {} : getFilters(),\r\n                        exportAll)\r\n                    .then(...errorHandler({}))\r\n                    .finally(() => {\r\n                      loadingCtx.stopLoading();\r\n                    })\r\n              }}/>\r\n      </Tooltip>\r\n\r\n  );\r\n}","import React, {useEffect, useState} from \"react\";\r\nimport Pagination from '@material-ui/lab/Pagination';\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport makeStyles from \"@material-ui/core/styles/makeStyles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport SearchBar from './searchbar.component'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Accordion, AccordionDetails, AccordionSummary, Chip, ListItemSecondaryAction} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport ExportSearchChip from \"./ExportSearchChip.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        flex: 1,\r\n        overflow: 'auto',\r\n        display: \"flex\",\r\n        flexDirection: \"column\"\r\n    },\r\n    list: {\r\n        overflow: \"auto\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        flex: 1,\r\n        minHeight: '150px'\r\n    },\r\n    searchAndFilters: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n    pagination: {\r\n        margin: theme.spacing(3)\r\n    },\r\n    chip: {\r\n        margin: theme.spacing(2)\r\n    },\r\n    avatar: {},\r\n    selectedAvatar: {\r\n        backgroundColor: theme.palette.primary.dark\r\n    },\r\n    chips: {\r\n        flexWrap: 'wrap',\r\n        '& > *': {\r\n            margin: theme.spacing(0.5),\r\n        },\r\n        heading: {\r\n            fontSize: theme.typography.pxToRem(15),\r\n            fontWeight: theme.typography.fontWeightRegular,\r\n        },\r\n    },\r\n    noResults: {\r\n        textAlign: 'center'\r\n    }\r\n}));\r\n\r\nconst ItemsList = ({setCurrentItemId=() => {}, auxFields = [], displayText = null, onItemClick = () => {}, parent_id=null, secondaryDisplayNameField=null,\r\n                        secondaryAction=null, secondaryActionNeeds=[], secondaryActionTooltip=null, secondaryActionIcon=null, secondaryActionCallable=null,\r\n                       withAvatar=true, withFiltersBox = true,\r\n                       chips=[], currentItemId = null, items, setItems, displayNameField=\"full_name\",\r\n                       usableFilters=[], defaultSearchBy=\"full_name\", searchByOptions=[\"full_name\"],\r\n                        dataService, searchBarLabel, exportPage=true, exportAllPages=true}) => {\r\n    const [searchTerm, setSearchTerm] = useState(\"\");\r\n    const [filters, setFilters] = useState(usableFilters.reduce((map, f) => {\r\n        map[f.name] = f.initialValue;\r\n        return map;\r\n        }, {})\r\n    );\r\n    const [searchBy, setSearchBy] = useState(defaultSearchBy);\r\n\r\n    const {t} = useTranslation();\r\n\r\n    const [page, setPage] = useState(1);\r\n    const [count, setCount] = useState(0);\r\n    const errorHandler = useErrorHandler();\r\n     const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n    const classes = useStyles();\r\n\r\n    const onChangeSearchTerm = (e) => {\r\n        setSearchTerm(e.target.value);\r\n    };\r\n\r\n    const resetSearchBy = () => {\r\n        setSearchBy(defaultSearchBy);\r\n    }\r\n\r\n    function getFilters(){\r\n        return Object.fromEntries(Object.entries(filters).filter(([k,v]) => (v !== null)))\r\n    }\r\n\r\n    function search() {\r\n        dataService\r\n            .getAll({name: searchBy, value: searchTerm}, page, [...new Set(['id', displayNameField, secondaryDisplayNameField === null? 'id': secondaryDisplayNameField, ...auxFields])], getFilters(), parent_id)\r\n            .then(...errorHandler({}))\r\n            .then(function (res) {\r\n                setItems(res[\"data\"]);\r\n                setCount(res[\"_pagination\"][\"totalPages\"]);\r\n            });\r\n    }\r\n\r\n    // we don't want the search to trigger for each searchTerm change\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    useEffect(() => {\r\n        if (page === 1) {\r\n            search(); // no need to change page, since we are at page 1\r\n        } else {\r\n            setPage(1);  // will trigger search due tot the effect below\r\n        }\r\n    }, [filters]);  // todo\r\n\r\n    useEffect(search, [page, searchBy, parent_id]);\r\n\r\n    const handlePageChange = (event, value) => {\r\n        setPage(value);\r\n    };\r\n\r\n    return (\r\n        <Box className={classes.root}>\r\n            <Box className={classes.searchAndFilters}>\r\n                <SearchBar\r\n                    label={t(searchBarLabel)}\r\n                    value={searchTerm}\r\n                    onChange={onChangeSearchTerm}\r\n                    onSearch={() => {\r\n                        if (page === 1){\r\n                            search();\r\n                        } else {\r\n                            setPage(1);  // search will be triggered\r\n                        }\r\n\r\n                    }}\r\n                />\r\n\r\n                {withFiltersBox && <Accordion>\r\n                    <AccordionSummary expandIcon={<ExpandMoreIcon/>}>\r\n                        <Typography className={classes.heading}>{t(\"filters_actions\")}</Typography>\r\n                    </AccordionSummary>\r\n                    <AccordionDetails>\r\n                        <Box className={classes.chips}>\r\n\r\n                            {exportPage && Array.isArray(items) && items.length > 0 && <ExportSearchChip\r\n                                searchTerm={searchTerm}\r\n                                page={page}\r\n                                searchTermField={searchBy}\r\n                                dataService={dataService}\r\n                                getFilters={getFilters}\r\n                            />}\r\n                            {exportAllPages && Array.isArray(items) && items.length > 0 && <ExportSearchChip\r\n                                searchTerm={searchTerm}\r\n                                page={page}\r\n                                dataService={dataService}\r\n                                searchTermField={searchBy}\r\n                                exportAll={true}\r\n                                getFilters={getFilters}\r\n                            />}\r\n\r\n                            {chips.map((chip) => (\r\n                                chip\r\n                            ))}\r\n\r\n                            ·\r\n\r\n                            {searchByOptions.map(option => (\r\n                                <Tooltip key={option} title={`${t(\"search_by\")} ${t(option)}`}>\r\n                                    <Chip size=\"small\"\r\n                                          color={searchBy === option ? \"primary\" : \"default\"}\r\n                                          label={`${t(\"search_by\")} ${t(option)}`}\r\n                                          onClick={(e) => {\r\n                                              if (searchBy === option) {\r\n                                                  resetSearchBy();\r\n                                              } else {\r\n                                                  setSearchBy(option);\r\n                                              }\r\n                                          }}/>\r\n                                </Tooltip>\r\n                            ))}\r\n\r\n\r\n                            {usableFilters.map(f => (\r\n                                <React.Fragment>\r\n                                    · {f['options'].map(option => (\r\n                                        <Tooltip key={f.name + option.name}\r\n                                                 title={t(option.tooltip)}\r\n                                                 aria-label={t(option.tooltip)}>\r\n                                            <Chip size=\"small\"\r\n                                                  color={filters[f.name] === option.name ? \"primary\" : \"default\"}\r\n                                                  label={t(option.label)}\r\n                                                  onClick={(e) => {\r\n                                                      setFilters({\r\n                                                          ...filters,\r\n                                                          [f.name]: (filters[f.name] === option.name) ? null : option.name\r\n                                                      })\r\n                                                  }}/>\r\n                                        </Tooltip>\r\n                                    )\r\n                                )}\r\n\r\n                                </React.Fragment>))\r\n                            }\r\n                        </Box>\r\n                    </AccordionDetails>\r\n                </Accordion>}\r\n\r\n\r\n                <Box my={2}>\r\n                    <Pagination\r\n                        className=\"pagination\"\r\n                        count={count}\r\n                        page={page}\r\n                        size=\"small\"\r\n                        showFirstButton\r\n                        showLastButton\r\n                        siblingCount={1}\r\n                        boundaryCount={1}\r\n                        color=\"primary\"\r\n                        onChange={handlePageChange}\r\n                    />\r\n                </Box>\r\n            </Box>\r\n            <List className={classes.list}>\r\n                {items && items.map((item) => (\r\n                    <div key={item[\"id\"]}>\r\n                        <ListItem key={item[\"id\"]} button\r\n                                  onClick={() => {\r\n                                      onItemClick(item['id']);\r\n                                      setCurrentItemId(item['id']);\r\n                                  }}>\r\n                            {withAvatar && <ListItemAvatar>\r\n                                <Avatar\r\n                                    className={item[\"id\"] === currentItemId ? classes.selectedAvatar : classes.avatar}>{item[displayNameField].charAt(0).toUpperCase()}</Avatar>\r\n                            </ListItemAvatar>}\r\n                            <ListItemText id=\"name\" primary={displayText === null? item[displayNameField]: displayText(item)} secondary={secondaryDisplayNameField === null? null: item[secondaryDisplayNameField]}/>\r\n\r\n                            {secondaryAction &&  hasNeeds(secondaryActionNeeds) &&\r\n                            <ListItemSecondaryAction>\r\n                                <Tooltip title={t(secondaryActionTooltip)}>\r\n                                    <IconButton edge=\"end\" aria-label={t(\"export\")} onClick={(e) => {\r\n                                        secondaryActionCallable(item['id']);\r\n                                    }}>\r\n                                        {secondaryActionIcon}\r\n                                    </IconButton>\r\n                                </Tooltip>\r\n                            </ListItemSecondaryAction>}\r\n                        </ListItem>\r\n                        <Divider/>\r\n                    </div>\r\n                ))}\r\n                {\r\n                    (items.length === 0) && <Typography className={classes.noResults}>\r\n                        {t(\"no_results\") +\" 👀\"}\r\n                    </Typography>\r\n                }\r\n            </List>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default ItemsList;\r\n","import React from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport ItemsList from \"./items_list.component\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport {NEEDS} from \"../_helpers/needs\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\n\r\n\r\nconst ItemsListSecondary = ({dataService, displayText, auxFields, parent_id, deleteTooltip, delete_message, onItemDeleted = () => {}, ...props}) => {\r\n    const errorHandler = useErrorHandler();\r\n    const confirm = React.useContext(confirmContext);\r\n    const {t} = useTranslation();\r\n\r\n    return <ItemsList\r\n        secondaryAction={true}\r\n        withFiltersBox={false}\r\n        withAvatar={false}\r\n        secondaryActionCallable={(id) => {\r\n             confirm.confirm(delete_message, \"not_undone\", () => {\r\n                dataService\r\n                .delete(parent_id, id)\r\n                .then(...errorHandler({snackbarSuccess:true}))\r\n                .then(function (r) {\r\n                    onItemDeleted(id);\r\n                });\r\n            });\r\n        }}\r\n        parent_id={parent_id}\r\n        displayText={displayText}\r\n        auxFields={auxFields}\r\n        secondaryActionTooltip={deleteTooltip}\r\n        secondaryActionNeeds={[NEEDS.delete]}\r\n        secondaryActionIcon={<DeleteIcon/>}\r\n        dataService={dataService}\r\n        {...props}\r\n    />\r\n};\r\n\r\nexport default ItemsListSecondary;\r\n","import React, {useState} from \"react\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport ItemsList from \"./items_list.component\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\n\r\n\r\nconst ItemsListTerciary = ({dataService, dataServiceSR, add_message, parent_id, onAdded = () => {}, ...props}) => {\r\n    const errorHandler = useErrorHandler();\r\n    const confirm = React.useContext(confirmContext);\r\n    const [items, setItems] = useState([]);\r\n    return <ItemsList\r\n        secondaryAction={false}\r\n        items={items}\r\n        setItems={setItems}\r\n        withFiltersBox={false}\r\n        withAvatar={false}\r\n        dataService={dataService}\r\n        onItemClick={(id) => {\r\n            confirm.confirm(add_message,null,  () => {\r\n                if (dataServiceSR === null) return onAdded(id, null);\r\n                dataServiceSR\r\n                    .postWithId(parent_id, id)\r\n                    .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then((newItem) => {\r\n                        onAdded(id, newItem[\"data\"]);\r\n                    })\r\n            });\r\n\r\n        }\r\n        }\r\n        {...props}\r\n    />\r\n};\r\n\r\nexport default ItemsListTerciary;\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport React, {useState} from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport {\r\n    AppBar,\r\n    Dialog,\r\n    Slide\r\n} from \"@material-ui/core\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport ItemsListSecondary from \"./items_list_secondary.component\";\r\nimport ItemsListTerciary from \"./items_list_terciary.component\";\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport {tabContext} from \"../_context/tab-context\";\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  list: {\r\n        overflow: \"auto\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        flex: 1\r\n    },\r\n    box: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n    pagination: {\r\n        margin: '30px'\r\n    },\r\n    appBar: {\r\n    position: 'relative',\r\n  },\r\n  newLine: {\r\n    width: '100%',\r\n       marginTop: theme.spacing(1),\r\n        display: \"flex\",\r\n    flexDirection: \"column\"\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  }, actionIcon: {\r\n      float: 'right'\r\n    }\r\n}));\r\n\r\n\r\nfunction AddDeleteSubresource({  defaultSearchBy, displayText, auxFields, parentItemDataService, itemDataService, add_message_confirm, parent_id, secondaryDisplayNameField, searchByOptions, resourceName, displayNameField, add_message,onSubresourceAdded, onSubresourceDeleted, ...other}) {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  const [addDialogOpen, setAddDialogOpen] = useState(false);\r\n  const handleAddDialogClose = () => {\r\n        setAddDialogOpen(false);\r\n  };\r\n  const handleAddDialogOpen = () => {\r\n      setAddDialogOpen(true);\r\n  }\r\n\r\n   const [hasNeeds, NEEDS] = useNeeds();\r\n  const loading = parent_id === null;\r\n  const [items, setItems] = useState([]);\r\nconst navigator = React.useContext(tabContext);\r\n\r\n  return (\r\n\r\n        <Box p={3}>  {// todo simplify everywhere\r\n        } <Box px={2}>\r\n\r\n            <Dialog fullScreen open={addDialogOpen} onClose={handleAddDialogClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar} color=\"secondary\">\r\n          <Toolbar>\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n                {t(add_message)}\r\n            </Typography>\r\n            <Button autoFocus color=\"inherit\" onClick={handleAddDialogClose}>\r\n                {t(\"cancel\")}\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <Box className={classes.box} m={3}>\r\n            <ItemsListTerciary\r\n                    dataService={itemDataService}\r\n                    dataServiceSR={parentItemDataService}\r\n                    defaultSearchBy={defaultSearchBy}\r\n                    searchByOptions={searchByOptions}\r\n                    searchBarLabel={resourceName}\r\n                    displayNameField={displayNameField}\r\n                    secondaryDisplayNameField={secondaryDisplayNameField}\r\n                    parent_id={parent_id}\r\n                    add_message={add_message_confirm}\r\n                    onAdded={(id, body) => {\r\n                        setItems([...items, body]);\r\n                        onSubresourceAdded(id);\r\n                        handleAddDialogClose();\r\n                    }}\r\n                />\r\n            </Box>\r\n          </Dialog>\r\n\r\n              {loading?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n              hasNeeds([NEEDS.post]) && <Tooltip className={classes.actionIcon} title={t(add_message)} aria-label={t(add_message)}>\r\n                <IconButton onClick={handleAddDialogOpen}>\r\n                  <AddCircleIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n\r\n              <div className={classes.newLine}>\r\n                  {loading?\r\n                      <Skeleton width=\"100%\" height=\"250px\"/>\r\n                  :\r\n                <ItemsListSecondary\r\n                    dataService={parentItemDataService}\r\n                    defaultSearchBy={defaultSearchBy}\r\n                    searchByOptions={searchByOptions}\r\n                    items={items}\r\n                    setItems={setItems}\r\n                    displayText={displayText}\r\n                    auxFields={auxFields} \r\n                    searchBarLabel={resourceName}\r\n                    displayNameField={displayNameField}\r\n                    parent_id={parent_id}\r\n                    deleteTooltip={\"delete\"}\r\n                    delete_message={t(\"delete\") + \" \" + t(resourceName)}\r\n                    onItemDeleted={(id) => {\r\n                        setItems(items.filter(x => x.id !== id));\r\n                        onSubresourceDeleted(id);\r\n                    }}\r\n                    onItemClick={(id) => {\r\n                        navigator.goTo(resourceName, id);\r\n                    }}\r\n                />}\r\n              </div>\r\n            </Box>\r\n        </Box>\r\n\r\n  );\r\n}\r\n\r\nexport default AddDeleteSubresource;\r\n","import React from \"react\";\r\n\r\nexport function a11yProps(index) {\r\n  return {\r\n    id: `full-width-tab-${index}`,\r\n    'aria-controls': `full-width-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nfunction TabFrame({ value, index, children, ...other }) {\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`full-width-tabpanel-${index}`}\r\n      aria-labelledby={`full-width-tab-${index}`}\r\n      style={{height: '100%', flex: 1}}\r\n      {...other}>\r\n        {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TabFrame;","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport Attendee from \"./students.student.attendee.component\";\r\nimport Guardian from \"./students.student.guardian.component\";\r\nimport StudentsDataService from \"../_services/students.service\";\r\nimport Payments from \"./students.student.payments.component\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport Schedule from \"./students.student.schedule.component\";\r\nimport StudentsCourseDataService from \"../_services/student_courses.service\";\r\nimport CoursesDataService from \"../_services/courses.service\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport AddDeleteSubresource from \"./subresource_add_delete.component\";\r\nimport TabFrame, {a11yProps} from \"./tab\";\r\nimport SchedulesDataService from \"../_services/schedules.service\";\r\nimport Scheduler, {eventFromSchedule} from \"./scheduler.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  contentPanel: {\r\n    //flex: 1,\r\n      position: 'relative', // todo proper scrollbar\r\n    overflow: \"auto\",\r\n    boxSizing: \"border-box\",\r\n      height: '100%', // todo proper,\r\n    display: 'flex',\r\n      flexDirection: 'column'\r\n  },\r\n    content: {\r\n      overflowX: 'hidden',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        overflowY: 'auto',\r\n        flex: 1,\r\n        height: '100%'\r\n    },\r\n    tab: {\r\n      height: '100%'\r\n    }\r\n}));\r\n\r\n\r\n\r\n\r\nexport default function Student({setNewStudent,newStudent,addStudentId, currentStudentId, deleteStudent, ...props}) {\r\n\r\n  const loading = currentStudentId === null;\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [student, setStudent] = useState(null);  // todo rename to student\r\n  const [newGuardian, setNewGuardian] = useState(false);\r\n    const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n\r\n  useEffect(() => {\r\n    if (loading) return setStudent(null);\r\n    StudentsDataService\r\n            .getOne(currentStudentId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setStudent(res[\"data\"]);\r\n                });\r\n  }, [currentStudentId])\r\n\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const { t } = useTranslation();\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n   useEffect(()=>{\r\n    setValue(0);\r\n  }, [currentStudentId])\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setValue(index);\r\n  };\r\n\r\n\r\n\r\n  const guardians = student === null? []: student.guardians;\r\n    // todo maybe tabs with or only with icons\r\n  return (\r\n    <Paper elevation={3} square className={classes.contentPanel}>\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Tabs\r\n                  value={value}\r\n                  onChange={handleChange}\r\n                  indicatorColor=\"primary\"\r\n                  textColor=\"primary\"\r\n                  variant=\"scrollable\"\r\n                  scrollButtons=\"on\"\r\n                >\r\n                  <Tab label={t(\"attendee\")} {...a11yProps(0)} />\r\n\r\n                    { !newStudent && hasNeeds([NEEDS.schedules]) &&\r\n                  <Tab label={t(\"schedules\")} {...a11yProps(1)} />}\r\n                 { !newStudent  && hasNeeds([NEEDS.payments]) &&  <Tab label={t(\"payments\")} {...a11yProps(2)} />}\r\n                 { !newStudent  && hasNeeds([NEEDS.courses]) &&  <Tab label={t(\"courses\")} {...a11yProps(3)} />}\r\n\r\n                  {\r\n                  (!newStudent && guardians  && hasNeeds([NEEDS.guardians]) ) && guardians.map((contact, index) => (\r\n                  <Tab key={t(\"contact\") + \" \" + (index+1)} label={t(\"contact\") + \" \" + (index+1)} {...a11yProps(index+4)} />\r\n                      ))}\r\n\r\n\r\n                  {\r\n                    (!newStudent && newGuardian) &&\r\n                        <Tab key={t(\"new_guardian\")} label={t(\"new_guardian\")} {...a11yProps(4+guardians.length)} />\r\n                  }\r\n\r\n\r\n                </Tabs>\r\n              </AppBar>\r\n          <SwipeableViews\r\n            axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n            index={value}\r\n            containerStyle={{height: '100%'}}\r\n            className={classes.content}\r\n            onChangeIndex={handleChangeIndex}\r\n          >\r\n            <TabFrame value={value} index={0}>\r\n                <Attendee\r\n                      setNewStudent={setNewStudent}\r\n                      dir={theme.direction}\r\n                      newStudent={newStudent}\r\n                      title={t(\"attendee\")}\r\n                      currentStudent={student}\r\n                      addStudentId={addStudentId}\r\n                      patchService={StudentsDataService}\r\n                      updateCurrentStudent={setStudent}\r\n                      deleteStudent={deleteStudent}\r\n                      addNewGuardian={() => {\r\n                        setNewGuardian(true);\r\n                        setValue(4+guardians.length);\r\n                      }}/>\r\n            </TabFrame>\r\n\r\n              {hasNeeds([NEEDS.schedules]) && <TabFrame value={value} index={1}>\r\n              <Scheduler\r\n                    allowDelete={(s) => !s.is_base}\r\n                    allowView={true}\r\n                    viewUrl={(s) => ['/courses', s.course_id]}\r\n                    setScheduleIds={(ids) => setStudent({...student, schedules: ids})}\r\n                    onEventChange={(info, day_week, start_time, end_time, schedule) => {\r\n                       const newEvent = info.event;\r\n                       let body = {};\r\n                        body['day_week'] = day_week;\r\n                        body['start_time'] = start_time;\r\n                        body['end_time'] = end_time;\r\n\r\n                        if (schedule[\"is_base\"]) {\r\n                            body['course_id'] = schedule[\"course_id\"];\r\n                            body['student_id'] = currentStudentId;\r\n                            SchedulesDataService\r\n                                    .post(body)\r\n                                    .then(...errorHandler({errorOut: true, snackbarSuccess: true}))\r\n                                    .then(function (res) {\r\n                                        let calendarApi = info.view.calendar;\r\n                                        newEvent['is_base'] = false;  // todo needed?\r\n                                        calendarApi.addEvent(eventFromSchedule(theme, res));\r\n                                        info.revert();\r\n                                        setStudent({...student, schedules: [...student.schedules, res.id]})\r\n                                    }).catch(function(err){\r\n                                        info.revert();\r\n                            });\r\n\r\n                        } else {\r\n                            SchedulesDataService\r\n                                    .patch({id: schedule['id'],\r\n                                                                body: body,\r\n                                                                initial_values: schedule})\r\n                                    .then(...errorHandler({errorOut: true, snackbarSuccess: true}))\r\n                                    .then(function (res) {\r\n                                    }).catch(function (err){\r\n                                        info.revert();\r\n                                    });\r\n                        }\r\n                    }}\r\n                    scheduleIds={student === null ? null : student['schedules']}\r\n                    editable={true}\r\n                    selectable={false}\r\n                />\r\n\r\n              </TabFrame>}\r\n              {hasNeeds([NEEDS.payments]) && <TabFrame value={value} index={2}>\r\n                  <Payments\r\n                         paymentIds={student === null ? null : student.payments}\r\n                         addPaymentId={(payment_id) => {\r\n                             setStudent({...student, payments: [...student.payments, payment_id]})\r\n                         }}\r\n                         student_id={currentStudentId}\r\n                         deletePaymentFromStudent={(payment_id) => {\r\n                             setStudent({\r\n                                 ...student,\r\n                                 payments: student.payments.filter((p) => p !== payment_id)\r\n                             });\r\n                         }}\r\n              /></TabFrame>}\r\n\r\n              {hasNeeds([NEEDS.courses]) &&\r\n\r\n             <TabFrame value={value} index={3}> <AddDeleteSubresource\r\n                  defaultSearchBy=\"name\"\r\n                  parentItemDataService={StudentsCourseDataService}\r\n                  itemDataService={CoursesDataService}\r\n                  add_message_confirm=\"confirm_enroll_to_course\"\r\n                  parent_id={currentStudentId}\r\n                  secondaryDisplayNameField=\"description\"\r\n                  searchByOptions={[\"name\"]}\r\n                  resourceName={\"courses\"}\r\n                  displayNameField={\"name\"}\r\n                  add_message=\"enroll_to_course\"\r\n                  onSubresourceAdded={(id) => {\r\n                    setStudent({...student, courses: [...student[\"courses\"], id]})\r\n                  }}\r\n                  onSubresourceDeleted={(id) => {\r\n                    setStudent({...student, courses: student[\"courses\"].filter(x => x !== id)});\r\n                  }}\r\n             /></TabFrame>\r\n              }\r\n\r\n            {\r\n              guardians && hasNeeds([NEEDS.guardians]) && guardians.map((guardian, index) => (\r\n                  <TabFrame value={value} index={index+4}>\r\n                      <Guardian\r\n                            key={guardian}\r\n                            dir={theme.direction}\r\n                            guardianId={guardian}\r\n                            deleteGuardianId={(id) => {\r\n                              setStudent({...student, guardians: student['guardians'].filter((gId) => gId !== id)});\r\n                              setValue(0);\r\n                            }}\r\n                  /></TabFrame>\r\n                  ))}\r\n\r\n                  <TabFrame value={value} index={4+guardians.length}>\r\n                      <Guardian\r\n                        dir={theme.direction}\r\n                        newGuardian={true}\r\n                        deleteNewGuardian={() => {\r\n                            setNewGuardian(false);\r\n                            setValue(0);\r\n                        }}\r\n                            studentId={currentStudentId}\r\n                        addGuardianId={(id) => {\r\n                            setNewGuardian(false);\r\n                            setStudent({...student, guardians: [...student.guardians, id]});\r\n                            setValue(4+guardians.length);\r\n                        }\r\n                        }\r\n                        deleteGuardianId={(id) => {\r\n                            setStudent({...student, guardians: student['guardians'].filter((gId) => gId !== id)});\r\n                            setValue(0);\r\n                        }}\r\n                  /></TabFrame>\r\n\r\n          </SwipeableViews>\r\n\r\n    </Paper>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport ItemsList from \"./items_list.component\";\r\n\r\n\r\nconst ItemsListMain = ({dataService, ...props}) => {\r\n    const errorHandler = useErrorHandler();\r\n    const {t} = useTranslation();\r\n\r\n\r\n    return <ItemsList\r\n        secondaryAction={true}\r\n        secondaryActionCallable={(id) => {\r\n            dataService\r\n                .downloadOneCsv(id)\r\n                .then(...errorHandler({}));\r\n        }}\r\n        secondaryActionTooltip={t(\"export\") + \" .csv\"}\r\n        secondaryActionIcon={<GetAppIcon/>}\r\n        dataService={dataService}\r\n        {...props}\r\n    />\r\n};\r\n\r\nexport default ItemsListMain;\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Student from \"./students.student.component\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {Chip, Tooltip} from \"@material-ui/core\";\r\nimport StudentsDataService from \"../_services/students.service\";\r\nimport ItemsList from \"./items_list.component\";\r\nimport ExportSearchChip from \"./ExportSearchChip.component\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport {downloadGodFile} from \"../_services/god.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\nimport ItemsListMain from \"./items_list_main.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\nexport default function Students({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [students, setStudents] = useState([]);\r\n  const [newStudent, setNewStudent] = useState(false);\r\n  const [currentStudentId, setCurrentStudentId] = useState(null);\r\n    const handleError = useErrorHandler();\r\n  const query = new URLSearchParams(window.location.search);\r\n  const id = query.get('id');\r\n  const [hasNeeds, NEEDS] = useNeeds();\r\n  useEffect(() => {\r\n      if (id !== null && id !== undefined) setCurrentStudentId(id);\r\n  }, [id]);\r\n  const loadingCtx = React.useContext(loadingContext);\r\n\r\n\r\n  useEffect(() => {\r\n      if (currentStudentId !== null) setNewStudent(false);\r\n  }, [currentStudentId])\r\n\r\n  return (\r\n      <Grid container spacing={3} className={classes.root}>\r\n        <Grid item xs={4} className={classes.left}>\r\n          <h1>{t(\"students\")}</h1>\r\n            <ItemsListMain\r\n                setCurrentItemId={setCurrentStudentId}\r\n                currentItemId={currentStudentId}\r\n                items={students}\r\n                setItems={setStudents}\r\n                chips={[\r\n                    <Tooltip title={t(\"export_contact_sheets\")}\r\n                           aria-label={t(\"export_contact_sheets\")}>\r\n                    <Chip variant=\"outlined\"\r\n                          color=\"primary\"\r\n                          disabled={loadingCtx.loading}\r\n                          size=\"small\"\r\n                          avatar={<Avatar>csv</Avatar>}\r\n                          label={t(\"export_all_plus\")}\r\n                          onClick={() => {\r\n                              if (loadingCtx.loading) return;\r\n                              loadingCtx.startLoading();\r\n                            downloadGodFile()\r\n                                .then(...handleError({}))\r\n                                .finally(() => {\r\n                                    loadingCtx.stopLoading();\r\n                                })\r\n                          }}/>\r\n                  </Tooltip>\r\n                ]}\r\n                usableFilters={[{\r\n                    name: 'enrolment_status',\r\n                    defaultValue: null,\r\n                    options: [\r\n                        {\r\n                            label: \"enrolled\",\r\n                            tooltip: \"only_enrolled\",\r\n                            name: 'enrolled'\r\n                        }, {\r\n                            label: \"pre-enrolled\",\r\n                            tooltip: \"only_preenrolled\",\r\n                            name: 'pre-enrolled'\r\n                        }, {\r\n                            label: \"early-unenrolled\",\r\n                            tooltip: \"only_earlyunenrolled\",\r\n                            name: 'early-unenrolled'\r\n                        }\r\n                    ]\r\n                },\r\n                    {\r\n                      name: 'default_payment_method',\r\n                        defaultValue: null,\r\n                        options: [\r\n                           {label: \"cash\", tooltip: \"only_cash\", name: 'cash'},\r\n                                {label: \"bank-transfer\", tooltip: \"only_banktransfer\", name: 'bank-transfer'},\r\n                                {\r\n                                    label: \"bank-direct-debit\",\r\n                                    tooltip: \"only_bankdirectdebit\",\r\n                                    name: 'bank-direct-debit'\r\n                                }\r\n                        ]\r\n                    }]}\r\n                defaultSearchBy=\"full_name\"\r\n                searchByOptions={[\"full_name\", \"id\"]}\r\n                dataService={StudentsDataService}\r\n                searchBarLabel=\"students\"\r\n            />\r\n\r\n            {hasNeeds([NEEDS.post]) && <Tooltip title={t(\"new_student\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={(e) => {\r\n                    setCurrentStudentId(null);\r\n                    setNewStudent(true);\r\n                }}>\r\n                    <AddIcon/>\r\n                </Fab>\r\n            </Tooltip>}\r\n        </Grid>\r\n\r\n        <Grid item xs={8} className={classes.left}>\r\n          <Student\r\n            currentStudentId={currentStudentId}\r\n            newStudent={newStudent}\r\n            setNewStudent={setNewStudent}\r\n            addStudentId={(id) =>{\r\n                setCurrentStudentId(id);\r\n            }}\r\n            deleteStudent={(studentId) => {\r\n                if (studentId === currentStudentId) setCurrentStudentId(null);\r\n\r\n                setStudents(students.filter((s) => s['id'] !== studentId));\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n  );\r\n}\r\n","import DirtyTextField from \"./dirtytextfield.component\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {MenuItem} from \"@material-ui/core\";\r\n\r\nexport default function RoleSelect({formik}) {\r\n    const { t } = useTranslation();\r\n\r\n    return <DirtyTextField\r\n    label={t(\"role\")}\r\n    style={{flex: 1}}\r\n    name=\"role_id\"\r\n    formik={formik}\r\n    select>\r\n    {[{name: 'administrator',\r\n       id: 'administrator'},\r\n       {name: 'administrative',\r\n       id: 'administrative'},\r\n       {name: 'layman',\r\n       id: 'layman'},\r\n       {name: 'teacher',\r\n       id: 'teacher'},\r\n       {name: 'empty',\r\n       id: 'empty'},\r\n       {name: 'no role',\r\n       id: null}].map((role) => (\r\n        <MenuItem key={role.name} value={role.id}>{t(role.name)}</MenuItem>\r\n    ))}\r\n</DirtyTextField>;\r\n}","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\nexport const invitationsService = {\r\n    inviteUser\r\n};\r\n\r\nfunction inviteUser(userEmail, role) {\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/user-invites/v1/request`,  // todo server url\r\n            method: 'POST',\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()},\r\n            data: {\r\n                user_email: userEmail,\r\n                role_id: role\r\n            }\r\n        }).then(res => {\r\n            resolve(true);\r\n        }).catch(function (res) {\r\n            reject(res);\r\n        });\r\n    });\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('users'))();\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('teachers'))();\r\n\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React, {useState} from \"react\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\r\nimport {\r\n    AppBar,\r\n    Dialog,\r\n    Slide\r\n} from \"@material-ui/core\";\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport TeachersDataService from \"../_services/teachers.service\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport ItemsListTerciary from \"./items_list_terciary.component\";\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport * as yup from 'yup';\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport UsersDataService from \"../_services/users.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport {safe_email_required} from \"../_yup/validators\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nimport RoleSelect from \"./user.role-select.component\";\r\n\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n  });\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    },\r\n    list: {\r\n        overflow: \"auto\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        flex: 1\r\n    },\r\n    box: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n    pagination: {\r\n        margin: '30px'\r\n    },\r\n    appBar: {\r\n    position: 'relative',\r\n  },\r\n  newLine: {\r\n    width: '100%',\r\n       marginTop: theme.spacing(1),\r\n        display: \"flex\",\r\n    flexDirection: \"column\"\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  }, actionIcon: {\r\n      float: 'right'\r\n    }\r\n}));\r\n\r\n\r\n  \r\nfunction UserPerson({ children, addStudentId, newStudent, title, currentStudent, updateCurrentStudent, patchService, deleteStudent, addNewGuardian, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentStudent === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n  const [addDialogOpen, setAddDialogOpen] = useState(false);\r\n  const handleAddDialogClose = () => {\r\n        setAddDialogOpen(false);\r\n  };\r\n  const handleAddDialogOpen = () => {\r\n      setAddDialogOpen(true);\r\n  }\r\nconst confirm = React.useContext(confirmContext);\r\nconst deleteFullUser = () => {\r\n    UsersDataService\r\n              .delete(currentStudent['id'])\r\n              .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n              .then(function (res) {\r\n                    deleteStudent(currentStudent['id']);\r\n              });\r\n  }\r\n\r\n\r\n  let initialValues = loading ? {} : currentStudent;\r\n\r\n\r\n    const formik = useNormik(true, {\r\n        initialValues: initialValues,\r\n        validationSchema: yup.object({\r\n            email: safe_email_required(t),\r\n            name: yup.string().required(t(\"name_required\")),\r\n            role_id: yup.string().nullable()\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n                if (Object.keys(changedValues).length > 0) {\r\n                setStatus();\r\n\r\n                UsersDataService.patch({\r\n                    id: initialValues[\"id\"],\r\n                    body: changedValues,\r\n                    initial_values: initialValues\r\n                }).then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (patched_body) {\r\n                        formik.resetForm(patched_body);\r\n                        updateCurrentStudent(patched_body);\r\n                    }).catch(function (err) {\r\n                        setStatus(true);\r\n                    }).finally(() => {\r\n                        setSubmitting(false);\r\n                    });\r\n            } else {\r\n                setSubmitting(false);\r\n            }\r\n        }\r\n    });\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  return (\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n                <Dialog fullScreen open={addDialogOpen} onClose={handleAddDialogClose} TransitionComponent={Transition}>\r\n        <AppBar className={classes.appBar} color=\"secondary\">\r\n          <Toolbar>\r\n            <Typography variant=\"h6\" className={classes.title}>\r\n                {t(\"teacher-user\")}\r\n            </Typography>\r\n            <Button autoFocus color=\"inherit\" onClick={handleAddDialogClose}>\r\n                {t(\"cancel\")}\r\n            </Button>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <Box className={classes.box} m={3}>\r\n            <ItemsListTerciary\r\n                    dataService={TeachersDataService}\r\n                    dataServiceSR={null}\r\n                    defaultSearchBy=\"full_name\"\r\n                    searchByOptions={[\"full_name\"]}\r\n                    searchBarLabel={\"teachers\"}\r\n                    displayNameField={\"full_name\"}\r\n                    secondaryDisplayNameField={null}\r\n                    parent_id={currentStudent === null? null: currentStudent['id']}\r\n                    add_message={\"link-user-to-teacher\"}\r\n                    onAdded={(id, body) => {\r\n                        handleAddDialogClose();\r\n                        formik.setFieldValue('teacher_id', id);\r\n                        formik.setFieldTouched('teacher_id', true);\r\n                    }}\r\n                />\r\n            </Box>\r\n          </Dialog>\r\n\r\n              {loading ?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n               hasNeeds([NEEDS.delete]) && <Tooltip style={{float: 'right'}} title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                <IconButton onClick={(e) => {\r\n                 confirm.confirm(\"delete_user_question\", \"not_undone\", () => {\r\n                     deleteFullUser();\r\n                 })\r\n                }}>\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              {loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               {   [\"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0} >\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })}\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"id\")}\r\n                            name=\"id\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                        />\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name=\"name\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname1\")}\r\n                                style={{flex: 1}}\r\n                                name=\"surname1\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname2\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"surname2\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"email\")}\r\n                                type=\"email\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"email\"\r\n                                helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <RoleSelect formik={formik}/>\r\n                        </Box>\r\n\r\n                        {formik.values[\"role\"] == \"teacher\" && <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"teacher\")}\r\n                                style={{flex: 1}}\r\n                                name=\"teacher_id\"\r\n                                formik={formik}\r\n                                disabled\r\n                                InputProps={{endAdornment:\r\n                                    <InputAdornment position=\"end\">\r\n                                      <IconButton\r\n                                        aria-label=\"link teacher\"\r\n                                        onClick={handleAddDialogOpen}\r\n                                      >\r\n                                        <EditIcon></EditIcon>\r\n                                      </IconButton>\r\n                                    </InputAdornment>\r\n                                  }}/>\r\n                        </Box>}\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n\r\n            </Box>\r\n        </Box>\r\n\r\n  );\r\n}\r\n\r\nexport default UserPerson;","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('users', 'needs'))();\r\n\r\n","import React, {useEffect} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Checkbox, FormControlLabel} from \"@material-ui/core\";\r\nimport {allNeeds} from \"../_data/needs\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\n\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n  root: dirty => ({\r\n         color: dirty? theme.palette.neutral.status.dirty: theme.palette.neutral.emphasisText.medium,\r\n    \"&.Mui-checked\": {\r\n      color: dirty? theme.palette.neutral.status.dirty: theme.palette.primary.main\r\n    }\r\n\r\n})})));\r\n\r\n\r\nconst DirtyCheckbox = ({name, value, formik, noDirty=false, ...props}) => {\r\n    const dirty = noDirty === true? false: formik.values[name] !== undefined && formik.initialValues[name] !== undefined && formik.values[name].includes(value) !== formik.initialValues[name].includes(value);\r\n\r\n    const classes = useStyles(dirty);\r\n\r\n\r\n    return  <Checkbox\r\n                      name={name}\r\n                      className={classes.root}\r\n                      value={value}\r\n                    onChange={formik.handleChange}\r\n                    onBlur={formik.handleBlur}\r\n                    error={formik.status  || formik.errors[name] !== undefined}\r\n                    helperText={formik.touched[name] && formik.errors[name]}\r\n                      checked={formik.values[name]}\r\n                     {...props}/>\r\n}\r\n\r\nexport default DirtyCheckbox;","export const symmetricDifference = (setA, setB) => {\r\n    let _difference = new Set(setA)\r\n    for (let elem of setB) {\r\n        if (_difference.has(elem)) {\r\n            _difference.delete(elem)\r\n        } else {\r\n            _difference.add(elem)\r\n        }\r\n    }\r\n    return _difference\r\n}","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\"\r\nimport UsersNeedsDataService from \"../_services/user_needs.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport NeedsSelection from \"./needs_selection.component\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport {symmetricDifference} from \"../_helpers/set_operations\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nfunction UserPerson({ children, addStudentId,  newStudent, currentStudent, updateCurrentStudent, patchService, deleteStudent, addNewGuardian, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentStudent === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n\r\n  let initialValues = loading ? {} : currentStudent;\r\n\r\n\r\n    const formik = useNormik(false, {\r\n        initialValues: initialValues,\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n               setStatus();\r\n\r\n               const a = new Set(values[\"needs\"]);\r\n               const b = new Set(initialValues[\"needs\"]);\r\n               const difference = Array.from(symmetricDifference(a, b));\r\n\r\n               if (difference.size !== 0){\r\n                   setSubmitting(true);\r\n                   const jobs = difference.map(need => {\r\n                    if (b.has(need)){\r\n                       // has been removed\r\n                        return UsersNeedsDataService.delete(currentStudent['id'], need)\r\n                          .then(...errorHandler({}));\r\n                   } else {\r\n                        // has been added\r\n                        return UsersNeedsDataService.postWithId(currentStudent['id'], need)\r\n                          .then(...errorHandler({}));\r\n                    }\r\n                });\r\n                   Promise\r\n                       .all(jobs)\r\n                       .then(...errorHandler({snackbarSuccess: true}))\r\n                       .then(() => {\r\n                           updateCurrentStudent({...currentStudent, needs: values[\"needs\"]});\r\n                       })\r\n                       .finally(() => {\r\n                           setSubmitting(false);\r\n                       })\r\n               }\r\n\r\n\r\n\r\n\r\n        }\r\n    }, true);\r\n\r\n  return (\r\n\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n              {loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               <Box py={0} >\r\n                                        <Skeleton variant=\"text\" width={\"100%\"} height=\"150px\"/>\r\n                                    </Box>\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n                                    <Box style={{display: \"inline-block\"}}>\r\n                        <NeedsSelection\r\n                formik={formik}\r\n            /></Box>\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n\r\n            </Box>\r\n        </Box>\r\n\r\n  );\r\n}\r\n\r\nexport default UserPerson;","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport UsersDataService from \"../_services/users.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport UserPerson from \"./users.user.userperson.component\";\r\nimport UserPermissions from \"./users.user.permissions.component\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport TabFrame, {a11yProps} from \"./tab\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  contentPanel: {\r\n    //flex: 1,\r\n      position: 'relative', // todo proper scrollbar\r\n    overflow: \"auto\",\r\n    boxSizing: \"border-box\",\r\n      height: '100%', // todo proper,\r\n    display: 'flex',\r\n      flexDirection: 'column'\r\n  },\r\n    content: {\r\n      overflowX: 'hidden',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        overflowY: 'auto',\r\n        flex: 1,\r\n        height: '100%'\r\n    },\r\n    tab: {\r\n      height: '100%'\r\n    }\r\n}));\r\n\r\n\r\n\r\nexport default function User({currentUserId, deleteUser}) {\r\n  const loading = currentUserId === null;\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [user, setUser] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (loading) return setUser(null);\r\n    UsersDataService\r\n            .getOne(currentUserId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setUser(res[\"data\"]);\r\n                });\r\n  }, [currentUserId, loading])\r\n\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const { t } = useTranslation();\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n   useEffect(()=>{\r\n    setValue(0);\r\n  }, [currentUserId])\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setValue(index);\r\n  };\r\n\r\n\r\n  return (\r\n    <Paper elevation={3} square className={classes.contentPanel}>\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Tabs\r\n                  value={value}\r\n                  onChange={handleChange}\r\n                  indicatorColor=\"primary\"\r\n                  textColor=\"primary\"\r\n                  variant=\"scrollable\"\r\n                  scrollButtons=\"on\"\r\n                >\r\n                  <Tab label={t(\"user\")} {...a11yProps(0)} />\r\n                </Tabs>\r\n              </AppBar>\r\n          <SwipeableViews\r\n            axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n            index={value}\r\n            containerStyle={{height: '100%'}}\r\n            className={classes.content}\r\n            onChangeIndex={handleChangeIndex}\r\n          >\r\n            <TabFrame value={value} index={0}>\r\n            <UserPerson\r\n                      dir={theme.direction}\r\n                      currentStudent={user}\r\n                      updateCurrentStudent={setUser}\r\n                      deleteStudent={deleteUser}\r\n            /></TabFrame>\r\n\r\n          </SwipeableViews>\r\n\r\n    </Paper>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogTitle,\r\n    TextField,\r\n    Tooltip\r\n} from \"@material-ui/core\";\r\nimport RoleSelect from './user.role-select.component';\r\nimport PersonAddIcon from '@material-ui/icons/PersonAdd';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport * as yup from \"yup\";\r\nimport {useFormik} from \"formik\";\r\nimport {invitationsService} from \"../_services/userInvites.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport User from \"./users.user.component\";\r\nimport UsersDataService from \"../_services/users.service\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {safe_email_required} from \"../_yup/validators\";\r\nimport ItemsListMain from \"./items_list_main.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n    root2: {\r\n    display: 'flex',\r\n  },\r\n  line: {\r\n    width: \"100%\",\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  composite: {\r\n      display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n      gap: theme.spacing(1), width: \"100%\"\r\n  },\r\n  formControl: {\r\n      padding: theme.spacing(2),\r\n        maxHeight: '50vh',\r\n      overflow: 'auto',\r\n      minWidth: '40vw'\r\n  },\r\n  dialog: {\r\n\r\n  },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\nexport default function Users({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [users, setUsers] = useState([]);\r\n  const [currentUserId, setCurrentUserId] = useState(null);\r\n  const [open, setOpen] = React.useState(false);\r\n    const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const query = new URLSearchParams(window.location.search);\r\n  const id = query.get('id');\r\n  useEffect(() => {\r\n      if (id !== null && id !== undefined) setCurrentUserId(id);\r\n  }, [id]);\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const formik = useFormik({\r\n        initialValues: {email: '', needs: []},\r\n        validationSchema: yup.object({\r\n            email: safe_email_required(t)}),\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n            setSubmitting(true);\r\n            invitationsService\r\n                .inviteUser(values['email'], values['role_id'])\r\n                .then(...errorHandler({snackbarSuccess: true}))\r\n                .then(res => {\r\n                    handleClose();\r\n                }).catch(_ => {\r\n                    setStatus(true);\r\n                }).finally(() => {\r\n                    setSubmitting(false);\r\n            })\r\n        }\r\n    });\r\n\r\n\r\n  return (\r\n      <Grid container spacing={3} className={classes.root}>\r\n          <Dialog  open={open} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n              <DialogTitle id=\"form-dialog-title\">\r\n                  {t(\"invite_user\")}\r\n              </DialogTitle> \r\n              <form onSubmit={formik.handleSubmit}>\r\n                <DialogContent>\r\n                  <TextField\r\n                    autoFocus\r\n                    margin=\"dense\"\r\n                    id=\"email\"\r\n                    name=\"email\"\r\n                    label={t(\"email\")}\r\n                    type=\"email\"\r\n                    fullWidth\r\n                    value={formik.values['email']}\r\n                    onChange={formik.handleChange}\r\n                    onBlur={formik.handleBlur}\r\n                    error={formik.status  || formik.errors['email'] !== undefined}\r\n                    helperText={formik.touched['email'] && formik.errors['email']}\r\n                  />\r\n                  <Box my={2} className={classes.dialog}>\r\n                    <Box className={[classes.line, classes.composite]}>\r\n                      <RoleSelect formik={formik}/>\r\n                    </Box>\r\n                  </Box>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                  <Button onClick={handleClose} color=\"primary\">\r\n                      {t(\"cancel\")}\r\n                  </Button>\r\n                  <Button type=\"submit\" color=\"primary\" disabled={formik.isSubmitting}>\r\n                      {t(\"invite\")}\r\n                  </Button>\r\n                </DialogActions>\r\n              </form>\r\n          </Dialog>\r\n        <Grid item xs={4} className={classes.left}>\r\n          <h1>{t(\"users\")}</h1>\r\n          <ItemsListMain\r\n                setCurrentItemId={setCurrentUserId}\r\n                currentItemId={currentUserId}\r\n                items={users}\r\n                setItems={setUsers}\r\n                defaultSearchBy=\"full_name\"\r\n                searchByOptions={[\"full_name\", \"id\"]}\r\n                dataService={UsersDataService}\r\n                searchBarLabel=\"users\"\r\n            />\r\n            {hasNeeds([NEEDS.invite_users]) && <Tooltip title={t(\"new_user\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={handleClickOpen}>\r\n                    <PersonAddIcon/>\r\n                </Fab>\r\n            </Tooltip>}\r\n        </Grid>\r\n\r\n        <Grid item xs={8} className={classes.left}>\r\n          <User\r\n            currentUserId={currentUserId}\r\n            deleteUser={(userId) => {\r\n                if (userId === currentUserId) setCurrentUserId(null);\r\n\r\n                setUsers(users.filter((s) => s['id'] !== userId));\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport PaymentsDataService from \"../_services/payments.service\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport List from \"@material-ui/core/List\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n    root2: {\r\n    display: 'flex',\r\n  },\r\n  formControl: {\r\n      padding: theme.spacing(2),\r\n        maxHeight: '50vh',\r\n      overflow: 'auto',\r\n      minWidth: '40vw'\r\n  },\r\n    dialog: {\r\n\r\n    },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\nexport default function Payments({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n  const errorHandler = useErrorHandler();\r\n const loadingCtx = React.useContext(loadingContext);\r\n  return (\r\n      <div>\r\n          <h1>{t(\"payments\")}</h1>\r\n\r\n      <List className={classes.list}>\r\n        <ListItem button\r\n                  onClick={() => {\r\n                      if (loadingCtx.loading) return;\r\n                      loadingCtx.startLoading();\r\n                      PaymentsDataService\r\n                          .downloadCsv(null, null,'*', null)\r\n                          .then(...errorHandler({}))\r\n                          .finally(() => {\r\n                              loadingCtx.stopLoading();\r\n                          })\r\n\r\n                  }}>\r\n        <ListItemAvatar>\r\n            <Avatar className={classes.avatar}>\r\n                csv\r\n            </Avatar>\r\n        </ListItemAvatar>\r\n        <ListItemText id=\"name\" primary={t(\"export_all\")}/>\r\n\r\n    </ListItem>\r\n    <Divider/>\r\n    </List></div>\r\n  );\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('rooms'))();\r\n\r\n","import {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport {makeStyles, useTheme} from \"@material-ui/core/styles\";\r\nimport Scheduler, {eventFromSchedule} from \"./scheduler.component\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    calendar: {\r\n      margin: theme.spacing(2)\r\n    }\r\n\r\n}));\r\n\r\n\r\nfunction RoomSchedule({ scheduleIds, ...other }) {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  // todo no minHeight ? and also tabpanel component\r\n  return (\r\n    <div\r\n\r\n      {...other}\r\n        style={{height: '100%', flex: 1, minHeight: \"70vh\" }}\r\n\r\n    >\r\n       <Scheduler\r\n            scheduleIds={scheduleIds}\r\n            editable={false}\r\n            allowView={true}\r\n            viewUrl={(s) => ['/courses', s.course_id]}\r\n        />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RoomSchedule;","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport RoomsDataService from \"../_services/rooms.service\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport * as yup from 'yup';\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {safe_email_required} from \"../_yup/validators\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nfunction RoomDetails({ children, addStudentId, setNewRoom, newRoom, newStudent, title, currentStudent, updateCurrentStudent, patchService, deleteStudent, addNewGuardian, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentStudent === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n\r\nconst confirm = React.useContext(confirmContext);\r\n  const deleteFullStudent = () => {\r\n    RoomsDataService\r\n              .delete(currentStudent['id'])\r\n              .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n              .then(function (res) {\r\n                deleteStudent(currentStudent['id']);\r\n              });\r\n  }\r\n\r\n\r\n  let initialValues = loading ? {} : currentStudent;\r\n\r\n\r\n    const formik = useNormik(!newRoom, {\r\n        initialValues: initialValues,\r\n        validationSchema: yup.object({\r\n            name: yup.string().required(t(\"name_required\")),\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n            if (Object.keys(changedValues).length > 0) {\r\n                setStatus();\r\n\r\n                if (newRoom) {\r\n                    RoomsDataService.post(changedValues)\r\n                         .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (new_id) {\r\n                        updateCurrentStudent(new_id);\r\n                        setNewRoom(false);\r\n                    }).catch(function (err) {\r\n                    setStatus(true);\r\n                    }).finally(() => {\r\n                    setSubmitting(false);\r\n                });\r\n                } else {\r\n                   RoomsDataService.patch({\r\n                    id: initialValues[\"id\"],\r\n                    body: changedValues,\r\n                    initial_values: initialValues\r\n                }).then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (patched_body) {\r\n                        formik.resetForm(patched_body);\r\n                        updateCurrentStudent(patched_body);\r\n                    }).catch(function (err) {\r\n                        setStatus(true);\r\n                    }).finally(() => {\r\n                        setSubmitting(false);\r\n                    });\r\n                }\r\n\r\n\r\n\r\n\r\n            } else {\r\n                setSubmitting(false);\r\n            }\r\n        }\r\n    });const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n  return (\r\n\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n              {!newRoom && loading ?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              : hasNeeds([NEEDS.delete]) &&\r\n               <Tooltip style={{float: 'right'}} title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                <IconButton onClick={(e) => {\r\n                    if (newRoom) {\r\n                        setNewRoom(false);\r\n                    } else{\r\n                        confirm.confirm(\"delete_room_question\", \"not_undone\", () => {\r\n                            deleteFullStudent();\r\n                        })\r\n                    }\r\n\r\n                }}>\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              {!newRoom && loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               {   [\"100%\", \"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0} >\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })}\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"id\")}\r\n                            name=\"id\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                        />\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 4}}\r\n                                name=\"name\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"capacity\")}\r\n                                style={{flex: 1}}\r\n                                name=\"capacity\"\r\n                                formik={formik}\r\n                                type=\"number\"\r\n                            />\r\n                        </Box>\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n\r\n            </Box>\r\n        </Box>\r\n  );\r\n}\r\n\r\nexport default RoomDetails;","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport RoomsDataService from \"../_services/rooms.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport RoomSchedule from \"./rooms.room.schedule.component\";\r\nimport RoomDetails from \"./rooms.room.details.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport TabFrame from \"./tab\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  contentPanel: {\r\n    //flex: 1,\r\n      position: 'relative', // todo proper scrollbar\r\n    overflow: \"auto\",\r\n    boxSizing: \"border-box\",\r\n      height: '100%', // todo proper,\r\n    display: 'flex',\r\n      flexDirection: 'column'\r\n  },\r\n    content: {\r\n      overflowX: 'hidden',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        overflowY: 'auto',\r\n        flex: 1,\r\n        height: '100%'\r\n    },\r\n    tab: {\r\n      height: '100%'\r\n    }\r\n}));\r\n\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `full-width-tab-${index}`,\r\n    'aria-controls': `full-width-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\n\r\nexport default function Room({setNewRoom, currentRoomId, deleteRoom, newRoom, addRoomId}) {\r\n  const loading = currentRoomId === null;\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [room, setRoom] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (loading) return setRoom(null);\r\n    RoomsDataService\r\n            .getOne(currentRoomId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setRoom(res[\"data\"]);\r\n                });\r\n  }, [currentRoomId])\r\n\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const { t } = useTranslation();\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n   useEffect(()=>{\r\n    setValue(0);\r\n  }, [currentRoomId])\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setValue(index);\r\n  };const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n  return (\r\n    <Paper elevation={3} square className={classes.contentPanel}>\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Tabs\r\n                  value={value}\r\n                  onChange={handleChange}\r\n                  indicatorColor=\"primary\"\r\n                  textColor=\"primary\"\r\n                  variant=\"scrollable\"\r\n                  scrollButtons=\"on\"\r\n                >\r\n                  <Tab label={t(\"room\")} {...a11yProps(0)} />\r\n\r\n                    { !newRoom && hasNeeds([NEEDS.schedules]) &&\r\n                  <Tab label={t(\"schedules\")} {...a11yProps(1)} />}\r\n\r\n                </Tabs>\r\n              </AppBar>\r\n          <SwipeableViews\r\n            axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n            index={value}\r\n            containerStyle={{height: '100%'}}\r\n            className={classes.content}\r\n            onChangeIndex={handleChangeIndex}\r\n          >\r\n                  <TabFrame value={value} index={0}> <RoomDetails\r\n\r\n                                newRoom={newRoom}\r\n                                setNewRoom={setNewRoom}\r\n                      dir={theme.direction}\r\n                      currentStudent={room}\r\n                      updateCurrentStudent={setRoom}\r\n                      deleteStudent={deleteRoom}\r\n                  /></TabFrame>\r\n\r\n\r\n              {hasNeeds([NEEDS.schedules]) && <TabFrame value={value} index={1}><RoomSchedule value={value}\r\n                             index={1}\r\n                             className={classes.tab}\r\n                             dir={theme.direction}\r\n                             scheduleIds={room === null ? null : room['schedules']}\r\n                             student_id={currentRoomId}\r\n              /></TabFrame>}\r\n\r\n          </SwipeableViews>\r\n\r\n    </Paper>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Student from \"./students.student.component\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport ItemsList from \"./items_list.component\";\r\nimport RoomsDataService from \"../_services/rooms.service\";\r\nimport Room from \"./rooms.room.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport ItemsListMain from \"./items_list_main.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\nexport default function Rooms({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [rooms, setRooms] = useState([]);\r\n  const [newRoom, setNewRoom] = useState(false);\r\n  const [currentRoomId, setCurrentRoomId] = useState(null);\r\n\r\n  const query = new URLSearchParams(window.location.search);\r\n  const id = query.get('id');\r\n  useEffect(() => {\r\n      if (id !== null && id !== undefined) setCurrentRoomId(id);\r\n  }, [id])\r\n\r\n  useEffect(() => {\r\n      if (currentRoomId !== null) setNewRoom(false);\r\n  }, [currentRoomId])\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  return (\r\n      <Grid container spacing={3} className={classes.root}>\r\n        <Grid item xs={4} className={classes.left}>\r\n          <h1>{t(\"rooms\")}</h1>\r\n          <ItemsListMain\r\n            setCurrentItemId={setCurrentRoomId}\r\n            currentItemId={currentRoomId}\r\n            items={rooms}\r\n            setItems={setRooms}\r\n            defaultSearchBy=\"name\"\r\n            displayNameField=\"name\"\r\n            searchByOptions={[\"name\", \"id\"]}\r\n            dataService={RoomsDataService}\r\n            searchBarLabel=\"rooms\"\r\n          />\r\n            {hasNeeds([NEEDS.post]) && <Tooltip title={t(\"new_room\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={(e) => {\r\n                    setCurrentRoomId(null);\r\n                    setNewRoom(true);\r\n                }}>\r\n                    <AddIcon/>\r\n                </Fab>\r\n            </Tooltip>}\r\n        </Grid>\r\n\r\n        <Grid item xs={8} className={classes.left}>\r\n          <Room\r\n            currentRoomId={currentRoomId}\r\n            newRoom={newRoom}\r\n            setNewRoom={setNewRoom}\r\n            addRoomId={(id) =>{\r\n                setCurrentRoomId(id);\r\n            }}\r\n            deleteRoom={(studentId) => {\r\n                if (studentId === currentRoomId) setCurrentRoomId(null);\r\n\r\n                setRooms(rooms.filter((s) => s['id'] !== studentId));\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n  );\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('teachers', 'courses'))();\r\n\r\n","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\n\r\nexport function downloadCalendar(resource, resource_id, calendar_id) {\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/calendars/v1/${resource}/${resource_id}/${calendar_id}`,\r\n            method: 'GET',\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(response => {\r\n            let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n            if (filename === null) filename = \"calendar.ics\";\r\n\r\n            const url = window.URL.createObjectURL(new Blob([response.data]));\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', filename);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.remove();\r\n            resolve();\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport TeachersDataService from \"../_services/teachers.service\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport * as yup from 'yup';\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {safe_email_required} from \"../_yup/validators\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\r\nimport {downloadCalendar} from \"../_services/calendar.service\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nfunction TeacherDetails({ children, addStudentId, setNewRoom, newRoom, title, currentStudent, updateCurrentStudent, patchService, deleteStudent, addNewGuardian, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentStudent === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n   const deleteFullStudent = () => {\r\n    TeachersDataService\r\n              .delete(currentStudent['id'])\r\n              .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n              .then(function (res) {\r\n                deleteStudent(currentStudent['id']);\r\n              });\r\n  }\r\n\r\n\r\nconst confirm = React.useContext(confirmContext);\r\n  let initialValues = loading ? {} : currentStudent;\r\n\r\n\r\n    const formik = useNormik(!newRoom, {\r\n        initialValues: initialValues,\r\n        validationSchema: yup.object({\r\n            email: safe_email_required(t),  // todo\r\n            name: yup.string().required(t(\"name_required\")),\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n            if (Object.keys(changedValues).length > 0) {\r\n                setStatus();\r\n\r\n                if (newRoom) {\r\n                    TeachersDataService.post(changedValues)\r\n                         .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (new_id) {\r\n                        updateCurrentStudent(new_id);\r\n                        setNewRoom(false);\r\n                    }).catch(function (err) {\r\n                    setStatus(true);\r\n                    }).finally(() => {\r\n                    setSubmitting(false);\r\n                });\r\n                } else {\r\n                   TeachersDataService.patch({\r\n                    id: initialValues[\"id\"],\r\n                    body: changedValues,\r\n                    initial_values: initialValues\r\n                }).then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (patched_body) {\r\n                        formik.resetForm(patched_body);\r\n                        updateCurrentStudent(patched_body);\r\n                    }).catch(function (err) {\r\n                        setStatus(true);\r\n                    }).finally(() => {\r\n                        setSubmitting(false);\r\n                    });\r\n                }\r\n\r\n\r\n\r\n\r\n            } else {\r\n                setSubmitting(false);\r\n            }\r\n        }\r\n    });\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  return (\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n              {!newRoom && loading ?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n              hasNeeds([NEEDS.delete]) &&  <Tooltip style={{float: 'right'}} title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                <IconButton onClick={(e) => {\r\n                    if (newRoom) {\r\n                        setNewRoom(false);\r\n                    } else{\r\n                        confirm.confirm(\"delete_teacher\", \"not_undone\", () => {\r\n                            deleteFullStudent();\r\n                        })\r\n                    }\r\n\r\n                }}>\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              {!newRoom && loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               {   [\"100%\", \"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0} >\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })}\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"id\")}\r\n                            name=\"id\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                        />\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"calendar_url\")}\r\n                            name=\"calendar_url\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                            />\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name=\"name\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname1\")}\r\n                                style={{flex: 1}}\r\n                                name=\"surname1\"\r\n                                formik={formik}\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"surname2\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"surname2\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"email\")}\r\n                                type=\"email\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"email\"\r\n                                helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                            />\r\n                        </Box>\r\n\r\n                       <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"address\")}\r\n                                formik={formik}\r\n                                style={{flex: 4}}\r\n                                name=\"address\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"city\")}\r\n                                style={{flex: 2}}\r\n                                formik={formik}\r\n                                name=\"city\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"zip\")}\r\n                                formik={formik}\r\n                                type=\"number\"\r\n                                style={{flex: 1}}\r\n                                name=\"zip\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"dni\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"dni\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"phone\")}\r\n                                type=\"tel\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"phone\"\r\n                            />\r\n\r\n\r\n\r\n                        </Box>\r\n\r\n                         {!loading && !newRoom && <Box my={3}>\r\n            <Divider />\r\n            </Box>}\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                {!loading && !newRoom &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_calendar\")} aria-label={t(\"send_grant_letter\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={(e) => {\r\n                        downloadCalendar(\"teachers\", currentStudent['id'], currentStudent['calendar_id']).then(r => {});\r\n                      }}\r\n                  >\r\n                    {t(\"export_calendar\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n              </Box>\r\n\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n\r\n            </Box>\r\n        </Box>\r\n  );\r\n}\r\n\r\nexport default TeacherDetails;","import {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport {makeStyles, useTheme} from \"@material-ui/core/styles\";\r\nimport Scheduler, {eventFromSchedule} from \"./scheduler.component\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    calendar: {\r\n      margin: theme.spacing(2)\r\n    }\r\n\r\n}));\r\n\r\n\r\nfunction TeacherSchedule({  setSchedulesIds, scheduleIds, ...other }) {\r\n  const { t } = useTranslation();\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div\r\n      {...other}\r\n        style={{height: '100%', flex: 1, minHeight: \"70vh\" }}\r\n\r\n    >\r\n        <Scheduler\r\n            scheduleIds={scheduleIds}\r\n            editable={false}\r\n            allowView={true}\r\n            viewUrl={(s) => ['/courses', s.course_id]}\r\n        />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TeacherSchedule;","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport TeachersDataService from \"../_services/teachers.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport TeachersCoursesDataService from \"../_services/teachers_courses.service\";\r\nimport TeacherDetails from \"./teachers.teacher.details.component\";\r\nimport TeacherSchedule from \"./teachers.teacher.schedule.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport CoursesDataService from \"../_services/courses.service\";\r\nimport AddDeleteSubresource from \"./subresource_add_delete.component\";\r\nimport TabFrame, {a11yProps} from \"./tab\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  contentPanel: {\r\n    //flex: 1,\r\n      position: 'relative', // todo proper scrollbar\r\n    overflow: \"auto\",\r\n    boxSizing: \"border-box\",\r\n      height: '100%', // todo proper,\r\n    display: 'flex',\r\n      flexDirection: 'column'\r\n  },\r\n    content: {\r\n      overflowX: 'hidden',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        overflowY: 'auto',\r\n        flex: 1,\r\n        height: '100%'\r\n    },\r\n    tab: {\r\n      height: '100%'\r\n    }\r\n}));\r\n\r\n\r\n\r\nexport default function Teacher({currentTeacherId, setNewTeacher, addTeacherId, newTeacher, deleteTeacher}) {\r\n  const loading = currentTeacherId === null;\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [teacher, setTeacher] = useState(null);  // todo rename to student\r\n\r\n  useEffect(() => {\r\n    if (loading) return setTeacher(null);\r\n    TeachersDataService\r\n            .getOne(currentTeacherId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setTeacher(res[\"data\"]);\r\n                });\r\n  }, [currentTeacherId])\r\n\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const { t } = useTranslation();\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n   useEffect(()=>{\r\n    setValue(0);\r\n  }, [currentTeacherId])\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setValue(index);\r\n  };const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n  return (\r\n    <Paper elevation={3} square className={classes.contentPanel}>\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Tabs\r\n                  value={value}\r\n                  onChange={handleChange}\r\n                  indicatorColor=\"primary\"\r\n                  textColor=\"primary\"\r\n                  variant=\"scrollable\"\r\n                  scrollButtons=\"on\"\r\n                >\r\n                  <Tab label={t(\"teacher\")} {...a11yProps(0)} />\r\n\r\n                    { !newTeacher && hasNeeds([NEEDS.schedules]) &&\r\n                  <Tab label={t(\"schedules\")} {...a11yProps(1)} />}\r\n\r\n                   { !newTeacher && hasNeeds([NEEDS.courses]) &&\r\n                  <Tab label={t(\"courses\")} {...a11yProps(2)} />}\r\n\r\n                </Tabs>\r\n              </AppBar>\r\n          <SwipeableViews\r\n            axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n            index={value}\r\n            containerStyle={{height: '100%'}}\r\n            className={classes.content}\r\n            onChangeIndex={handleChangeIndex}\r\n          >\r\n\r\n              <TabFrame value={value} index={0}>\r\n                  <TeacherDetails\r\n                    newRoom={newTeacher}\r\n                    setNewRoom={setNewTeacher}\r\n                    dir={theme.direction}\r\n                    currentStudent={teacher}\r\n                    updateCurrentStudent={setTeacher}\r\n                    deleteStudent={deleteTeacher}\r\n              /></TabFrame>\r\n\r\n\r\n              {hasNeeds([NEEDS.schedules]) && <TabFrame value={value} index={1}>\r\n                  <TeacherSchedule\r\n                                className={classes.tab}\r\n                                dir={theme.direction}\r\n                                scheduleIds={teacher === null ? null : teacher['schedules']}\r\n                                student_id={currentTeacherId}\r\n              /></TabFrame>}\r\n\r\n              {hasNeeds([NEEDS.courses]) &&\r\n<TabFrame value={value} index={2}>\r\n              <AddDeleteSubresource\r\n                  defaultSearchBy=\"name\"\r\n                  parentItemDataService={TeachersCoursesDataService}\r\n                  itemDataService={CoursesDataService}\r\n                  add_message_confirm=\"confirm_enroll_to_course\"\r\n                  parent_id={currentTeacherId}\r\n                  secondaryDisplayNameField=\"description\"\r\n                  searchByOptions={[\"name\"]}\r\n                  resourceName={\"courses\"}\r\n                  displayNameField={\"name\"}\r\n                  value={value}\r\n                  add_message=\"enroll_to_course\"\r\n                  index={2}\r\n                  onSubresourceAdded={(id) => {\r\n                    setTeacher({\r\n                                ...teacher,\r\n                                courses: [...teacher['courses'], id]\r\n                            })\r\n                  }}\r\n                  onSubresourceDeleted={(id) => {\r\n                     setTeacher({\r\n                                ...teacher,\r\n                                courses: teacher['courses'].filter((c) => c !== id)\r\n                            });\r\n                  }}\r\n              /></TabFrame>}\r\n\r\n\r\n          </SwipeableViews>\r\n\r\n    </Paper>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport TeachersDataService from \"../_services/teachers.service\";\r\nimport ItemsList from \"./items_list.component\";\r\nimport Teacher from \"./teachers.teacher.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport ItemsListMain from \"./items_list_main.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\nexport default function Teachers({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [teachers, setTeachers] = useState([]);\r\n  const [newTeacher, setNewTeacher] = useState(false);\r\n  const [currentTeacherId, setCurrentTeacherId] = useState(null);\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  const query = new URLSearchParams(window.location.search);\r\n  const id = query.get('id');\r\n  useEffect(() => {\r\n      if (id !== null && id !== undefined) setCurrentTeacherId(id);\r\n  }, [id])\r\n\r\n  useEffect(() => {\r\n      if (currentTeacherId !== null) setNewTeacher(false);\r\n  }, [currentTeacherId])\r\n\r\n  return (\r\n      <Grid container spacing={3} className={classes.root}>\r\n        <Grid item xs={4} className={classes.left}>\r\n          <h1>{t(\"teachers\")}</h1>\r\n            <ItemsListMain\r\n                setCurrentItemId={setCurrentTeacherId}\r\n                currentItemId={currentTeacherId}\r\n                items={teachers}\r\n                setItems={setTeachers}\r\n                defaultSearchBy=\"full_name\"\r\n                searchByOptions={[\"full_name\", \"id\"]}\r\n                dataService={TeachersDataService}\r\n                searchBarLabel=\"teachers\"\r\n            />\r\n\r\n            {hasNeeds([NEEDS.post]) && <Tooltip title={t(\"new_teacher\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={(e) => {\r\n                    setCurrentTeacherId(null);\r\n                    setNewTeacher(true);\r\n                }}>\r\n                    <AddIcon/>\r\n                </Fab>\r\n            </Tooltip>}\r\n        </Grid>\r\n\r\n        <Grid item xs={8} className={classes.left}>\r\n          <Teacher\r\n            currentTeacherId={currentTeacherId}\r\n            newTeacher={newTeacher}\r\n            setNewTeacher={setNewTeacher}\r\n            addTeacherId={(id) =>{\r\n                setCurrentTeacherId(id);\r\n            }}\r\n            deleteTeacher={(studentId) => {\r\n                if (studentId === currentTeacherId) setCurrentTeacherId(null);\r\n\r\n                setTeachers(teachers.filter((s) => s['id'] !== studentId));\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n  );\r\n}\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('courses', 'rooms'))();\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('courses', 'students'))();\r\n\r\n","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('courses', 'teachers'))();\r\n\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport CoursesDataService from \"../_services/courses.service\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport * as yup from 'yup';\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {DialogContent, MenuItem, TextField} from \"@material-ui/core\";\r\nimport SendIcon from \"@material-ui/icons/Send\";\r\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\r\nimport StudentsDataService from \"../_services/students.service\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport {useFormik} from \"formik\";\r\nimport {DEFAULT_COURSE_PRICE_TERM} from \"../_data/price_term\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport {downloadCalendar} from \"../_services/calendar.service\";\r\nimport AssignmentTurnedInIcon from '@material-ui/icons/AssignmentTurnedIn';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n    textField: {\r\n    marginRight: theme.spacing(1),\r\n    width: 200,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    },\r\n    choose: {\r\n      marginBottom: theme.spacing(3)\r\n    }\r\n}));\r\n\r\nfunction CourseDetails({ children, addCourseId, setNewCourse, newCourse, currentCourse, updateCurrentCourse, patchService, deleteCourse, ...other }) {\r\n  const { t } = useTranslation();\r\n  let history = useHistory();\r\n  const loading = currentCourse === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n  const deleteFullCourse = (id_) => {\r\n    CoursesDataService\r\n              .delete(id_)\r\n              .then(...errorHandler({snackbarSuccess: true}))  // todo everywhere\r\n              .then(function (res) {\r\n                deleteCourse(id_);\r\n              });\r\n  }\r\n\r\n  const [openDownloadAttendanceList, setOpenDownloadAttendanceList] = React.useState(false);\r\n\r\nconst confirm = React.useContext(confirmContext);\r\n\r\n  let initialValues = loading ? {} : currentCourse;\r\n  if (newCourse) {\r\n      initialValues = {\r\n          price_term: DEFAULT_COURSE_PRICE_TERM,\r\n          is_published: false\r\n      }\r\n  }\r\n\r\n    const formik2 = useFormik({\r\n        initialValues: {},\r\n        validationSchema: yup.object({\r\n            startDate: yup.date().required(t(\"required\")),\r\n             endDate: yup.date().required(t(\"required\")),\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n\r\n\r\n            setSubmitting(true);\r\n            setStatus();\r\n\r\n             CoursesDataService\r\n                    .downloadSubresource(currentCourse[\"id\"], 'attendance-list/v1', values)\r\n                    .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(() => {\r\n                        setOpenDownloadAttendanceList(false);\r\n                    })\r\n                 .catch(() => {\r\n                     setStatus(true);\r\n                 })\r\n                 .finally(() => {\r\n                     setSubmitting(false);\r\n                 })\r\n\r\n\r\n        }\r\n    });\r\n\r\n    const downloadAttendances = () => {\r\n      CoursesDataService\r\n          .downloadSubresource(currentCourse[\"id\"], 'attendance-list/v2')\r\n          .then(...errorHandler({snackbarSuccess: true}));\r\n    }\r\n\r\n    const formik = useNormik(!newCourse, {\r\n        initialValues: initialValues,\r\n        validationSchema: yup.object({\r\n            name: yup.string().required(t(\"name_required\")),\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (changedValues, {setStatus, setSubmitting}) => {\r\n            if (Object.keys(changedValues).length > 0) {\r\n                setStatus();\r\n\r\n                if (newCourse) {\r\n                    CoursesDataService.post(changedValues)\r\n                         .then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (new_id) {\r\n                        updateCurrentCourse(new_id);\r\n                        setNewCourse(false);\r\n                    }).catch(function (err) {\r\n                    setStatus(true);\r\n                    }).finally(() => {\r\n                    setSubmitting(false);\r\n                });\r\n                } else {\r\n                   CoursesDataService.patch({\r\n                    id: initialValues[\"id\"],\r\n                    body: changedValues,\r\n                    initial_values: initialValues\r\n                }).then(...errorHandler({snackbarSuccess: true}))\r\n                    .then(function (patched_body) {\r\n                        formik.resetForm(patched_body);\r\n                        updateCurrentCourse(patched_body);\r\n                    }).catch(function (err) {\r\n                        setStatus(true);\r\n                    }).finally(() => {\r\n                        setSubmitting(false);\r\n                    });\r\n                }\r\n\r\n\r\n\r\n\r\n            } else {\r\n                setSubmitting(false);\r\n            }\r\n        }\r\n    });\r\n     const loadingCtx = React.useContext(loadingContext);\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  return (\r\n    <div\r\n      {...other}\r\n    >\r\n\r\n\r\n         <Dialog\r\n        open={openDownloadAttendanceList}\r\n        onClose={(e) => {setOpenDownloadAttendanceList(false)}}\r\n        aria-labelledby=\"alert-dialog-title\"\r\n        aria-describedby=\"alert-dialog-description\"\r\n      ><form onSubmit={formik2.handleSubmit}>\r\n        <DialogTitle id=\"alert-dialog-title\">{t(\"download\")}</DialogTitle>\r\n            <DialogContent>\r\n                <Typography className={classes.choose}>{t(\"chose_list_dates\")}</Typography>\r\n\r\n                <TextField\r\n                    id=\"date\"\r\n                    label={t(\"start\")}\r\n                    type=\"date\"\r\n                    value={formik2.values[\"startDate\"]}\r\n                    name={\"startDate\"}\r\n                    onChange={formik2.handleChange}\r\n                    onBlur={formik2.handleBlur}\r\n                    error={formik2.status  || formik2.errors[\"startDate\"] !== undefined}\r\n                    helperText={formik2.touched[\"startDate\"] && formik2.errors[\"startDate\"]}\r\n                    className={classes.textField}\r\n                    InputLabelProps={{\r\n                      shrink: true,\r\n                    }}\r\n                  />\r\n                  <TextField\r\n                    id=\"date\"\r\n                    label={t(\"end\")}\r\n                    type=\"date\"\r\n                    value={formik2.values[\"endDate\"]}\r\n                    name={\"endDate\"}\r\n                    onChange={formik2.handleChange}\r\n                    error={formik2.status  || formik2.errors[\"endDate\"] !== undefined}\r\n                    helperText={formik2.touched[\"endDate\"] && formik2.errors[\"endDate\"]}\r\n                    onBlur={formik2.handleBlur}\r\n                    className={classes.textField}\r\n                    InputLabelProps={{\r\n                      shrink: true,\r\n                    }}\r\n                  />\r\n            </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={(e) => {\r\n            setOpenDownloadAttendanceList(false);\r\n          }} color=\"primary\">\r\n            {t(\"cancel\")}\r\n          </Button>\r\n          <Button type=\"submit\" color=\"primary\"   disabled={formik2.isSubmitting} autoFocus>\r\n            {t(\"download\")}\r\n          </Button>\r\n        </DialogActions></form>\r\n      </Dialog>\r\n\r\n\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n              {!newCourse && loading ?\r\n                  <IconButtonSkeleton className={classes.actionIcon}/>\r\n              :\r\n               hasNeeds([NEEDS.delete]) && <Tooltip style={{float: 'right'}} title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n                <IconButton onClick={(e) => {\r\n                    if (newCourse) {\r\n                        setNewCourse(false);\r\n                    } else{\r\n                        confirm.confirm(\"delete_course_question\", \"not_undone\", () => {\r\n                            deleteFullCourse(currentCourse['id']);\r\n                        })\r\n                    }\r\n\r\n                }}>\r\n                  <DeleteIcon />\r\n                </IconButton>\r\n              </Tooltip>\r\n              }\r\n\r\n              {!newCourse && loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               {   [\"100%\", \"100%\", \"100%\", \"100%\"].map((value, idx) => {\r\n                                return (\r\n                                    <Box key={idx} py={0} >\r\n                                        <Skeleton variant=\"text\" width={value} height=\"60px\"/>\r\n                                    </Box>);\r\n                            })}\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"id\")}\r\n                            name=\"id\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                        />\r\n\r\n\r\n                        <DirtyTextField\r\n                            label={t(\"calendar_url\")}\r\n                            name=\"calendar_url\"\r\n                            disabled\r\n                            className={classes.line}\r\n                            formik={formik}\r\n                            />\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name=\"name\"\r\n                                formik={formik}\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                           <DirtyTextField\r\n                                label={t(\"description\")}\r\n                                style={{flex: 1}}\r\n                                multiline\r\n                                rowsMax={8}\r\n                                name=\"description\"\r\n                                formik={formik}\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"price_term\")}\r\n                                style={{flex: 1}}\r\n                                name=\"price_term\"\r\n                                formik={formik}\r\n                                type=\"number\"\r\n                            />\r\n                            <DirtyTextField\r\n                                label={t(\"public\")}\r\n                                style={{flex: 1}}\r\n                                name=\"is_published\"\r\n                                formik={formik}\r\n                                select\r\n                            >\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                    </form>\r\n\r\n\r\n                )\r\n\r\n\r\n\r\n            }\r\n\r\n             {!loading && !newCourse && <Box my={3}>\r\n            <Divider />\r\n            </Box>}\r\n\r\n\r\n            <Box className={[classes.line, classes.composite]}>\r\n                {!loading && !newCourse &&\r\n                <Tooltip style={{flex: 1}} title={t(\"take attendance\")} aria-label={t(\"take_attendance\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<AssignmentTurnedInIcon/>}\r\n                      onClick={(e) => {\r\n                        history.replace(`/attendance?id=${currentCourse['id']}`)\r\n                      }}\r\n                  >\r\n                    {t(\"take attendance\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n              </Box>\r\n\r\n            <Box className={[classes.line, classes.composite]}>\r\n                {!loading && hasNeeds([NEEDS.students]) &&  !newCourse &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_attendance_list\")} aria-label={t(\"export_attendance_list\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={(e) => {\r\n                        setOpenDownloadAttendanceList(true);\r\n                      }}\r\n                  >\r\n                    {t(\"attendance_list\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n\r\n                {!loading && hasNeeds([NEEDS.students]) &&  !newCourse &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_attendance_list\")} aria-label={t(\"export_attendance_list\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={downloadAttendances}\r\n                  >\r\n                    {t(\"export_attendance_list\") + ` (${t(\"v2\")})`}\r\n                  </Button>\r\n                </Tooltip>}\r\n\r\n                \r\n              </Box>\r\n\r\n\r\n                <Box className={[classes.line, classes.composite]}>\r\n                {!loading && !newCourse &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_calendar\")} aria-label={t(\"send_grant_letter\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={(e) => {\r\n                        downloadCalendar(\"courses\", currentCourse['id'], currentCourse['calendar_id']).then(r => {});\r\n                      }}\r\n                  >\r\n                    {t(\"export_calendar\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n\r\n                {!loading && hasNeeds([NEEDS.students, NEEDS.guardians]) && !newCourse &&\r\n                <Tooltip style={{flex: 1}} title={t(\"export_students_contact_sheet\")} aria-label={t(\"export_grant_letter\")}>\r\n                  <Button\r\n                      variant=\"contained\"\r\n                      color=\"default\"\r\n                      className={classes.button}\r\n                      disabled={loadingCtx.loading}\r\n                      startIcon={<GetAppIcon/>}\r\n                      onClick={(e) => {\r\n                          loadingCtx.startLoading();\r\n                        CoursesDataService\r\n                            .downloadSubresource(currentCourse[\"id\"], 'contactsSheet')\r\n                            .then(...errorHandler({snackbarSuccess: true}))\r\n                            .finally(() => {\r\n                                loadingCtx.stopLoading();\r\n                            })\r\n                      }}\r\n                  >\r\n                    {t(\"students_contact_sheet\")}\r\n                  </Button>\r\n                </Tooltip>}\r\n              </Box>\r\n\r\n\r\n\r\n\r\n            </Box>\r\n        </Box>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CourseDetails;","export const DEFAULT_COURSE_PRICE_TERM = 60;","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('courses', 'labels'))();\r\n\r\n","import React from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {FormControlLabel} from \"@material-ui/core\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport DirtyCheckbox from \"./dirty_checkbox\";\r\nimport {education_years} from \"../_data/education\";\r\n\r\nexport default function LabelsSelection({formik, name=\"labels\", noDirty=false}) {\r\n  const { t } = useTranslation();\r\n\r\n  return <React.Fragment>\r\n      <Typography>{t(\"labels\")}</Typography>\r\n                  {education_years.map(label => (\r\n                    <FormControlLabel\r\n                        control={\r\n                            <DirtyCheckbox\r\n                            checked={formik.values[name]===undefined? false: formik.values[name].includes(label)}\r\n                            name={name}\r\n                            value={label}\r\n                            formik={formik}\r\n                            noDirty={noDirty}\r\n                            />\r\n                        }\r\n                        key={label}\r\n                        label={t(label)}\r\n                      />))}\r\n\r\n                      <FormControlLabel\r\n                        control={\r\n                            <DirtyCheckbox\r\n                            checked={formik.values[name]===undefined? false: formik.values[name].includes(\"adult\")}\r\n                            name={name}\r\n                            value=\"adult\"\r\n                            formik={formik}\r\n                            noDirty={noDirty}\r\n                            />\r\n                        }\r\n                        label={t(\"adult\")}\r\n                      />\r\n        </React.Fragment>\r\n}\r\n","import {useTranslation} from \"react-i18next\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport {IconButtonSkeleton} from \"../_skeletons/iconButton\"\r\nimport CourseLabelsDataService from \"../_services/course_labels.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport SaveButton from \"./formik_save_button\";\r\nimport DiscardButton from \"./formik_discard_button\";\r\nimport LabelsSelection from \"./labels_selection.component\";\r\nimport {symmetricDifference} from \"../_helpers/set_operations\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  actionIcon: {\r\n    float: 'right'\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\nfunction CourseLabels({  currentCourse, updateCurrentCourse, patchService, deleteCourse, ...other }) {\r\n  const { t } = useTranslation();\r\n  const loading = currentCourse === null;\r\n  const classes = useStyles();\r\n  const errorHandler = useErrorHandler();\r\n\r\n  let initialValues = loading ? {} : currentCourse;\r\n\r\n\r\n    const formik = useNormik(false, {\r\n        initialValues: initialValues,\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n               setStatus();\r\n\r\n               const a = new Set(values[\"labels\"]);\r\n               const b = new Set(initialValues[\"labels\"]);\r\n               const difference = Array.from(symmetricDifference(a, b));\r\n\r\n               if (difference.size !== 0){\r\n                   setSubmitting(true);\r\n                   const jobs = difference.map(need => {\r\n                    if (b.has(need)){\r\n                       // has been removed\r\n                        return CourseLabelsDataService.delete(currentCourse['id'], need)\r\n                          .then(...errorHandler({}));\r\n                   } else {\r\n                        // has been added\r\n                        return CourseLabelsDataService.postWithId(currentCourse['id'], need)\r\n                          .then(...errorHandler({}));\r\n                    }\r\n                });\r\n                   Promise\r\n                       .all(jobs)\r\n                       .then(...errorHandler({snackbarSuccess: true}))\r\n                       .then(() => {\r\n                           updateCurrentCourse({...currentCourse, labels: values[\"labels\"]});\r\n                       })\r\n                       .finally(() => {\r\n                           setSubmitting(false);\r\n                       })\r\n               }\r\n\r\n\r\n\r\n\r\n        }\r\n    }, true);\r\n\r\n  return (\r\n        <Box p={3}>\r\n            <Box px={2}>\r\n\r\n              {loading?\r\n                (\r\n\r\n                    <Box>\r\n                         <IconButtonSkeleton className={classes.actionIcon}/>\r\n                       <IconButtonSkeleton className={classes.actionIcon}/>\r\n\r\n\r\n                            <div style={{clear: 'both'}}>\r\n                               <Box py={0} >\r\n                                        <Skeleton variant=\"text\" width={\"100%\"} height=\"150px\"/>\r\n                                    </Box>\r\n                            </div>\r\n                    </Box>\r\n                )\r\n                :\r\n                (\r\n                    <form onSubmit={formik.handleSubmit}>\r\n\r\n                        <DiscardButton className={classes.actionIcon}\r\n                                        formik={formik}/>\r\n\r\n\r\n                        <SaveButton className={classes.actionIcon}\r\n                                    formik={formik}/>\r\n\r\n                                    <Box style={{display: \"inline-block\"}}>\r\n                        <LabelsSelection\r\n                formik={formik}\r\n            /></Box>\r\n\r\n                    </form>\r\n                )\r\n\r\n            }\r\n\r\n            </Box>\r\n        </Box>\r\n  );\r\n}\r\n\r\nexport default CourseLabels;","import {useTranslation} from \"react-i18next\";\r\nimport React from \"react\";\r\nimport SchedulesDataService from \"../_services/schedules.service\";\r\nimport {makeStyles, useTheme} from \"@material-ui/core/styles\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport Scheduler, {eventFromSchedule} from \"./scheduler.component\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n    calendar: {\r\n      margin: theme.spacing(2)\r\n    }\r\n\r\n}));\r\n\r\n\r\nfunction CourseSchedule({ title, scheduleIds, setScheduleIds, student_id, ...other }) {\r\n  const errorHandler = useErrorHandler();\r\n\r\n  return (\r\n    <div\r\n      {...other}\r\n        style={{height: '100%', flex: 1, minHeight: \"70vh\" }}\r\n\r\n    >\r\n        <Scheduler\r\n            allowDelete={(s) => true}\r\n            allowView={(s) => !s.is_base}\r\n            viewUrl={(s) => ['/students', s.student_id]}\r\n            setScheduleIds={setScheduleIds}\r\n            onEventChange={(info, day_week, start_time, end_time, schedule) => {\r\n                SchedulesDataService\r\n                    .patch({id: schedule['id'],\r\n                                                body: {day_week: day_week, start_time: start_time, end_time: end_time},\r\n                                                initial_values: schedule})\r\n                    .then(...errorHandler({errorOut: true, snackbarSuccess: true}))\r\n                    .then(function (res) {})\r\n                    .catch(function (err){ info.revert(); });\r\n            }}\r\n            viewStudent={true}\r\n            scheduleIds={scheduleIds}\r\n            editable={true}\r\n            selectable={true}\r\n            onEventSelected={(day_week, start_time, end_time) => {\r\n                    SchedulesDataService\r\n                        .post({day_week: day_week, start_time: start_time, end_time: end_time, course_id: student_id})\r\n                        .then(res => {\r\n                            setScheduleIds([...scheduleIds, res['id']])\r\n                        })\r\n            }}\r\n        />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CourseSchedule;","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SwipeableViews from 'react-swipeable-views';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport CoursesDataService from \"../_services/courses.service\";\r\nimport StudentsDataService from \"../_services/students.service\";\r\nimport TeachersDataService from \"../_services/teachers.service\";\r\nimport CourseRoomsDataService from \"../_services/course_rooms.service\";\r\nimport RoomsDataService from \"../_services/rooms.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport CourseStudentsDataService from \"../_services/course_students.service\";\r\nimport CourseTeachersDataService from \"../_services/course_teachers.service\";\r\nimport CourseDetails from \"./courses.course.details.component\";\r\nimport CourseLabels from \"./courses.course.labels.component\";\r\nimport CourseSchedule from \"./courses.course.schedule.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport AddDeleteSubresource from \"./subresource_add_delete.component\";\r\nimport TabFrame, {a11yProps} from \"./tab\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  contentPanel: {\r\n    //flex: 1,\r\n      position: 'relative', // todo proper scrollbar\r\n    overflow: \"auto\",\r\n    boxSizing: \"border-box\",\r\n      height: '100%', // todo proper,\r\n    display: 'flex',\r\n      flexDirection: 'column'\r\n  },\r\n    content: {\r\n      overflowX: 'hidden',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        overflowY: 'auto',\r\n        flex: 1,\r\n        height: '100%'\r\n    },\r\n    tab: {\r\n      height: '100%'\r\n    }\r\n}));\r\n\r\n\r\nexport default function Course({currentCourseId, setNewCourse, addCourseId, newCourse, deleteCourse}) {\r\n  const loading = currentCourseId === null;\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const [course, setCourse] = useState(null);  // todo rename to student\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  useEffect(() => {\r\n    if (loading) return setCourse(null);\r\n    CoursesDataService\r\n            .getOne(currentCourseId)\r\n            .then(...errorHandler({}))  // todo everywhere\r\n            .then(function (res) {\r\n                    setCourse(res[\"data\"]);\r\n                });\r\n  }, [currentCourseId])\r\n\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const { t } = useTranslation();\r\n  const [value, setValue] = React.useState(0);\r\n  const handleChange = (event, newValue) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n   useEffect(()=>{\r\n    setValue(0);\r\n  }, [currentCourseId])\r\n\r\n  const handleChangeIndex = (index) => {\r\n    setValue(index);\r\n  };\r\n\r\n  return (\r\n    <Paper elevation={3} square className={classes.contentPanel}>\r\n            <AppBar position=\"static\" color=\"default\">\r\n                <Tabs\r\n                  value={value}\r\n                  onChange={handleChange}\r\n                  indicatorColor=\"primary\"\r\n                  textColor=\"primary\"\r\n                  variant=\"scrollable\"\r\n                  scrollButtons=\"on\"\r\n                >\r\n                  <Tab label={t(\"course\")} {...a11yProps(0)} />\r\n                   { !newCourse &&\r\n                  <Tab label={t(\"labels\")} {...a11yProps(1)} />}\r\n\r\n                    { !newCourse && hasNeeds([NEEDS.schedules]) &&\r\n                  <Tab label={t(\"schedules\")} {...a11yProps(2)} />}\r\n\r\n                   { !newCourse && hasNeeds([NEEDS.students]) &&\r\n                  <Tab label={t(\"students\")} {...a11yProps(3)} />}\r\n\r\n                   { !newCourse && hasNeeds([NEEDS.teachers]) &&\r\n                  <Tab label={t(\"teachers\")} {...a11yProps(4)} />}\r\n\r\n                   { !newCourse && hasNeeds([NEEDS.rooms]) &&\r\n                  <Tab label={t(\"rooms\")} {...a11yProps(5)} />}\r\n\r\n                </Tabs>\r\n              </AppBar>\r\n          <SwipeableViews\r\n            axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\r\n            index={value}\r\n            containerStyle={{height: '100%'}}\r\n            className={classes.content}\r\n            onChangeIndex={handleChangeIndex}\r\n          >\r\n\r\n            <TabFrame value={value} index={0}>  <CourseDetails\r\n                    newCourse={newCourse}\r\n                    setNewCourse={setNewCourse}\r\n                    dir={theme.direction}\r\n                    currentCourse={course}\r\n                    updateCurrentCourse={setCourse}\r\n                    deleteCourse={deleteCourse}\r\n            /></TabFrame>\r\n\r\n         <TabFrame value={value} index={1}>     <CourseLabels\r\n                      dir={theme.direction}\r\n                      currentCourse={course}\r\n                      updateCurrentCourse={setCourse}\r\n                      deleteCourse={deleteCourse}\r\n         /></TabFrame>\r\n\r\n              {hasNeeds([NEEDS.schedules]) && <TabFrame value={value} index={2}>\r\n                  <CourseSchedule\r\n                        setScheduleIds={(ids) => setCourse({...course, schedules: ids})}\r\n                       className={classes.tab}\r\n                       dir={theme.direction}\r\n                       scheduleIds={course === null ? null : course.schedules}\r\n                       student_id={currentCourseId}\r\n              /></TabFrame>}\r\n\r\n              {hasNeeds([NEEDS.students]) &&\r\n\r\n            <TabFrame value={value} index={3}>  <AddDeleteSubresource\r\n                  defaultSearchBy=\"full_name\"\r\n                  parentItemDataService={CourseStudentsDataService}\r\n                  itemDataService={StudentsDataService}\r\n                  add_message_confirm=\"confirm_enroll_to_course\"\r\n                  parent_id={currentCourseId}\r\n                  searchByOptions={[\"full_name\"]}\r\n                  resourceName={\"students\"}\r\n                  displayNameField={\"full_name\"}\r\n                  auxFields={[\"enrolment_status\"]}\r\n                  displayText={(student) => student['full_name'] + (student['enrolment_status'] === 'enrolled'? ' ☑️': '')}\r\n                  add_message=\"enroll_to_course\"\r\n                  onSubresourceAdded={(id) => {\r\n                    setCourse({\r\n                                       ...course,\r\n                                       students: [...course['students'], id]\r\n                                   })\r\n                  }}\r\n                  onSubresourceDeleted={(id) => {\r\n                    setCourse({\r\n                           ...course,\r\n                           students: course['students'].filter((s) => s !== id)\r\n                       });\r\n                  }}\r\n            /></TabFrame>\r\n\r\n\r\n\r\n              }\r\n\r\n              {hasNeeds([NEEDS.teachers]) &&\r\n\r\n                 <TabFrame value={value} index={4}>  <AddDeleteSubresource\r\n                  defaultSearchBy=\"full_name\"\r\n                  parentItemDataService={CourseTeachersDataService}\r\n                  itemDataService={TeachersDataService}\r\n                  add_message_confirm=\"confirm_add_to_course\"\r\n                  parent_id={currentCourseId}\r\n                  searchByOptions={[\"full_name\"]}\r\n                  resourceName={\"teachers\"}\r\n                  displayNameField={\"full_name\"}\r\n                  add_message=\"add_teacher\"\r\n                  onSubresourceAdded={(id) => {\r\n                    setCourse({\r\n                                       ...course,\r\n                                       teachers: [...course['teachers'], id]\r\n                                   })\r\n                  }}\r\n                  onSubresourceDeleted={(id) => {\r\n                    setCourse({\r\n                           ...course,\r\n                           teachers: course['teachers'].filter((c) => c !== id)\r\n                       });\r\n                  }}\r\n                 /></TabFrame>\r\n\r\n              }\r\n\r\n               {hasNeeds([NEEDS.rooms]) &&\r\n\r\n                 <TabFrame value={value} index={5}>  <AddDeleteSubresource\r\n                  defaultSearchBy=\"name\"\r\n                  parentItemDataService={CourseRoomsDataService}\r\n                  itemDataService={RoomsDataService}\r\n                  add_message_confirm=\"confirm_link_to_room\"\r\n                  parent_id={currentCourseId}\r\n                  searchByOptions={[\"name\"]}\r\n                  resourceName={\"rooms\"}\r\n                  displayNameField={\"name\"}\r\n                  add_message=\"link_room\"\r\n                  onSubresourceAdded={(id) => {\r\n                    setCourse({\r\n                                       ...course,\r\n                                       rooms: [...course['rooms'], id]\r\n                                   })\r\n                  }}\r\n                  onSubresourceDeleted={(id) => {\r\n                    setCourse({\r\n                           ...course,\r\n                           rooms: course['rooms'].filter((c) => c !== id)\r\n                       });\r\n                  }}\r\n                 /></TabFrame>\r\n\r\n              }\r\n\r\n\r\n          </SwipeableViews>\r\n\r\n    </Paper>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport CoursesDataService from \"../_services/courses.service\";\r\nimport Course from \"./courses.course.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport ItemsListMain from \"./items_list_main.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n  left: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    height: '100%',\r\n      position: 'relative',\r\n\r\n  },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(2),\r\n    right: theme.spacing(2),\r\n  }\r\n}));\r\n\r\n\r\nexport default function Courses({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [courses, setCourses] = useState([]);\r\n  const [newCourse, setNewCourse] = useState(false);\r\n  const [currentCourseId, setCurrentCourseId] = useState(null);\r\n\r\n  const query = new URLSearchParams(window.location.search);\r\n  const id = query.get('id');\r\n  useEffect(() => {\r\n      if (id !== null && id !== undefined) setCurrentCourseId(id);\r\n  }, [id])\r\n\r\n  useEffect(() => {\r\n      if (currentCourseId !== null) setNewCourse(false);\r\n  }, [currentCourseId])\r\nconst [hasNeeds, NEEDS] = useNeeds();\r\n  return (\r\n      <Grid container spacing={3} className={classes.root}>\r\n        <Grid item xs={4} className={classes.left}>\r\n          <h1>{t(\"courses\")}</h1>\r\n            <ItemsListMain\r\n                setCurrentItemId={setCurrentCourseId}\r\n                currentItemId={currentCourseId}\r\n                items={courses}\r\n                setItems={setCourses}\r\n                usableFilters={[{\r\n                    name: 'is_published',\r\n                    defaultValue: null,\r\n                    options: [\r\n                        {\r\n                            label: \"published\",\r\n                            tooltip: \"only_published\",\r\n                            name: true\r\n                        }, {\r\n                            label: \"private\",\r\n                            tooltip: \"only_private\",\r\n                            name: false\r\n                        }\r\n                    ]\r\n                }]}\r\n                defaultSearchBy=\"name\"\r\n                searchByOptions={[\"name\", \"id\"]}\r\n                dataService={CoursesDataService}\r\n                searchBarLabel=\"courses\"\r\n                displayNameField=\"name\"\r\n            />\r\n\r\n\r\n            {hasNeeds([NEEDS.post]) && <Tooltip title={t(\"new_course\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={(e) => {\r\n                    setCurrentCourseId(null);\r\n                    setNewCourse(true);\r\n                }}>\r\n                    <AddIcon/>\r\n                </Fab>\r\n            </Tooltip>}\r\n        </Grid>\r\n\r\n        <Grid item xs={8} className={classes.left}>\r\n          <Course\r\n            currentCourseId={currentCourseId}\r\n            newCourse={newCourse}\r\n            setNewCourse={setNewCourse}\r\n            addCourseId={(id) =>{\r\n                setCurrentCourseId(id);\r\n            }}\r\n            deleteCourse={(studentId) => {\r\n                if (studentId === currentCourseId) setCurrentCourseId(null);\r\n\r\n                setCourses(courses.filter((s) => s['id'] !== studentId));\r\n            }}\r\n          />\r\n        </Grid>\r\n      </Grid>\r\n  );\r\n}\r\n","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\nexport const bulkEmailService = {\r\n    bulkSend\r\n};\r\n\r\nfunction bulkSend(courseIds, subject, body, emailPreference, studentEnrolmentStatus, files) {\r\n    const data = new FormData();\r\n    data.append(\"courseIds\", JSON.stringify(courseIds));\r\n    data.append(\"emailPreference\", emailPreference);\r\n    data.append(\"subject\", subject);\r\n    data.append(\"studentEnrolmentStatus\", studentEnrolmentStatus);\r\n    data.append(\"body\", body);\r\n    files.forEach(f => {\r\n        data.append(f.name, f);\r\n    })\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/emails/v1/bulk`,  // todo server url\r\n            method: 'POST',\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()},\r\n            data: data\r\n        }).then(res => {\r\n            resolve(true);\r\n        }).catch(function (res) {\r\n            reject(res);\r\n        });\r\n    });\r\n}\r\n","import {makeStyles} from \"@material-ui/core/styles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport React, {useEffect} from \"react\";\r\nimport {Autocomplete} from \"@material-ui/lab\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\n\r\n// ISO 3166-1 alpha-2\r\n// ⚠️ No support for IE 11\r\nfunction countryToFlag(isoCode) {\r\n  return typeof String.fromCodePoint !== 'undefined'\r\n    ? isoCode\r\n        .toUpperCase()\r\n        .replace(/./g, (char) => String.fromCodePoint(char.charCodeAt(0) + 127397))\r\n    : isoCode;\r\n}\r\n\r\n\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n  textField: {\r\n    '& label.Mui-focused':  {color: theme.palette.primary.main},  // todo color to theme\r\n    '& .MuiInput-underline:after': {borderBottomColor: theme.palette.primary.main},\r\n      '& label':  {color:theme.palette.neutral.emphasisText.medium},\r\n      '& fieldset': {borderColor: theme.palette.neutral.emphasisText.medium},\r\n  },\r\n    option: {\r\n    fontSize: 15,\r\n    '& > span': {\r\n      marginRight: 10,\r\n      fontSize: 18,\r\n    },\r\n  },})));\r\n\r\nexport default function EmailTo({formik, name, label, options, addTo, ...textFieldProps}) {\r\n\r\n  const [option, _setOption] = React.useState(null);\r\n\r\n  React.useEffect(() => {\r\n    _setOption(null);\r\n  }, [name]);\r\n\r\n  const setOption = (option) => {\r\n      const newOption = (option !== null)? option.code: '';\r\n      formik.setFieldValue(name, newOption);\r\n      _setOption(option);\r\n      if (option) addTo(option);\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  const [inputValue, setInputValue] = React.useState('');\r\n\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Autocomplete\r\n      style={{ width: \"100%\" }}\r\n      options={options}\r\n      classes={{\r\n        option: classes.option,\r\n      }}\r\n      defaultValue={{id: 111, name: 'name'}}\r\n      autoHighlight\r\n      getOptionLabel={(option) => option.name }\r\n      getOptionSelected={(o) => o.id === option.id}\r\n      value={option}\r\n      onChange={(event, newValue) => {\r\n        setOption(newValue);\r\n      }}\r\n      inputValue={inputValue}\r\n      onInputChange={(event, newInputValue) => {\r\n        setInputValue(newInputValue);\r\n      }}\r\n      name={name}\r\n      onBlur={formik.handleBlur}\r\n      renderOption={(option) => (\r\n        <React.Fragment key={option.id}>\r\n          <span>{option.name}</span>\r\n        </React.Fragment>\r\n      )}\r\n\r\n      renderInput={(params) => (\r\n        <TextField\r\n          {...params}\r\n          label={label}\r\n          fullWidth={1}\r\n          className={classes.textField}\r\n          inputProps={{\r\n            ...params.inputProps,\r\n            autoComplete: 'new-password', // disable autocomplete and autofill\r\n          }}\r\n          error={formik.status  || formik.errors[name] !== undefined}\r\n          helperText={formik.touched[name] && formik.errors[name]}\r\n        />\r\n      )}\r\n    />\r\n  );\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {\r\n    Chip,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogTitle, MenuItem,\r\n    TextField,\r\n    Tooltip\r\n} from \"@material-ui/core\";\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport dataService from \"../_services/courses.service\";\r\nimport * as yup from \"yup\";\r\nimport {useFormik} from \"formik\";\r\nimport {bulkEmailService} from \"../_services/bulkEmail.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {safe_email_required} from \"../_yup/validators\";\r\nimport EmailTo from \"./emailTo.component\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport EuroIcon from \"@material-ui/icons/Euro\";\r\nimport AccountBalanceWalletIcon from \"@material-ui/icons/AccountBalanceWallet\";\r\nimport AccountBalanceIcon from \"@material-ui/icons/AccountBalance\";\r\nimport MoreHorizIcon from \"@material-ui/icons/MoreHoriz\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CardActions from \"@material-ui/core/CardActions\";\r\nimport PaymentsDataService from \"../_services/payments.service\";\r\nimport ReceiptIcon from \"@material-ui/icons/Receipt\";\r\nimport clsx from \"clsx\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport {Skeleton} from \"@material-ui/lab\";\r\nimport DirtyTextField from \"./dirtytextfield.component\";\r\nimport {payment_methods} from \"../_data/payment_methods\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport {loadingContext} from \"../_context/loading-context\";\r\nimport {confirmContext} from \"../_context/confirm-context\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%'\r\n  },\r\n\r\n    textBox: {\r\n      width: \"100%\",\r\n        border: \"red\"\r\n    },\r\n    chip: {\r\n      margin: theme.spacing(0.5)\r\n    },\r\n    chips: {\r\n      marginBottom: theme.spacing(1)\r\n    },\r\n    in: {\r\n      marginBottom: theme.spacing(1),\r\n        marginTop: theme.spacing(2)\r\n    },fab: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4),\r\n  }, attach: {\r\n      marginTop: theme.spacing(1),\r\n        marginBottom: theme.spacing(1)\r\n    },\r\n    card: {\r\n      marginTop: theme.spacing(1)\r\n    }\r\n}));\r\n\r\nexport default function Email({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const [groups, setGroups] = useState([]);\r\n  const [to, setTo] = useState([]);\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n\r\n    const addTo = (t) => {\r\n        setTo([...to, t]);\r\n    }\r\n    const removeTo = (id) => {\r\n        setTo(to.filter(x => x.id !== id));\r\n    }\r\n    const loadingCtx = React.useContext(loadingContext);\r\n     const confirm = React.useContext(confirmContext);\r\n    const handleSendEmail = () => {\r\n        if (loadingCtx.loading) return;\r\n        if (formik.isSubmitting) return;\r\n\r\n        confirm.confirm(\"send_bulk_email\", \"send_bulk_email_description\", () => {\r\n                  loadingCtx.startLoading();\r\n        formik.setSubmitting(true);\r\n        bulkEmailService\r\n            .bulkSend(to.map(g => g.id), formik.values[\"subject\"],\r\n                formik.values[\"body\"], formik.values[\"emailPreference\"], formik.values[\"studentEnrolmentStatus\"], selectedFiles)\r\n\r\n            .then(...errorHandler({snackbarSuccess: true}))\r\n            .finally(() => {\r\n                formik.setSubmitting(false);\r\n                loadingCtx.stopLoading();\r\n        })\r\n              });\r\n\r\n    }\r\n\r\n  const errorHandler = useErrorHandler();\r\n\r\n  const formik = useFormik({\r\n        initialValues: {emailPreference: \"resolved\", studentEnrolmentStatus: \"enrolled\"},\r\n        validationSchema: yup.object({\r\n            email: safe_email_required(t)}),\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n            setSubmitting(true);\r\n\r\n        }\r\n    });\r\n  useEffect(() => {\r\n      dataService\r\n            .getAll(null, \"*\", ['id', \"name\"])\r\n            .then(...errorHandler({}))\r\n            .then(function (res) {\r\n                setGroups(res[\"data\"]);\r\n            });\r\n  }, [])\r\n    const onFileChange = event => {\r\n      // Update the state\r\n      setSelectedFiles([...event.target.files]);\r\n    };\r\n    const getFormData = () => {\r\n        if (selectedFiles.length === 0) return null;\r\n      // Create an object of formData\r\n      const formData = new FormData();\r\n\r\n      // Update the formData object\r\n        selectedFiles.forEach(sf => {\r\n            formData.append(\r\n            sf.name,\r\n            sf,\r\n            sf.name\r\n          );\r\n        })\r\n\r\n\r\n      return formData;\r\n    };\r\n\r\n    const fileDataRepresentation = () =>  {\r\n        console.log(\"sfs\", selectedFiles);\r\n      return selectedFiles.map(selectedFile => (\r\n          <Card className={classes.card}>\r\n      <CardHeader\r\n        action={\r\n         <Tooltip title={t(\"delete\")} aria-label={t(\"delete\")}>\r\n          <IconButton onClick={(e) => {\r\n              setSelectedFiles(selectedFiles.filter(x => x !== selectedFile));\r\n          }}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n        }\r\n        titleTypographyProps={{variant: 'subheading'}}\r\n        title={selectedFile.name}\r\n      />\r\n    </Card>));\r\n    }\r\n\r\n\r\n  return (\r\n      <div>\r\n          <h1>{t(\"email\")}</h1>\r\n          <Box className={classes.chips}>\r\n              {t(\"to\")}: {\r\n                  to.length > 0? to.map(x =>\r\n                      <Tooltip title={t(\"delete\")}>\r\n                  <Chip variant=\"outlined\"\r\n              color=\"primary\"\r\n                        className={classes.chip}\r\n              size=\"small\"\r\n              avatar={<Avatar>G</Avatar>}\r\n              label={x.name}\r\n              onClick={() => {\r\n                removeTo(x.id);\r\n              }}/></Tooltip>\r\n                  ) : \" - \"\r\n              }\r\n          </Box>\r\n\r\n          <TextField\r\n              className={classes.in}\r\n            label={t(\"use_emails\")}\r\n            style={{width: \"100%\"}}\r\n              value={formik.values[\"emailPreference\"] === undefined? '': formik.values[\"emailPreference\"]}\r\n        onChange={formik.handleChange}\r\n        onBlur={formik.handleBlur}\r\n        error={formik.status  || formik.errors[\"emailPreference\"] !== undefined}\r\n        helperText={formik.touched[\"emailPreference\"] && formik.errors[\"emailPreference\"]}\r\n\r\n            name=\"emailPreference\"\r\n            select>\r\n            <MenuItem value=\"contacts\">{t(\"contacts\")}</MenuItem>\r\n            <MenuItem value=\"resolved\">{t(\"resolved\")}</MenuItem>\r\n          <MenuItem value=\"student\">{t(\"student\")}</MenuItem>\r\n          <MenuItem value=\"all\">{t(\"all\")}</MenuItem>\r\n        </TextField>\r\n\r\n        <TextField\r\n              className={classes.in}\r\n            label={t(\"status\")}\r\n            style={{width: \"100%\"}}\r\n              value={formik.values[\"studentEnrolmentStatus\"] === undefined? '': formik.values[\"studentEnrolmentStatus\"]}\r\n        onChange={formik.handleChange}\r\n        onBlur={formik.handleBlur}\r\n        error={formik.status  || formik.errors[\"studentEnrolmentStatus\"] !== undefined}\r\n        helperText={formik.touched[\"studentEnrolmentStatus\"] && formik.errors[\"studentEnrolmentStatus\"]}\r\n\r\n            name=\"studentEnrolmentStatus\"\r\n            select>\r\n            <MenuItem value=\"enrolled\">{t(\"enrolled\")}</MenuItem>\r\n            <MenuItem value=\"pre-enrolled\">{t(\"pre-enrolled\")}</MenuItem>\r\n          <MenuItem value=\"early-unenrolled\">{t(\"early-unenrolled\")}</MenuItem>\r\n          <MenuItem value={null}>{t(\"all\")}</MenuItem>\r\n        </TextField>\r\n\r\n        \r\n\r\n\r\n\r\n          <EmailTo\r\n            formik={formik}\r\n            style={{width: \"100%\"}}\r\n            options={groups.filter(g => !to.includes(g))}\r\n            addTo={addTo}\r\n            name={\"courses\"}\r\n            label={t(\"courses\")}\r\n        />\r\n        <TextField\r\n              className={classes.in}\r\n            label={t(\"subject\")}\r\n            style={{width: \"100%\"}}\r\n            value={formik.values[\"subject\"] === undefined? '': formik.values[\"subject\"]}\r\n            onChange={formik.handleChange}\r\n            onBlur={formik.handleBlur}\r\n            error={formik.status  || formik.errors[\"subject\"] !== undefined}\r\n            helperText={formik.touched[\"subject\"] && formik.errors[\"subject\"]}\r\n            name=\"subject\"\r\n            />\r\n\r\n        <TextField\r\n            className={classes.textBox}\r\n            multiline\r\n            rows={16}\r\n            value={formik.values[\"body\"] === undefined? '': formik.values[\"body\"]}\r\n            onChange={formik.handleChange}\r\n            onBlur={formik.handleBlur}\r\n            error={formik.status  || formik.errors[\"body\"] !== undefined}\r\n            helperText={formik.touched[\"body\"] && formik.errors[\"body\"]}\r\n            name={\"body\"}\r\n          />\r\n          <div>\r\n          {fileDataRepresentation()}\r\n          <input\r\n              style={{ display: \"none\" }}\r\n              id=\"contained-button-file\"\r\n              type=\"file\"\r\n              multiple\r\n              onChange={onFileChange}\r\n          />\r\n          <label htmlFor=\"contained-button-file\">\r\n            <Button className={classes.attach} variant=\"contained\" color=\"primary\" component=\"span\">\r\n                {t(\"upload\")}\r\n            </Button>\r\n          </label>\r\n          </div>\r\n          <Tooltip title={t(\"send_email\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={handleSendEmail} disabled={formik.isSubmitting || to.length === 0}>\r\n                    <SendIcon/>\r\n                </Fab>\r\n            </Tooltip>\r\n      </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport PersonIcon from \"@material-ui/icons/Person\";\r\nimport ClassIcon from \"@material-ui/icons/Class\";\r\nimport RoomIcon from \"@material-ui/icons/Room\";\r\nimport SchoolIcon from \"@material-ui/icons/School\";\r\nimport AccountBalanceIcon from \"@material-ui/icons/AccountBalance\";\r\nimport EmailIcon from '@material-ui/icons/Email';\r\nimport ContactMailIcon from \"@material-ui/icons/ContactMail\";\r\nimport AssignmentTurnedInIcon from '@material-ui/icons/AssignmentTurnedIn';\r\nimport Students from \"../_components/students.component\";\r\nimport Users from \"../_components/users.component\";\r\nimport Payments from \"../_components/payments.component\";\r\nimport Rooms from \"../_components/rooms.component\";\r\nimport Teachers from \"../_components/teachers.component\";\r\nimport Courses from \"../_components/courses.component\";\r\nimport {NEEDS} from \"../_helpers/needs\";\r\nimport Email from \"../_components/email.component\";\r\n\r\nconst Routes = [\r\n  {\r\n    path: 'students',\r\n    component: Students,\r\n    title: 'students',\r\n    icon: PersonIcon,\r\n    needs: [NEEDS.students, NEEDS.get]\r\n  },\r\n  {\r\n    path: 'courses',\r\n    component: Courses,\r\n    title: 'courses',\r\n    icon: ClassIcon,\r\n    needs: [NEEDS.courses, NEEDS.get]\r\n  },\r\n  {\r\n    path: 'teachers',\r\n    component: Teachers,\r\n    title: 'teachers',\r\n    icon: SchoolIcon,\r\n    needs: [NEEDS.teachers, NEEDS.get]\r\n  },\r\n  {\r\n    path: 'rooms',\r\n    component: Rooms,\r\n    title: 'rooms',\r\n    icon:  RoomIcon,\r\n    needs: [NEEDS.rooms, NEEDS.get]\r\n  },{\r\n    path: 'payments',\r\n    component: Payments,\r\n    title: 'payments',\r\n    icon: AccountBalanceIcon,\r\n    needs: [NEEDS.payments, NEEDS.get]\r\n  },{\r\n    path: 'users',\r\n    component: Users,\r\n    title: 'users',\r\n    icon: ContactMailIcon,\r\n    needs: [NEEDS.users, NEEDS.get]\r\n  },{\r\n    path: 'email',\r\n    component: Email,\r\n    title: 'email',\r\n    icon: EmailIcon,\r\n    needs: [NEEDS.send_email, NEEDS.get]\r\n  }\r\n];\r\n\r\n\r\nexport default Routes;","import {API_VERSION, BACKEND_URL} from \"../config\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport axios from \"axios\";\r\n\r\nexport const downloadGodFile = () => {\r\n    return new Promise(function (resolve, reject) {\r\n    axios({\r\n        url: `${BACKEND_URL}/api/${API_VERSION}/files/god`,\r\n        method: 'POST',\r\n        responseType: 'blob', // important\r\n        headers: {\r\n            ...{\r\n                'Accept': 'text/csv',\r\n                'Cache-Control': 'no-cache'\r\n            }, ...authHeader()\r\n        }\r\n    }).then(response => {\r\n        let filename = response.headers[\"content-disposition\"].split(\"filename=\")[1];\r\n        if (filename === null) filename = \"export.zip\";\r\n\r\n        const url = window.URL.createObjectURL(new Blob([response.data]));\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.setAttribute('download', filename);\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        link.remove();\r\n        resolve();\r\n    }).catch(function (err) {\r\n        reject(err);\r\n    });\r\n    });\r\n}","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\nexport const authenticationService = {\r\n    login,\r\n    logout,\r\n    ping\r\n};\r\n\r\nfunction login(username, password) {\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/auth/v1/login`,\r\n            method: 'POST',\r\n            auth: {\r\n                username: username,\r\n                password: password\r\n            },\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(res => {\r\n            resolve(res[\"data\"]);\r\n        }).catch(function (res) {\r\n            try { if (res[\"response\"][\"status\"] === 401) resolve(false) } catch(err){}\r\n            reject(res);\r\n        });\r\n    });\r\n}\r\n\r\nfunction logout() {\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/auth/v1/logout`,\r\n            method: 'GET',\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(response => {\r\n            resolve(false);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });});\r\n}\r\n\r\nfunction ping() {\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/auth/v1/ping`,\r\n            method: 'GET',\r\n            headers: {'Cache-Control': 'no-cache'}\r\n        }).then(res => {\r\n            resolve({isLoggedIn: true, needs: res.data[\"needs\"]});\r\n        }).catch(function (res) {\r\n            try { if (res[\"response\"][\"status\"] === 401) resolve({isLoggedIn: false, needs: null}) } catch(err){}\r\n\r\n            reject(res);\r\n        });});\r\n}","import i18n from 'i18next';\r\nimport {initReactI18next} from 'react-i18next';\r\nimport Backend from 'i18next-xhr-backend';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\nimport translationEN from \"./_translations/locales/eng/translation.json\";\r\nimport translationCAT from \"./_translations/locales/cat/translation.json\";\r\n\r\nexport const fallbackLng = [\"cat\"];\r\nconst availableLanguages = [\"eng\", \"cat\"];\r\n\r\nconst resources = {\r\n    eng: {\r\n        translation: translationEN\r\n    },\r\n    cat: {\r\n        translation: translationCAT\r\n    }\r\n};\r\n\r\ni18n\r\n    .use(Backend) // load _translations using http (default                                               public/assets/locals/en/_translations)\r\n    .use(LanguageDetector) // detect user language\r\n    .use(initReactI18next) // pass the i18n instance to react-i18next.\r\n    .init({\r\n        resources,\r\n        fallbackLng, // fallback language is english.\r\n\r\n        detection: {\r\n            checkWhitelist: true, // options for language detection\r\n        },\r\n\r\n        debug: false,\r\n\r\n        whitelist: availableLanguages,\r\n\r\n        interpolation: {\r\n            escapeValue: false, // no need for react.  it escapes by default\r\n        },\r\n    }).then(_ => ({}));\r\n\r\nexport default i18n;","/**\r\n * returns the selected language, defaults to fallbackLng if none is selected\r\n *\r\n * @returns string, the selected language\r\n */\r\nimport {fallbackLng} from \"../i18nextConf\";\r\n\r\nexport const getCurrentLanguage = () => {\r\n    return localStorage.getItem(\"i18nextLng\") || fallbackLng;\r\n}\r\n","import Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Brightness4Icon from \"@material-ui/icons/Brightness4\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport TranslateIcon from \"@material-ui/icons/Translate\";\r\nimport i18next from \"i18next\";\r\nimport {getCurrentLanguage} from \"../_translations/utils\";\r\n\r\n\r\n\r\nexport default function TranslateButton({...props}){\r\n    const {t} = useTranslation();\r\n    const selectedLanguage = getCurrentLanguage();\r\n\r\n    return  <Tooltip title={selectedLanguage === \"cat\"? t(\"use_eng\"): t(\"use_cat\")} style={{float: 'right'}} {...props}>\r\n                <IconButton\r\n                    color=\"inherit\"\r\n                    onClick={() => {\r\n\r\n                        i18next.changeLanguage(getCurrentLanguage() === \"eng\"? \"cat\": \"eng\").then();\r\n                    }}\r\n                    aria-label={selectedLanguage === \"cat\"? t(\"use_eng\"): t(\"use_cat\")}>\r\n                    <TranslateIcon/>\r\n                </IconButton>\r\n\r\n            </Tooltip>;\r\n}","import Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Brightness4Icon from \"@material-ui/icons/Brightness4\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nexport default function ThemeButton({...props}){\r\n    const themeCtx = React.useContext(themeContext);\r\n    const {t} = useTranslation();\r\n\r\n    return  <Tooltip title={themeCtx.theme? t(\"use_light\"): t(\"use_dark\")}\r\n                     style={{float: 'right'}} {...props}>\r\n                <IconButton\r\n                    color=\"inherit\"\r\n                    aria-label={themeCtx.theme? t(\"use_light\"): t(\"use_dark\")}\r\n                    onClick={themeCtx.switchTheme}>\r\n                    <Brightness4Icon/>\r\n                </IconButton>\r\n            </Tooltip>;\r\n}","import Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport FolderSharedIcon from \"@material-ui/icons/FolderShared\";\r\nimport React from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nexport default function TeacherDashboardButton({...props}){\r\n    const {t} = useTranslation();\r\n    let history = useHistory();\r\n\r\n    return  <Tooltip title={t(\"teacher_dashboard\")} style={{float: 'right'}} {...props}>\r\n    <IconButton\r\n        color=\"inherit\"\r\n        onClick={() => history.replace(\"/teacher-dashboard\")}\r\n        aria-label={t(\"teacher_dashboard\")}\r\n        aria-haspopup=\"false\">\r\n        <FolderSharedIcon/>\r\n    </IconButton>\r\n</Tooltip>\r\n;\r\n}","import IconButton from \"@material-ui/core/IconButton\";\r\nimport clsx from \"clsx\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport AccountCircleIcon from \"@material-ui/icons/AccountCircle\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport React, {useContext} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport i18next from \"i18next\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\nimport {userContext} from \"../_context/user-context\";\r\nimport {authenticationService} from \"../_services/auth.service\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport TranslateButton from \"./translate_button.component\";\r\nimport ThemeButton from \"./theme_button.component\";\r\nimport {DOCS_URL} from \"../config\";\r\nimport DescriptionIcon from '@material-ui/icons/Description';\r\nimport SchoolIcon from '@material-ui/icons/School';\r\nimport { withRouter } from \"react-router\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport FolderSharedIcon from '@material-ui/icons/FolderShared';\r\nimport TeacherDashboardButton from \"./teacher_dashboard_button\";\r\n\r\nconst languageMap = {\r\n    eng: { label: \"english\", dir: \"ltr\", active: true },\r\n    cat: { label: \"català\", dir: \"ltr\", active: false }\r\n};\r\n\r\n\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: theme.spacing(0, 1),\r\n        // necessary for content to be below app bar\r\n        ...theme.mixins.toolbar,\r\n    },\r\n    grow: {\r\n        flexGrow: 1,\r\n    },\r\n})));\r\n\r\nexport default withRouter(function HomeToolbar(props){\r\n    let history = useHistory();\r\n    const classes = useStyles();\r\n    const errorHandler = useErrorHandler();\r\n\r\n    const selected = localStorage.getItem(\"i18nextLng\") || \"eng\";\r\n    const { t } = useTranslation();\r\n\r\n    const title = \"centrífuga4\";\r\n\r\n    const [anchorEl, setAnchorEl] = React.useState(null);\r\n    const isMenuOpen = Boolean(anchorEl);\r\n    const handleProfileMenuOpen = (event, ) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n    const handleMenuClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const [anchorElLan, setAnchorElLan] = React.useState(null);\r\n    const isLanguageMenuOpen = Boolean(anchorElLan);\r\n    const handleLanguageMenuOpen = (event) => {\r\n        setAnchorElLan(event.currentTarget);\r\n    };\r\n    const handleLanguageMenuClose = () => {\r\n        setAnchorElLan(null);\r\n    };\r\n    const changeLanguage = (language) => {\r\n        i18next.changeLanguage(language).then();\r\n        handleLanguageMenuClose();\r\n    }\r\n    React.useEffect(() => {\r\n        document.body.dir = languageMap[selected].dir;\r\n      }, [anchorElLan, selected]);\r\n\r\n    const languageMenuId = 'primary-language-select-menu';\r\n    const languageMenu = (\r\n        <Menu\r\n            anchorEl={anchorElLan}\r\n            anchorOrigin={{vertical: 'top', horizontal: 'right'}}\r\n            id={languageMenuId}\r\n            keepMounted\r\n            transformOrigin={{vertical: 'top', horizontal: 'right'}}\r\n            open={isLanguageMenuOpen}\r\n            onClose={handleLanguageMenuClose}>\r\n            {Object.keys(languageMap)?.map(key => (\r\n              <MenuItem key={key} onClick={() => changeLanguage(key)}>{languageMap[key].label}</MenuItem>\r\n            ))}\r\n        </Menu>\r\n    );\r\n\r\n    const userCtx = useContext(userContext);\r\n\r\n\r\n    const userMenuId = 'primary-search-account-menu';\r\n    const userMenu = (\r\n        <Menu\r\n            anchorEl={anchorEl}\r\n            anchorOrigin={{vertical: 'top', horizontal: 'right'}}\r\n            id={userMenuId}\r\n            keepMounted\r\n            transformOrigin={{vertical: 'top', horizontal: 'right'}}\r\n            open={isMenuOpen}\r\n            onClose={handleMenuClose}>\r\n\r\n\r\n                     <MenuItem\r\n                         onClick={(event) => {\r\n                             authenticationService\r\n                                 .logout()\r\n                                 .then(...errorHandler({}))\r\n                                 .then(() => {\r\n                                     userCtx[\"setUser\"]({logged: false, ping: false});\r\n                                 });\r\n                             handleMenuClose(event);\r\n                         }}>\r\n                         {t(\"log_out\")}\r\n                     </MenuItem>\r\n\r\n\r\n        </Menu>\r\n    );\r\n\r\n    return (\r\n    <Toolbar>\r\n        \r\n\r\n                    <IconButton\r\n                        color=\"inherit\"\r\n                        aria-label={t(\"open_drawer\")}\r\n                        onClick={props.handleDrawerOpen}\r\n                        edge=\"start\"\r\n                        className={clsx(classes.menuButton, {\r\n                            [classes.hide]: props.open,\r\n                        })}>\r\n                        <MenuIcon/>\r\n                    </IconButton>\r\n                    <Typography variant=\"h6\" noWrap>\r\n                      {title}\r\n                    </Typography>\r\n                    <div className={classes.grow}/>\r\n\r\n\r\n                    <TeacherDashboardButton/>\r\n\r\n\r\n                    <Tooltip title={t(\"docs\")}>\r\n                        <IconButton\r\n                            color=\"inherit\"\r\n                            onClick={() => window.open(DOCS_URL, \"_blank\")}\r\n                            aria-label={t(\"docs\")}\r\n                            aria-haspopup=\"false\">\r\n                            <DescriptionIcon/>\r\n                        </IconButton>\r\n                    </Tooltip>\r\n                    <TranslateButton/>\r\n                    <ThemeButton />\r\n\r\n\r\n                        <Tooltip title={t(\"my_account\")}>\r\n                        <IconButton\r\n                            color=\"inherit\"\r\n                            onClick={handleProfileMenuOpen}\r\n                            aria-label={t(\"my_account\")}\r\n                            aria-controls={userMenuId}\r\n                            aria-haspopup=\"true\">\r\n                            <AccountCircleIcon/>\r\n                        </IconButton>\r\n                    </Tooltip>\r\n\r\n\r\n        {languageMenu}\r\n        {userMenu}\r\n                </Toolbar>\r\n    )\r\n});\r\n","import {makeStyles} from \"@material-ui/core/styles\";\r\nimport createStyles from \"@material-ui/styles/createStyles\";\r\nimport React, {useEffect} from \"react\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport clsx from \"clsx\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport Routes from \"./routes\";\r\nimport {BrowserRouter, Switch, Link, Route, Redirect} from \"react-router-dom\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport HomeToolbar from \"../_components/toolbar.home.component\";\r\nimport {useNeeds} from \"../_helpers/needs\";\r\nimport {\r\n    Backdrop,\r\n    CircularProgress,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogTitle,\r\n    useMediaQuery\r\n} from \"@material-ui/core\";\r\nimport {loadingContext} from '../_context/loading-context';\r\nimport {confirmContext} from '../_context/confirm-context';\r\nimport {tabContext} from '../_context/tab-context';\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useRouteMatch, useLocation  } from \"react-router-dom\";\r\n\r\nconst drawerWidth = 240;\r\nconst useStyles = makeStyles(theme => (createStyles({\r\n    root: {\r\n        display: 'flex',\r\n        height: '100vh'\r\n    },\r\n    appBar: {\r\n        zIndex: theme.zIndex.drawer + 1,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen,\r\n        }),\r\n        background: theme.palette.neutral.main,\r\n        color: theme.palette.neutral.emphasisText.medium,\r\n    },\r\n    appBarShift: {\r\n        marginLeft: drawerWidth,\r\n        width: `calc(100% - ${drawerWidth}px)`,\r\n        transition: theme.transitions.create(['width', 'margin'], {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n    },\r\n    menuButton: {\r\n        marginRight: 36,\r\n    },\r\n    hide: {\r\n        display: 'none',\r\n    },\r\n    drawer: {\r\n        width: drawerWidth,\r\n        flexShrink: 0,\r\n        whiteSpace: 'nowrap',\r\n    },\r\n    drawerOpen: {\r\n        width: drawerWidth,\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.enteringScreen,\r\n        }),\r\n    },\r\n    drawerClose: {\r\n        transition: theme.transitions.create('width', {\r\n            easing: theme.transitions.easing.sharp,\r\n            duration: theme.transitions.duration.leavingScreen,\r\n        }),\r\n        overflowX: 'hidden',\r\n        width: theme.spacing(7) + 1,\r\n        [theme.breakpoints.up('sm')]: {\r\n            width: theme.spacing(9) + 1,\r\n        },\r\n    },backdrop: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    color: '#fff',\r\n  },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: theme.spacing(0, 1),\r\n        // necessary for content to be below app bar\r\n        ...theme.mixins.toolbar,\r\n    },\r\n    content: {\r\n        display: 'flex',\r\n        flexFlow: 'column',\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        overflow: 'auto'\r\n    },\r\n    main: {\r\n        flex: 1,\r\n        padding: theme.spacing(3),\r\n        overflow: 'auto'\r\n    },\r\n    icon: {\r\n      '&': {\r\n          color: theme.palette.neutral.emphasisText.medium,\r\n      }\r\n    },\r\n    selectedIcon: {\r\n      '&': {\r\n          color: theme.palette.primary.main,\r\n      }\r\n    },\r\n    grow: {\r\n        flexGrow: 1,\r\n    },\r\n})));\r\n\r\nconst HomePage = (props) => {\r\n    const theme = useTheme();\r\n    const classes = useStyles();\r\n\r\n    const baseRouter = props.baseRouter;\r\n\r\n    const { t } = useTranslation();\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n\r\n    let match = useRouteMatch();\r\n    const location = useLocation();\r\n    const currentRoute = location.pathname;\r\n    const [hasNeeds, NEEDS] = useNeeds();\r\n\r\n    const handleDrawerOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleDrawerClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const [loading, setLoading] = React.useState(false);\r\n      const handleClose = () => {\r\n        setLoading(false);\r\n      };\r\n\r\n      const [confirmDialog, setConfirmDialog] = React.useState({\r\n          open: false,\r\n          title: null,\r\n          subtitle: null,\r\n          success: () => {},\r\n          cancel: () => {},\r\n          args: []\r\n      });\r\n      const confirm = (title, subtitle, successCallable, cancelCallable=null, args=[]) => {\r\n          setConfirmDialog(\r\n              {\r\n                open: true,\r\n                title: title,\r\n                subtitle: subtitle,\r\n                success: successCallable,\r\n                cancel: cancelCallable === null? () => {}: cancelCallable,\r\n                  args: args\r\n              }\r\n          );\r\n      }\r\n      const handleCloseConfirm = () => {\r\n          setConfirmDialog({...confirmDialog, open: false});\r\n      }\r\n\r\n      const routerRef = React.createRef();\r\n      let history = useHistory();\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <CssBaseline/>\r\n                <loadingContext.Provider value={{loading: loading, startLoading: () => {setLoading(true)}, stopLoading: () =>{setLoading(false)}}}>\r\n                    <confirmContext.Provider value={{confirm: confirm}}>\r\n\r\n                            <AppBar\r\n                                position=\"fixed\"\r\n                                className={clsx(classes.appBar, {\r\n                                    [classes.appBarShift]: open,\r\n                                })}>\r\n                                <HomeToolbar\r\n                                    routerRef={baseRouter}\r\n                                    changeTheme={props.changeTheme}\r\n                                    handleDrawerOpen={handleDrawerOpen}\r\n                                    handleDrawerClose={handleDrawerClose}\r\n                                    open={open}\r\n                                />\r\n                            </AppBar>\r\n                            <Switch ref={routerRef}>\r\n                           \r\n                            \r\n                                <tabContext.Provider value={{currentTab: currentRoute, goTo: (res, id=null) => {\r\n                                if (id === null) {\r\n                                    history.replace(`/home/${res}`);\r\n                                } else {\r\n                                    history.replace(`/home/${res}?id=${id}`);\r\n                                }\r\n                            }}}>\r\n                                <Drawer\r\n                                    variant=\"permanent\"\r\n                                    className={clsx(classes.drawer, {\r\n                                        [classes.drawerOpen]: open,\r\n                                        [classes.drawerClose]: !open,\r\n                                    })}\r\n                                    classes={{\r\n                                        paper: clsx({\r\n                                            [classes.drawerOpen]: open,\r\n                                            [classes.drawerClose]: !open,\r\n                                        }),\r\n                                    }}\r\n                                >\r\n                                    <div className={classes.toolbar}>\r\n                                        <IconButton onClick={handleDrawerClose}>\r\n                                            {theme.direction === 'rtl' ? <ChevronRightIcon/> : <ChevronLeftIcon/>}\r\n                                        </IconButton>\r\n                                    </div>\r\n                                    <Divider/>\r\n                                    <List>\r\n                                        {Routes\r\n                                            .filter(route => hasNeeds(route.needs))\r\n                                            .map((prop) =>(\r\n                                                  <ListItem key={prop.title} to={prop.path } button component={Link}>\r\n                                                    <ListItemIcon className={`/home/${prop.path}` === currentRoute? classes.selectedIcon: classes.icon}>\r\n                                                        <Tooltip title={t(prop.title)} aria-label={t(prop.title)}>\r\n                                                            {<prop.icon/>}\r\n                                                        </Tooltip>\r\n                                                    </ListItemIcon>\r\n                                                    <ListItemText primary={t(prop.title)}/>\r\n                                                </ListItem>\r\n                                                ))}\r\n                                    </List>\r\n                                </Drawer>\r\n\r\n\r\n                                <div className={classes.content}>\r\n                                    <div className={classes.toolbar}/>\r\n                                    <main className={classes.main}>\r\n                                    <Route exact path=\"/home/\">\r\n                                        <Redirect to=\"/home/students\" />\r\n                                    </Route>\r\n                                        {Routes\r\n                                            .filter(route => hasNeeds(route.needs))\r\n                                            .map((prop) => <Route key={prop.title} path={`/home/${prop.path}`} component={prop.component}/>)\r\n                                        }\r\n                                    </main>\r\n                                </div>\r\n                                     </tabContext.Provider>\r\n                            </Switch>\r\n\r\n                    <Backdrop className={classes.backdrop} open={loading} onClick={handleClose}>\r\n                    <CircularProgress color=\"inherit\" />\r\n                  </Backdrop>\r\n\r\n                        <Dialog\r\n        open={confirmDialog.open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"responsive-dialog-title\"\r\n      >\r\n        {confirmDialog.title &&\r\n        <DialogTitle id=\"responsive-dialog-title\">\r\n            {t(confirmDialog.title)}\r\n        </DialogTitle>\r\n        }\r\n        {confirmDialog.subtitle && <DialogContent>\r\n            <DialogContentText>\r\n                {t(confirmDialog.subtitle)}\r\n            </DialogContentText>\r\n        </DialogContent>}\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n              confirmDialog.cancel(...confirmDialog.args);\r\n              handleCloseConfirm();\r\n          }} color=\"primary\">\r\n              {t(\"cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n              confirmDialog.success(...confirmDialog.args);\r\n              handleCloseConfirm();\r\n          }} color=\"primary\" autoFocus>\r\n              {t(\"continue\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n                    </confirmContext.Provider>\r\n            </loadingContext.Provider>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HomePage;","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\nexport const passwordResetService = {\r\n    reset,\r\n    startReset\r\n};\r\n\r\nfunction reset(username, password, token, recaptcha) {\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/password-reset/v1/redeem`,\r\n            method: 'POST',\r\n            data: {\r\n                email: username,\r\n                password: password,\r\n                token: token,\r\n                recaptcha: recaptcha\r\n            },\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(response => {\r\n            resolve(true);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n\r\nfunction startReset(username, recaptcha) {\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/password-reset/v1/request`,\r\n            method: 'POST',\r\n            data: {\r\n                email: username,\r\n                recaptcha: recaptcha\r\n            },\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(response => {\r\n            resolve(true);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n","import { useEffect } from \"react\";\r\n\r\nexport const useOnMount = handler => {\r\n  return useEffect(() => {\r\n    return handler();\r\n  }, []);\r\n};","import React from 'react';\r\nimport {useFormik} from 'formik';\r\nimport {authenticationService} from '../_services/auth.service';\r\nimport {userContext} from \"../_context/user-context\";\r\nimport * as yup from 'yup';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport {passwordResetService} from \"../_services/password-reset.service\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useOnMount} from \"../_helpers/on-mount\";\r\nimport {safe_username_required} from \"../_yup/validators\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\nimport {PUBLIC_URL, RECAPTCHA} from \"../config\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexGrow: 1,\r\n        height: \"100vh\"\r\n    },\r\n    field: {\r\n        width: \"100%\",\r\n        margin: \"5px\"\r\n    },\r\n    paper: {\r\n        height: \"50%\",\r\n        [theme.breakpoints.up('md')]:{minWidth: \"500px\", width: \"50%\"},\r\n        [theme.breakpoints.down('md')]:{width: \"100%\"},\r\n        margin: \"auto\",\r\n        padding: \"50px\"\r\n    },\r\n    reset: {\r\n        width: \"100%\",\r\n        textAlign: \"end\",\r\n        cursor: \"\"\r\n    }\r\n}));\r\n\r\n\r\nconst LoginPage = (props) => {\r\n    const classes = useStyles();\r\n    const userCtx = React.useContext(userContext);\r\n    const themeCtx = React.useContext(themeContext);\r\n    const mobile = useMediaQuery('(max-width:960px)');\r\n    const [recaptcha, setRecaptcha] = React.useState(null);\r\n    const [showRecaptcha, setShowRecaptcha] = React.useState(false);\r\n    function onChange(value) {\r\n      setRecaptcha(value);\r\n    }\r\n\r\n    const errorHandler = useErrorHandler();\r\n\r\n    const {enqueueSnackbar} = useSnackbar();\r\n\r\n    const logged = (needs) => {\r\n        console.log(\"needs\", needs);\r\n        const setLogged = userCtx[\"setUser\"];\r\n        const setNeeds = userCtx[\"setNeeds\"];\r\n        const setTeacher = userCtx[\"setTeacher\"];\r\n        setLogged({logged: true, ping: true});\r\n        setNeeds(needs[\"needs\"]);\r\n        setTeacher(needs[\"teacher\"]);\r\n        const {from} = props.location.state || {from: {pathname: \"/home/students\"}};\r\n        props.history.push(from);\r\n    }\r\n\r\n    const {t} = useTranslation();\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            username: '',\r\n            password: ''\r\n        },\r\n        validationSchema: yup.object({\r\n            username: safe_username_required(t),\r\n            password: yup.string().required(t(\"password_required\"))\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: ({username, password}, {setStatus, setSubmitting}) => {\r\n            setStatus();\r\n            authenticationService\r\n                .login(username, password)\r\n                .then(...errorHandler({}))\r\n                .then(function (needs) {\r\n                        logged(needs);\r\n                    })\r\n                .catch(() => {\r\n                    setStatus(true);\r\n                })\r\n                .finally(() => {\r\n                        setSubmitting(false);\r\n                });\r\n        }\r\n    });\r\n\r\n    useOnMount(() => {\r\n        if (userCtx[\"user\"][\"logged\"]) {\r\n            props.history.push('/home/students');\r\n            return null;\r\n        }\r\n\r\n        if (userCtx[\"user\"][\"ping\"] !== false){\r\n             authenticationService\r\n            .ping()\r\n            .then(...errorHandler({}))\r\n            .then((response) => {\r\n                if (response.isLoggedIn) logged(response.needs);\r\n            })\r\n\r\n        }\r\n\r\n    });\r\n\r\n    const resetPassword = () => {\r\n        setShowRecaptcha(true);\r\n    }\r\n\r\n    const resetPassword2 = () => {\r\n        const username = formik.values[\"username\"];\r\n        if (username === null || username === '' || username === undefined) {\r\n            enqueueSnackbar(t(\"username_required_password_reset\"), { variant: \"warning\"});\r\n        } else {\r\n            passwordResetService\r\n                .startReset(username, recaptcha)\r\n                .then(...errorHandler({}))\r\n                .then(r => {\r\n                    setShowRecaptcha(false);\r\n                    enqueueSnackbar(t(\"started_password_reset\"), { variant: \"success\"});\r\n                })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n\r\n            <Grid container>\r\n                {!mobile && <Grid xs={2} item/>}\r\n\r\n                <Grid xs={mobile? 12: 8} item>\r\n                    <Grid\r\n                        container\r\n                        spacing={0}\r\n                        align=\"center\"\r\n                        justify=\"center\"\r\n                        direction=\"column\"\r\n                        style={{height: \"100%\"}}\r\n                    >\r\n\r\n                        <Grid item>\r\n                            <Box m={2}>\r\n                            {mobile && <>\r\n                    <TranslateButton style={{float: 'right'}}/>\r\n                    <ThemeButton style={{float: 'right'}}/> </>\r\n                }\r\n                                <Paper className={classes.paper}>\r\n\r\n                                    <img src={`${PUBLIC_URL}/logo_centrifuga4_${themeCtx.label}.svg`} alt=\"Logo Centrífuga\" style={{height: \"85px\"}}/>\r\n\r\n                                    <form onSubmit={formik.handleSubmit}>\r\n                                        <TextField\r\n                                            label={t(\"email\")}\r\n                                            disabled={formik.isSubmitting}\r\n                                            helperText={formik.touched[\"username\"] && formik.errors[\"username\"]}\r\n                                            type=\"email\"\r\n                                            name=\"username\"\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"username\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"password\")}\r\n                                            name=\"password\"\r\n                                            type=\"password\"\r\n                                            helperText={formik.touched[\"password\"] && formik.errors[\"password\"]}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"password\"]}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <Box my={3}>\r\n                                            <Button\r\n                                                variant=\"contained\"\r\n                                                color=\"primary\"\r\n                                                type=\"submit\"\r\n                                                disabled={formik.isSubmitting}\r\n                                                className={classes.field}>\r\n                                                {t(\"log_in\")}\r\n                                            </Button>\r\n                                        </Box>\r\n                                    </form>\r\n\r\n                                     {showRecaptcha &&\r\n                                     <div><ReCAPTCHA sitekey={RECAPTCHA}\r\n                                                 onChange={onChange}\r\n                                                 theme={themeCtx.theme? \"dark\": \"light\"}\r\n\r\n                                                 className={classes.recaptcha}\r\n                                      />\r\n                                     <Box my={3}>\r\n                                            <Button\r\n                                                variant=\"contained\"\r\n                                                color=\"primary\"\r\n                                                onClick={resetPassword2}\r\n                                                disabled={recaptcha === null}\r\n                                                className={classes.field}>\r\n                                                {t(\"reset_password\")}\r\n                                            </Button>\r\n                                        </Box>\r\n                                     </div>}\r\n\r\n                                    <Box className={classes.reset}>\r\n                                        <Typography variant=\"caption\">\r\n                                            <Link\r\n                                              component=\"button\"\r\n                                              variant=\"body2\"\r\n                                              onClick={resetPassword}\r\n                                            >\r\n                                              {t(\"reset_password\")}\r\n                                            </Link>\r\n                                        </Typography>\r\n                                        </Box>\r\n                                </Paper></Box>\r\n                        </Grid>\r\n\r\n                    </Grid>\r\n                </Grid>\r\n                {!mobile && <Grid xs={2} item>\r\n                    <TranslateButton style={{float: 'right'}}/>\r\n                    <ThemeButton style={{float: 'right'}}/>\r\n                </Grid>}\r\n            </Grid></div>);\r\n\r\n}\r\n\r\nexport default LoginPage;","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {BACKEND_URL} from \"../config\";\r\n\r\nexport const authenticationService = {\r\n    signup\r\n};\r\n\r\nfunction signup(username, password, email, name, surname1, surname2, token) {\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        axios({url: `${BACKEND_URL}/user-invites/v1/redeem`,\r\n            method: 'POST',\r\n            data: {\r\n                password: password,\r\n                email: email,\r\n                name: name,\r\n                surname1: surname1,\r\n                surname2: surname2,\r\n                token: token\r\n            },\r\n            headers: {...{'Cache-Control': 'no-cache'}, ...authHeader()}\r\n        }).then(response => {\r\n            resolve(true);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n","import React from 'react';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {authenticationService as signupService} from \"../_services/signup.service\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport i18next from \"i18next\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useOnMount} from \"../_helpers/on-mount\";\r\nimport {safe_password_repetition, safe_email_required, safe_password, safe_username_required} from \"../_yup/validators\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\nimport {PUBLIC_URL} from \"../config\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexGrow: 1,\r\n        height: \"100vh\"\r\n    },\r\n    field: {\r\n        width: \"100%\",\r\n        margin: \"5px\"\r\n    },\r\n    paper: {\r\n        width: \"50%\",\r\n        minWidth: \"500px\",\r\n        height: \"50%\",\r\n        padding: \"50px\",\r\n        margin: \"auto\"\r\n    }\r\n}));\r\n\r\nconst SignupPage = (props) => {\r\n    const classes = useStyles();\r\n    const themeCtx = React.useContext(themeContext);\r\n    const {enqueueSnackbar} = useSnackbar();\r\n\r\n    useOnMount(() => {\r\n        i18next.changeLanguage(query.get('lan')).then();\r\n    })\r\n\r\n    const {t} = useTranslation();\r\n    const errorHandler = useErrorHandler();\r\n    const query = new URLSearchParams(window.location.search);\r\n    const token = query.get('token')\r\n    const email = query.get('email')\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            username: email,\r\n            email: email,\r\n            password: '',\r\n            name: '',\r\n            surname1: '',\r\n            surname2: '',\r\n            password2: ''\r\n        },\r\n        validationSchema: yup.object({  // todo translate\r\n            username: safe_username_required(t),\r\n            email: safe_email_required(t),\r\n            password: safe_password(t),\r\n            password2: safe_password_repetition(t),\r\n            name: yup.string().required(t(\"name_required\")),\r\n            surname1: yup.string().required(t(\"surname1_required\")),\r\n            surname2: yup.string().required(t(\"surname2_required\"))\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: ({username, email, password, name, surname1, surname2, password2}, {setStatus, setSubmitting}) => {\r\n            setStatus();\r\n\r\n            signupService.signup(username, password, email, name, surname1, surname2, token)\r\n                .then(...errorHandler({handle401: false, handle400: false}))\r\n                .then(\r\n                    function (result) {\r\n                        enqueueSnackbar(t(\"sign_up_success\"), {variant: \"success\"});\r\n                        setSubmitting(false);\r\n                        props.history.push(\"/login\");\r\n                    },\r\n                    function (error) {\r\n                        setSubmitting(false);\r\n                        setStatus(error);\r\n\r\n                        if (error.response.status === 401){\r\n                            enqueueSnackbar(t(\"invalid_expired_invite\"), { variant: \"warning\"});\r\n                        } else if (error.response.status === 400) {\r\n                            enqueueSnackbar(t(\"used_invite\"), { variant: \"warning\"});\r\n                        }\r\n                    });\r\n        }\r\n    });\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Grid container>\r\n                <Grid xs={2} item/>\r\n\r\n                <Grid xs={8} item>\r\n                    <Grid\r\n                        container\r\n                        spacing={0}\r\n                        align=\"center\"\r\n                        justify=\"center\"\r\n                        direction=\"column\"\r\n                        style={{height: \"100%\"}}\r\n                    >\r\n                        <Grid item>\r\n                            <Box m={2}>\r\n                                <Paper className={classes.paper}>\r\n                                    <img src={`${PUBLIC_URL}/logo_centrifuga4_${themeCtx.label}.svg`} alt=\"Logo Centrífuga\" style={{height: \"85px\"}}/>\r\n\r\n                                     <Box m={2}>\r\n                                         <Typography>{t(\"been_invited\")}</Typography>\r\n                                    </Box>\r\n\r\n                                    <form onSubmit={formik.handleSubmit}>\r\n                                        <TextField\r\n                                            label={t(\"email\")}\r\n                                            helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                                            type=\"email\"\r\n                                            name=\"email\"\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"email\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                            disabled\r\n                                        />\r\n\r\n\r\n\r\n                                        <TextField\r\n                                            label={t(\"name\")}\r\n                                            helperText={formik.touched[\"name\"] && formik.errors[\"name\"]}\r\n                                            name=\"name\"\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"name\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"surname1\")}\r\n                                            helperText={formik.touched[\"surname1\"] && formik.errors[\"surname1\"]}\r\n                                            name=\"surname1\"\r\n                                            disabled={formik.isSubmitting}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"surname1\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"surname2\")}\r\n                                            helperText={formik.touched[\"surname2\"] && formik.errors[\"surname2\"]}\r\n                                            name=\"surname2\"\r\n                                            disabled={formik.isSubmitting}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"surname2\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"password\")}\r\n                                            name=\"password\"\r\n                                            type=\"password\"\r\n                                            helperText={formik.touched[\"password\"] && formik.errors[\"password\"]}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"password\"]}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                            autoComplete=\"new-password\"\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"confirm_password\")}\r\n                                            name=\"password2\"\r\n                                            type=\"password\"\r\n                                            helperText={formik.touched[\"password2\"] && formik.errors[\"password2\"]}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"password2\"]}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                            autoComplete=\"new-password\"\r\n                                        />\r\n                                        <Box my={3}>\r\n                                            <Button\r\n                                                variant=\"contained\"\r\n                                                color=\"primary\"\r\n                                                type=\"submit\"\r\n                                                disabled={formik.isSubmitting}\r\n                                                className={classes.field}>\r\n                                                {t(\"sign_up\")}\r\n                                            </Button>\r\n                                        </Box>\r\n                                    </form>\r\n                                </Paper></Box>\r\n                        </Grid>\r\n                    </Grid>\r\n                </Grid>\r\n                <Grid xs={2} item>\r\n                    <TranslateButton style={{float: 'right'}}/>\r\n                    <ThemeButton style={{float: 'right'}}/>\r\n                </Grid>\r\n            </Grid></div>);\r\n\r\n}\r\n\r\nexport default SignupPage;","import React from 'react';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport {passwordResetService} from \"../_services/password-reset.service\";\r\nimport i18next from \"i18next\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useOnMount} from \"../_helpers/on-mount\";\r\nimport {safe_password, safe_password_repetition, safe_username_required} from \"../_yup/validators\";\r\nimport {PUBLIC_URL, RECAPTCHA} from \"../config\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        display: \"flex\",\r\n        flexGrow: 1,\r\n        height: \"100vh\"\r\n    },\r\n    field: {\r\n        width: \"100%\",\r\n        margin: \"5px\"\r\n    },\r\n    recaptcha: {\r\n        margin: theme.spacing(3)\r\n    },\r\n    paper: {\r\n        width: \"50%\",\r\n        minWidth: \"500px\",\r\n        height: \"50%\",\r\n        padding: \"50px\",\r\n        margin: \"auto\"\r\n    }\r\n}));\r\n\r\n\r\nconst ResetPage = (props) => {\r\n    const classes = useStyles();\r\n    const themeCtx = React.useContext(themeContext);\r\n\r\n    const [recaptcha, setRecaptcha] = React.useState(null);\r\n    function onChange(value) {\r\n      setRecaptcha(value);\r\n    }\r\n\r\n    const {enqueueSnackbar} = useSnackbar();\r\n\r\n    useOnMount(() => {\r\n        i18next.changeLanguage(query.get('lan')).then();\r\n    })\r\n\r\n    const {t} = useTranslation();\r\n    const query = new URLSearchParams(window.location.search);\r\n    const errorHandler = useErrorHandler();\r\n    const token = query.get('token')\r\n    const email = query.get('email')\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            email: email,\r\n            password: '',\r\n            password2: ''\r\n        },\r\n        validationSchema: yup.object({\r\n            email: safe_username_required(t),\r\n            password: safe_password(t),\r\n            password2: safe_password_repetition(t)\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: ({email, password, password2}, {setStatus, setSubmitting}) => {\r\n            setStatus();\r\n\r\n            passwordResetService\r\n                .reset(email, password, token, recaptcha)\r\n                .then(...errorHandler({handle401: false}))\r\n                .then(\r\n                    function (result) {\r\n                        enqueueSnackbar(t(\"reset_password_success\"), {variant: \"success\"});\r\n                        setSubmitting(false);\r\n                        props.history.push(\"/login\");\r\n                    },\r\n                    function (error) {\r\n                        setSubmitting(false);\r\n                        setStatus(error);\r\n\r\n                        if (error.response.status === 401){\r\n                            enqueueSnackbar(t(\"invalid_expired_reset\"), { variant: \"warning\"});\r\n                        } // TODO report, same in the signup\r\n                    });\r\n        }\r\n    });\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Grid container>\r\n                <Grid xs={2} item/>\r\n\r\n                <Grid xs={8} item>\r\n                    <Grid\r\n                        container\r\n                        spacing={0}\r\n                        align=\"center\"\r\n                        justify=\"center\"\r\n                        direction=\"column\"\r\n                        style={{height: \"100%\"}}>\r\n                        <Grid item>\r\n                            <Box m={2}>\r\n                                <Paper className={classes.paper}>\r\n                                    <img src={`${PUBLIC_URL}/logo_centrifuga4_${themeCtx.label}.svg`} alt=\"Logo Centrífuga\" style={{height: \"85px\"}}/>\r\n\r\n                                     <Box m={2}>\r\n                                         <Typography>{t(\"new_password\")}</Typography>\r\n                                    </Box>\r\n\r\n                                    <form onSubmit={formik.handleSubmit}>\r\n                                        <TextField\r\n                                            label={t(\"email\")}\r\n                                            helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                                            type=\"email\"\r\n                                            name=\"email\"\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"email\"]}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                            disabled\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"password\")}\r\n                                            name=\"password\"\r\n                                            type=\"password\"\r\n                                            helperText={formik.touched[\"password\"] && formik.errors[\"password\"]}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"password\"]}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <TextField\r\n                                            label={t(\"confirm_password\")}\r\n                                            name=\"password2\"\r\n                                            type=\"password\"\r\n                                            helperText={formik.touched[\"password2\"] && formik.errors[\"password2\"]}\r\n                                            className={classes.field}\r\n                                            value={formik.values[\"password2\"]}\r\n                                            disabled={formik.isSubmitting}\r\n                                            onChange={formik.handleChange}\r\n                                            onBlur={formik.handleBlur}\r\n                                            error={formik.status}\r\n                                        />\r\n                                        <ReCAPTCHA sitekey={RECAPTCHA}\r\n                                                 onChange={onChange}\r\n                                                 theme={themeCtx.theme? \"dark\": \"light\"}\r\n                                                 className={classes.recaptcha}\r\n                                      />\r\n                                        <Box my={3}>\r\n                                            <Button\r\n                                                variant=\"contained\"\r\n                                                color=\"primary\"\r\n                                                type=\"submit\"\r\n                                                disabled={formik.isSubmitting || recaptcha==null}\r\n                                                className={classes.field}>\r\n                                                {t(\"change_password\")}\r\n                                            </Button>\r\n                                        </Box>\r\n                                    </form>\r\n                                </Paper>\r\n                            </Box>\r\n                        </Grid>\r\n                    </Grid>\r\n                </Grid>\r\n                <Grid xs={2} item>\r\n                    <TranslateButton style={{float: 'right'}}/>\r\n            <ThemeButton style={{float: 'right'}}/>\r\n                </Grid>\r\n            </Grid></div>);\r\n\r\n}\r\n\r\nexport default ResetPage;","import React from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {PUBLIC_URL, RECAPTCHA} from \"../config\";\r\n\r\n\r\nexport default function XamfraLogo() {\r\n    const themeCtx = React.useContext(themeContext);\r\n\r\n\r\n    return <Box mx={2} style={{textAlign: \"left\"}}>\r\n    <img src={ `${PUBLIC_URL}/logo_xamfra_${themeCtx.label}.png`} alt=\"Logo Xamfrà\"\r\n         style={{height: \"35px\"}}/>\r\n        </Box>\r\n}","import axios from \"axios\";\r\nimport {authHeader} from \"../_helpers/auth-header\";\r\nimport {API_VERSION, BACKEND_URL} from \"../config\";\r\n\r\nexport const preEnrolmentService = {\r\n    getCourses,\r\n    postPreEnrollment\r\n};\r\n\r\nfunction getCourses() {\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            axios({\r\n                method: 'get',\r\n                url: `${BACKEND_URL}/pre-enrolment/v1/courses`,\r\n                headers: {\r\n                    ...{\r\n                        'Content-Type': 'application/json',\r\n                        'Cache-Control': 'no-cache'\r\n                    }, ...authHeader()  // todo are auth headers needed for gets?\r\n                }\r\n            }).then(function (response) {\r\n                    resolve(response.data);\r\n                }).catch(function (err) {\r\n                    reject(err);\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n    function postPreEnrollment(data, recaptcha) {\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            axios({\r\n                method: 'post',\r\n                url: `${BACKEND_URL}/pre-enrolment/v1/pre-enrolment`,\r\n                data: {\r\n                    body: data,\r\n                    recaptcha: recaptcha\r\n                },\r\n                headers: {\r\n                    ...{\r\n                        'Content-Type': 'application/json',\r\n                        'Cache-Control': 'no-cache'\r\n                    }, ...authHeader()\r\n                }\r\n            }).then(function (response) {\r\n                    resolve(response);\r\n                }).catch(function (err) {\r\n                    reject(err);\r\n            });\r\n        });\r\n    }\r\n","export const getNextDayOfWeek = (date, dayOfWeek) => {\r\n    // Code to check that date and dayOfWeek are valid left as an exercise ;)\r\n\r\n    var resultDate = new Date(date.getTime());\r\n\r\n    resultDate.setDate(date.getDate() + (7 + dayOfWeek - date.getDay()) % 7);\r\n\r\n    return resultDate;\r\n}\r\n\r\nexport const getLocalisedWeekday = (dayOfWeek) => {\r\n    let today = new Date();\r\n    let nextDayOfWeek = getNextDayOfWeek(today, dayOfWeek);\r\n    return nextDayOfWeek.toLocaleString(window.navigator.language, {weekday: 'short'});\r\n}\r\n\r\nexport const textSchedulesForCourse = (course) => {\r\n    if (!course[\"base_schedules\"]) return null;\r\n    return course[\"base_schedules\"].map(s => getLocalisedWeekday(s.day_week) + \", \" + s.start_time.slice(0, -3) + \" - \" + s.end_time.slice(0, -3)).join(\"; \");\r\n}\r\n\r\n","import React from 'react';\r\nimport { Divider } from '@material-ui/core';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport XamfraLogo from './xamfra.logo.component';\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        backgroundColor: theme.palette.background.paper\r\n    }\r\n  }));\r\n  \r\n\r\nexport default function XamfraHeader(props) {\r\n    \r\n    const classes = useStyles();\r\n\r\n    return <Box className={classes.root}>\r\n        <Box p={2} style={{width: '100%'}}>\r\n            {props.children}\r\n       <XamfraLogo/>\r\n</Box> \r\n<Divider />\r\n        </Box>\r\n}","import React, {useEffect, useRef, useState} from 'react';\r\nimport * as yup from 'yup';\r\nimport {\r\n    BottomNavigation,\r\n    Card, CardActions,\r\n    Checkbox,\r\n    FormControlLabel, ListItemIcon, ListItemSecondaryAction,\r\n    MenuItem, MobileStepper,\r\n    Step,\r\n    StepLabel,\r\n    Stepper, Tooltip, withStyles\r\n} from \"@material-ui/core\";\r\nimport XamfraLogo from '../_components/xamfra.logo.component';\r\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\r\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext';\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport i18next from \"i18next\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useOnMount} from \"../_helpers/on-mount\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\"\r\nimport DirtyTextField from \"../_components/dirtytextfield.component\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport DirtyCountrySelect from \"../_components/contry-select.component\";\r\nimport {education_years} from \"../_data/education\";\r\nimport {emptyAttendee} from \"../_data/empty_objects\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {student_guardian_relations} from \"../_data/relations\";\r\nimport SearchBar from \"../_components/searchbar.component\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport {PUBLIC_URL, RECAPTCHA} from \"../config\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport {preEnrolmentService} from \"../_services/pre-enrolment.service\";\r\nimport {DNI_OR_NIE_REGEX, safe_email, safe_email_required} from \"../_yup/validators\";\r\nimport {KeyboardArrowLeft, KeyboardArrowRight} from \"@material-ui/icons\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport {textSchedulesForCourse} from \"../utils/localized-weekdays\";\r\n\r\nimport XamfraHeader from '../_components/xamfra.header.component';\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        width: \"100%\"\r\n    },\r\n    field: {\r\n        width: \"100%\",\r\n        margin: \"5px\"\r\n    },\r\n    cards: {\r\n        '& > *': {\r\n            margin: theme.spacing(3),\r\n        },\r\n    },\r\n    buttons: {\r\n        '& > *': {\r\n            margin: theme.spacing(1),\r\n        },\r\n    }, line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    card: {\r\n    minWidth: 200,\r\n        width: 'fit-content',\r\n        maxWidth: 500,\r\n        display: 'inline-block'\r\n  },\r\n    recaptcha: {\r\n        margin: theme.spacing(4)\r\n    },\r\n  bullet: {\r\n    display: 'inline-block',\r\n    margin: '0 2px',\r\n    transform: 'scale(0.8)',\r\n  },\r\n  title: {\r\n    fontSize: 14,\r\n  },\r\n  pos: {\r\n    marginBottom: 12,\r\n  },\r\n    list: {\r\n        minHeight: '150px',\r\n        overflow: 'auto'\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    }\r\n}));\r\n\r\n\r\n\r\nconst isUnderage = (birthDateString) => {\r\n    let today = new Date();\r\n    let birthDate = new Date(birthDateString);\r\n    let age = today.getFullYear() - birthDate.getFullYear();\r\n    let m = today.getMonth() - birthDate.getMonth();\r\n    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) age--;\r\n    return age < 18;\r\n}\r\nconst PreEnrolmentPage = (props) => {\r\n    const {t} = useTranslation();\r\n\r\n    const can_pay_70 = \"Puc pagar la quota trimestral de 70€/estudiant\";\r\n     const can_pay_60 =   \"Puc pagar una quota trimestral de 60€/estudiant\";\r\n     const can_pay_50 =  \"Puc pagar una quota trimestral de 50€/estudiant\";\r\n\r\n    const classes = useStyles();\r\n\r\n\r\n    const [recaptcha, setRecaptcha] = React.useState(null);\r\n    function onChange(value) {\r\n      setRecaptcha(value);\r\n    }\r\n\r\n    const {enqueueSnackbar} = useSnackbar();\r\n    const [skipped, setSkipped] = React.useState(new Set());\r\n    const [availableCourses, setAvailableCourses] = React.useState([]);\r\n    const [filteredCourses, setFilteredCourses] = React.useState([]);\r\n    const [chosenCourses, setChosenCourses] = React.useState([]);\r\n    const [raw_economic_comments, setRawEconomicComments] = React.useState([]);\r\n   const isStepSkipped = (step) => {\r\n    return skipped.has(step);\r\n  };\r\n\r\n    const [activeStep, setActiveStep] = React.useState(0);\r\n    const steps = [t(\"data_protection\"), t(\"student_info\"), t(\"contact_person_1\"), t(\"contact_person_2\"), t(\"courses\"), t(\"payment\"), t(\"confirmation\")];\r\n\r\n    const handleSkip = () => {\r\n    if (!isStepOptional(activeStep)) {\r\n      // You probably want to guard against something like this,\r\n      // it should never occur unless someone's actively trying to break something.\r\n      throw new Error(\"You can't skip a step that isn't optional.\");\r\n    }\r\n\r\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n    setSkipped((prevSkipped) => {\r\n      const newSkipped = new Set(prevSkipped.values());\r\n      newSkipped.add(activeStep);\r\n      return newSkipped;\r\n    });\r\n  };\r\n      const handleBack = () => {\r\n        setActiveStep((prevActiveStep) => prevActiveStep - 1);\r\n      };\r\n\r\n      const handleReset = () => {\r\n        setActiveStep(0);\r\n      };\r\n\r\n      useOnMount(() => {\r\n          i18next.changeLanguage('cat').then();  // set catalan for all visiting families as default\r\n         preEnrolmentService.getCourses()\r\n             .then(...errorHandler({}))\r\n             .then(courses => {\r\n                 setAvailableCourses(courses);\r\n                 setFilteredCourses(courses);\r\n             })\r\n      });\r\n\r\n      const theme = useTheme();\r\n\r\n\r\n      const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    const errorHandler = useErrorHandler();\r\n    const required = t(\"required\");\r\n    const formik = useNormik(false,{\r\n        initialValues: {...emptyAttendee,\r\n            __person1__name: '', __person2__name: '',\r\n__person1__surname1: '',\r\n            __person1__surname2: '',\r\n            __person1__email: '', __person1__phone: '', __person1__relation: '',\r\n            __person1__is_studying: '', __person1__is_working: '', __person1__career: '',\r\n            __person1__education_entity: '', __person1__education_year: '',\r\n            __person2__surname1: '',\r\n            __person2__surname2: '',\r\n            __person2__email: '', __person2__phone: '', __person2__relation: '',\r\n            __person2__is_studying: '', __person2__is_working: '', __person2__career: '',\r\n            __person2__education_entity: '', __person2__education_year: '',\r\n            image_agreement: false\r\n\r\n\r\n        },\r\n        validationSchema: yup.object({  // todo translate\r\n            name: yup.string(required).required(required),\r\n            surname1: yup.string(required).required(required),\r\n            surname2: yup.string(required).required(required),\r\n            email: safe_email(t).when('birth_date', (other, schema) => ((other && !isUnderage(other))? schema.required(required): schema)),\r\n            phone: yup.string().when('birth_date', (other, schema) => ((other && !isUnderage(other))? schema.required(required): schema)),\r\n            address: yup.string(required).required(required),\r\n            city: yup.string(required).required(required),\r\n            zip: yup.number(required).required(required),\r\n            country_of_origin: yup.string(required).notOneOf(['empty']).test(  // one of the array\r\n                                  'countryNonEmpty',\r\n                                  required,\r\n                                  v =>  v !== undefined\r\n                                ),\r\n            gender: yup.string(required).required(required),\r\n            is_studying: yup.boolean(required).required(required),\r\n            is_working: yup.boolean(required).required(required),\r\n            career: yup.string(required).when('is_working', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            education_entity: yup.string(required).when('is_studying', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            education_year: yup.string(required).when('is_studying', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            birth_date: yup.date(required).required(required),\r\n            years_in_xamfra: yup.number(required).required(required),\r\n            __person1__name: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => {\r\n                                      return v !== undefined && v !== \"\" || isStepSkipped(2)\r\n                                  }\r\n                                ),\r\n            __person1__surname1: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>  v !== undefined && v !== \"\"|| isStepSkipped(2)\r\n                                ),\r\n            __person1__surname2: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" || isStepSkipped(2)\r\n                                ),\r\n            __person1__email: safe_email(t).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>v !== undefined && v !== \"\"||  isStepSkipped(2)\r\n                                ),\r\n            __person1__phone: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>v !== undefined && v !== \"\" || isStepSkipped(2)\r\n                                ),\r\n            __person1__relation: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\"|| isStepSkipped(2)\r\n                                ),\r\n            __person1__is_studying: yup.boolean(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" ||  isStepSkipped(2)\r\n                                ),\r\n            __person1__is_working: yup.boolean(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" ||  isStepSkipped(2)\r\n\r\n                                ),\r\n            __person1__career: yup.string(required).when('__person1__is_working', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            __person2__name: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>v !== undefined && v !== \"\" || isStepSkipped(3)\r\n                                ),\r\n            __person2__surname1: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" || isStepSkipped(3)\r\n                                ),\r\n            __person2__surname2: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>  v !== undefined && v !== \"\"|| isStepSkipped(3)\r\n                                ),\r\n            __person2__email: safe_email(t).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" || isStepSkipped(3)\r\n                                ),\r\n            __person2__phone: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>  v !== undefined && v !== \"\"|| isStepSkipped(3)\r\n                                ),\r\n            __person2__relation: yup.string(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>v !== undefined && v !== \"\"|| isStepSkipped(3)\r\n                                ),\r\n            __person2__is_studying: yup.boolean(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v =>  v !== undefined && v !== \"\" || isStepSkipped(3)\r\n                                ),\r\n            __person2__is_working: yup.boolean(required).test(  // one of the array\r\n                                  'requiredIfNotSkipped',\r\n                                  required,\r\n                                  v => v !== undefined && v !== \"\" || isStepSkipped(3)\r\n                                ),\r\n            __person2__career: yup.string(required).when('__person2__is_working', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            __person2__education_entity: yup.string(required).when('__person2__is_studying', {\r\n                                                  is: true,\r\n                                                  then: yup.string().required(required)\r\n                                                }),\r\n            image_agreement: yup.boolean(required)\r\n        }),\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n            setStatus();\r\n\r\n            let body = {};\r\n\r\n            body['image_agreement'] = values.image_agreement;\r\n            body['name'] = values.name;\r\n            body['surname1'] = values.surname1;\r\n            body['surname2'] = values.surname2;\r\n            body['email'] = values.email;\r\n            body['address'] = values.address;\r\n            body['city'] = values.city;\r\n            body['zip'] = values.zip;\r\n            body['dni'] = values.dni;\r\n            body['phone'] = values.phone;\r\n            body['country_of_origin'] = values.country_of_origin;\r\n            body['gender'] = values.gender;\r\n            body['is_studying'] = values.is_studying;\r\n            body['is_working'] = values.is_working;\r\n            body['education_entity'] = values.education_entity;\r\n            body['education_year'] = values.education_year;\r\n            body['career'] = values.career;\r\n            body['birth_date'] = values.birth_date;\r\n            body['years_in_xamfra'] = values.years_in_xamfra;\r\n            body['guardians'] = [];\r\n            [2,3].map(idx => {\r\n                if (!isStepSkipped(idx)){\r\n                    let guardian = {};\r\n                    const prefix = `__person${idx-1}__`;\r\n                    guardian['name'] = values[prefix+\"name\"];\r\n                    guardian['surname1'] = values[prefix+\"surname1\"];\r\n                    guardian['surname2'] = values[prefix+\"surname2\"];\r\n                    guardian['email'] = values[prefix+\"email\"];\r\n                    guardian['phone'] = values[prefix+\"phone\"];\r\n                    guardian['is_studying'] = values[prefix+\"is_studying\"];\r\n                    guardian['is_working'] = values[prefix+\"is_working\"];\r\n                    guardian['education_entity'] = values[prefix+\"education_entity\"];\r\n                    guardian['career'] = values[prefix+\"career\"];\r\n                    guardian['relation'] = values[prefix+\"relation\"];\r\n\r\n                    body['guardians'].push(guardian);\r\n                }\r\n            })\r\n            body['payment_comments'] = raw_economic_comments.join('. ');\r\n            if (raw_economic_comments.includes(can_pay_70)){\r\n                body['price_term'] = 70;\r\n            } else if (raw_economic_comments.includes(can_pay_60)){\r\n                body['price_term'] = 60;\r\n            } else if (raw_economic_comments.includes(can_pay_50)){\r\n                body['price_term'] = 50;\r\n            } else {\r\n                body['price_term'] = null;\r\n            }\r\n            body['other_comments'] = values['other_comments'];\r\n            body['courses'] = chosenCourses.map(x => x.id);\r\n\r\n            setSubmitting(false);\r\n\r\n            preEnrolmentService.postPreEnrollment(body, recaptcha)\r\n                .then(...errorHandler({snackbarSuccess: true}))\r\n                .then(() => {\r\n                    setActiveStep(steps.length);\r\n                })\r\n        }\r\n    });\r\n\r\n useEffect(() => {\r\n          let labels = [];\r\n          if (!isUnderage(formik.values['birth_date']) || formik.values['is_working'] ){\r\n              labels.push(\"adult\");\r\n          }\r\n          if (formik.values['is_studying']){\r\n              labels.push(formik.values['education_year']);\r\n          }\r\n\r\n          setFilteredCourses(availableCourses.filter(x => labels.some(l => x['labels'].includes(l))));\r\n\r\n      }, [availableCourses, formik.values['education_year'], formik.values['birth_date']]);\r\n\r\n\r\n    const isStepOptional = (step) => {\r\n    return step === 3 || (step === 2  && formik.values['birth_date'] !== '' && !isUnderage(formik.values['birth_date']));\r\n  };\r\n    const fieldsToValidatePerStep = [  // to have coinciding indexes with steps\r\n        [],\r\n    ['birth_date', 'name', 'surname1', 'surname2', 'address', 'city', 'zip', 'gender', 'is_studying', 'is_working', 'education_entity', 'education_year', 'career', 'years_in_xamfra', 'country_of_origin', 'phone', 'email'],\r\n        ['__person1__name', '__person1__surname1', '__person1__surname2', '__person1__email', '__person1__phone', '__person1__phone', '__person1__relation', '__person1__is_studying', '__person1__education_entity', '__person1__education_year', '__person1__is_working', '__person1__career'],\r\n        ['__person2__name', '__person2__surname1', '__person2__surname2', '__person2__email', '__person2__phone', '__person2__phone', '__person2__relation', '__person2__is_studying', '__person2__education_entity', '__person2__education_year', '__person2__is_working', '__person2__career'],\r\n    [], [], ['image_agreement'], []];\r\n\r\n    const scrollToTop = () => {\r\n        window.scrollTo(0,0);\r\n    }\r\n\r\n    const handleNext = () => {\r\n        formik.setFieldTouched('');\r\n\r\n        let newSkipped = skipped;\r\n        if (isStepSkipped(activeStep)) {\r\n            newSkipped = new Set(newSkipped.values());\r\n            newSkipped.delete(activeStep);\r\n        }\r\n\r\n        setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n        setSkipped(newSkipped);\r\n\r\n        scrollToTop();\r\n    };\r\n\r\n    const secondaryListItemTextForCourse = (course) => {\r\n        const schedules = textSchedulesForCourse(course);\r\n        const description = course['description'];\r\n        if (!description && !schedules) return null;\r\n        if (description && schedules) return description + \" · \" + schedules;\r\n        if (!description) return schedules;\r\n        if (!schedules) return description;\r\n    }\r\n\r\n\r\n    const themeCtx = React.useContext(themeContext);\r\n    const canNotGoNext = (activeStep === steps.length - 1)\r\n        || !fieldsToValidatePerStep[activeStep].every(f => (!formik.errors[f]))\r\n            || (activeStep === steps.length - 3 && chosenCourses.length === 0);\r\n\r\n    const courseToListItem = (course) =>\r\n        <Box><ListItem key={course[\"id\"]} button alignItems=\"flex-start\"\r\n                                  onClick={() => {\r\n                                        if (chosenCourses.includes(course)) {\r\n                                            setChosenCourses(chosenCourses.filter(x => x.id !== course.id));\r\n                                        } else {\r\n                                            setChosenCourses([...chosenCourses, course]);\r\n                                        }\r\n                                  }}>\r\n            <ListItemIcon>\r\n                <Checkbox\r\n                    edge=\"start\"\r\n                    disableRipple\r\n                    tabIndex={-1}\r\n                    checked={chosenCourses.includes(course)}\r\n                    onChange={ () =>  {}}\r\n                    inputProps={{ 'aria-label': 'primary checkbox' }}\r\n                  />\r\n            </ListItemIcon>\r\n\r\n\r\n                            <ListItemText id=\"description\"\r\n                                          primary={course['name']}\r\n                                          secondary={secondaryListItemTextForCourse(course)}/>\r\n\r\n                        </ListItem>\r\n                        <Divider/></Box>;\r\n\r\n\r\n\r\n    return (\r\n        <Box>\r\n        <XamfraHeader>\r\n            <TranslateButton/>\r\n            <ThemeButton/>\r\n        </XamfraHeader> \r\n                    <div>\r\n\r\n                   \r\n     <Box marginBottom={2}>\r\n            \r\n            </Box>\r\n        {activeStep === steps.length ? (\r\n          <div style={{textAlign:\"center\"}}>\r\n            <Box>\r\n                Prematrícula completada amb èxit!<br/>\r\n                ¡Prematrícula completada con éxito!<br/>\r\n                Pre-enrolment successful!\r\n            </Box>\r\n              <Box m={4}>\r\n              <CheckCircleIcon fontSize=\"large\"\r\n                               style={{ color: theme.palette.neutral.status.success }}/></Box>\r\n          </div>\r\n        ) : (\r\n             <form onSubmit={formik.handleSubmit}>\r\n          <Box p={2}>\r\n              <div>\r\n                  {activeStep === 0 &&\r\n                  <div>\r\n                      <Typography>\r\n                          Podeu consultar el quadre horari del curs 21-22 <Link target=\"_blank\" href=\"https://xamfra.net/com-participar-hi/horaris/\">aquí</Link>.\r\n                      </Typography>\r\n                      <br/>\r\n                      <Typography variant={\"caption\"}>\r\nEnviar aquest formulari implica consentiment per fer ús de les dades per tal de rebre informació durant el període de preinscripció i inici de curs.\r\n\r\nLa posterior matrícula presencial al centre implica també l'ús de les dades durant tot el curs 2021-2022.\r\n\r\nLa nostra política protecció de dades es basa en que:\r\n\r\n1) El Responsable del Tractament de les teves dades personals és de Xamfrà, Centre de Música i Escena del Raval (Fundació l'ARC Música)\r\n2) Les finalitats del tractament de les dades personals és la de gestionar la teva vinculació amb Xamfrà. La base de dades disposa de noms, telèfons, adreça postal i adreça electrònica.\r\n3) Les teves dades no seran comunicades a tercers sense previ consentiment.\r\n4) Pots exercir els drets d'accés, rectificació i oposició segons preveu a la normativa enviant un correu electrònic a: xamfra@xamfra.net\r\n            </Typography>\r\n\r\n                  </div>\r\n                  }\r\n\r\n\r\n\r\n\r\n\r\n                  {activeStep === 1 &&\r\n                  <div>\r\n                      <Typography variant=\"h4\">{t(\"student\")}</Typography>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name=\"name\"\r\n                                autocomplete=\"name given-name\"\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"surname1\")}\r\n                                style={{flex: 1}}\r\n                                name=\"surname1\"\r\n                                formik={formik}\r\n                                autocomplete=\"name additional-name\"\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"surname2\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"surname2\"\r\n                                autocomplete=\"name family-name\"\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n\r\n                                <DirtyTextField\r\n                                label={t(\"birthdate\")}\r\n                                type=\"date\"\r\n                                style={{flex: 1}}\r\n                                noDirty={true}\r\n                                formik={formik}\r\n                                name=\"birth_date\"\r\n                                autoComplete=\"bday\"\r\n                                InputLabelProps={{shrink: true}}/>\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"email\")}\r\n                                type=\"email\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name=\"email\"\r\n                                noDirty={true}\r\n                                helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                            />\r\n                        </Box>\r\n\r\n                       <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"address\")}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                autocomplete=\"street-address\"\r\n                                style={{flex: 4}}\r\n                                name=\"address\"\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"city\")}\r\n                                style={{flex: 2}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name=\"city\"\r\n                                autoComplete=\"address-level2\"\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"zip\")}\r\n                                formik={formik}\r\n                                type=\"number\"\r\n                                autoComplete=\"postal-code\"\r\n                                noDirty={true}\r\n                                style={{flex: 1}}\r\n                                name=\"zip\"\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"dni\")}\r\n                                style={{flex: 1}}\r\n                                noDirty={true}\r\n                                formik={formik}\r\n                                name=\"dni\"\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"phone\")}\r\n                                type=\"tel\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name=\"phone\"\r\n                            />\r\n                        </Box>\r\n\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyCountrySelect\r\n                                formik={formik}\r\n                                style={{flex: 1}}\r\n                                noDirty={true}\r\n                                name={\"country_of_origin\"}\r\n                                label={t(\"country_of_origin\")}\r\n                                autoComplete=\"country\"\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"gender\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name=\"gender\"\r\n                                select>\r\n                                <MenuItem value=\"m\">{t(\"m\")}</MenuItem>\r\n                                <MenuItem value=\"f\">{t(\"f\")}</MenuItem>\r\n                                <MenuItem value=\"nb\">{t(\"nb\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n                        <Box my={3}>\r\n                        <Divider />\r\n                        </Box>\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"is_studying\")}\r\n                                style={{flex: 1}}\r\n                                name=\"is_studying\"\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"education_entity\")}\r\n                                style={{flex: 2}}\r\n                                formik={formik}\r\n                                name=\"education_entity\"\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"education_year\")}\r\n                                style={{flex: 2}}\r\n                                noDirty={true}\r\n                                name=\"education_year\"\r\n                                formik={formik}\r\n                                select>\r\n                                {education_years.map((level) => (\r\n                                    <MenuItem key={level} value={level}>{t(level)}</MenuItem>\r\n                                ))}\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                      <Box my={3}>\r\n                        <Divider />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n\r\n\r\n                            <DirtyTextField\r\n                                label={t(\"is_working\")}\r\n                                style={{flex: 1}}\r\n                                name=\"is_working\"\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n\r\n                            <DirtyTextField\r\n                                label={t(\"career\")}\r\n                                style={{flex: 4}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name=\"career\"\r\n                            />\r\n                        </Box>\r\n\r\n                         <Box my={3}>\r\n                        <Divider />\r\n                        </Box>\r\n\r\n\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n\r\n                            <DirtyTextField\r\n                              label={t(\"years_in_xamfra\")}\r\n                              type=\"number\"\r\n                              noDirty={true}\r\n                              formik={formik}\r\n                              style={{flex: 1}}\r\n                              name=\"years_in_xamfra\"/>\r\n                        </Box>\r\n\r\n\r\n\r\n                  </div>\r\n                  }\r\n\r\n\r\n                  {(activeStep === 2 || activeStep === 3) &&\r\n                  <div>\r\n                      <Typography variant=\"h4\">{t(\"contact\") + \" \" + (activeStep - 1)}</Typography>\r\n                      {isStepOptional(activeStep) && <Tooltip title={t(\"skip\")}>\r\n                          <Box my={2}><Button\r\n                              size=\"medium\"\r\n                              onClick={handleSkip}\r\n                              variant=\"contained\"\r\n                              aria-label={t(\"skip\")}\r\n                              startIcon={<SkipNextIcon/>}\r\n                              color=\"primary\"\r\n                              disabled={!isStepOptional(activeStep)}>\r\n                              {t(\"skip\")}\r\n                          </Button></Box></Tooltip>}\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"name\")}\r\n                                style={{flex: 1}}\r\n                                name={\"__person\" + (activeStep-1) + \"__name\"}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"surname1\")}\r\n                                style={{flex: 1}}\r\n                                name={\"__person\" + (activeStep-1) + \"__surname1\"}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"surname2\")}\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name={\"__person\" + (activeStep-1) + \"__surname2\"}\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"email\")}\r\n                                type=\"email\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                name={\"__person\" + (activeStep-1) + \"__email\"}\r\n                                noDirty={true}\r\n                                helperText={formik.touched[\"email\"] && formik.errors[\"email\"]}\r\n                            />\r\n                        </Box>\r\n\r\n                       <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"phone\")}\r\n                                type=\"tel\"\r\n                                style={{flex: 1}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name={\"__person\" + (activeStep-1) + \"__phone\"}\r\n                            />\r\n                        </Box>\r\n\r\n                      <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"relation\")}\r\n                                style={{flex: 1}}\r\n                                name={\"__person\" + (activeStep-1) + \"__relation\"}\r\n                                select\r\n                                noDirty={true}\r\n                                formik={formik}\r\n                            >\r\n                          {student_guardian_relations.map((r) => (\r\n                                   <MenuItem key={r} value={r}>{t(r)}</MenuItem>\r\n                                ))}\r\n                                ))}\r\n                        </DirtyTextField>\r\n                        </Box>\r\n\r\n\r\n            <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"is_studying\")}\r\n                                style={{flex: 1}}\r\n                                name={\"__person\" + (activeStep - 1) + \"__is_studying\"}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n                       <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"education_entity\")}\r\n                                style={{flex: 4}}\r\n                                formik={formik}\r\n                                name={\"__person\" + (activeStep-1) + \"__education_entity\"}\r\n                                noDirty={true}\r\n                            />\r\n                        </Box>\r\n\r\n                       <Box my={3}>\r\n            <Divider />\r\n            </Box>\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n\r\n\r\n                            <DirtyTextField\r\n                                label={t(\"is_working\")}\r\n                                style={{flex: 1}}\r\n                                name={\"__person\" + (activeStep-1) + \"__is_working\"}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                select>\r\n                                <MenuItem value={true}>{t(\"yes\")}</MenuItem>\r\n                                <MenuItem value={false}>{t(\"no\")}</MenuItem>\r\n                            </DirtyTextField>\r\n                        </Box>\r\n\r\n\r\n                        <Box className={[classes.line, classes.composite]}>\r\n                            <DirtyTextField\r\n                                label={t(\"career\")}\r\n                                style={{flex: 4}}\r\n                                formik={formik}\r\n                                noDirty={true}\r\n                                name={\"__person\" + (activeStep-1) + \"__career\"}\r\n                            />\r\n                        </Box>\r\n\r\n\r\n\r\n\r\n                  </div>\r\n                  }\r\n\r\n    {activeStep === 4 &&\r\n    <div>\r\n\r\n        {/*<Box className={classes.cards}>\r\n            {chosenCourses && chosenCourses.map(course => (\r\n                <Card className={classes.card} raised={true}>\r\n                    <CardContent>\r\n\r\n                        <Typography variant=\"h5\" component=\"h2\">\r\n                            {course['name']}\r\n                        </Typography>\r\n                        <Typography className={classes.pos} color=\"textSecondary\">\r\n                            {course['description'] ? course['description'] : \"...\"}\r\n                        </Typography>\r\n                        {course['base_schedules'] && course['base_schedules'].map(s => (\r\n                            <Typography variant=\"body2\" component=\"p\">\r\n                                {getLocalisedWeekday(s.day_week)}, {s.start_time.slice(0, -3)} - {s.end_time.slice(0, -3)}\r\n                            </Typography>\r\n                        ))}\r\n\r\n\r\n                    </CardContent>\r\n                    <CardActions>\r\n                        <IconButton size=\"small\" onClick={() => {\r\n                            setChosenCourses(chosenCourses.filter(c => (c !== course)))\r\n                        }}><DeleteIcon/></IconButton>\r\n                    </CardActions>\r\n                </Card>\r\n            ))}\r\n        </Box>*/}\r\n\r\n\r\n                <SearchBar\r\n                    label={t(\"courses\")}\r\n                    value={searchTerm}\r\n                    onChange={(e) => {\r\n                        setSearchTerm(e.target.value);\r\n                    }}\r\n                    onSearch={() => {}}\r\n                />\r\n            <List className={classes.list}>\r\n                {filteredCourses && filteredCourses.filter(x =>\r\n                    (x.name.includes(searchTerm) || (x.description !== null && x.description.includes(searchTerm)))).map((course) => (\r\n                    <div key={course[\"id\"]}>\r\n                        {courseToListItem(course)}\r\n                    </div>\r\n                ))}\r\n            </List>\r\n             {filteredCourses.length === 0 &&\r\n                <Typography>{t(\"no_courses_found_add_edu\")}</Typography>\r\n             }\r\n    </div>}\r\n\r\n  {activeStep === 5 &&\r\n      <div>\r\n          <Box fontWeight={500} my={2}>\r\n              Xamfrà és un centre que treballa perquè tots els infants i joves puguin fer música, teatre i dansa. Les famílies aporten el que poden per ajudar a fer sostenible el centre. En cap cas, la quota cobreix el cost dels tallers que fan els nens i nenes. Marqueu, si us plau, una o vàries opcions.\r\n              <br/><br/>\r\n              CAP INFANT O JOVE HA DE DEIXAR DE FER TEATRE, MÚSICA O DANSA A XAMFRÀ PER MOTIUS ECONÒMICS.\r\n              <br/><br/>\r\n              A qui no pugui, l'ajudarem; i qui pugui ajudar: moltes gràcies!\r\n          </Box>\r\n\r\n          <List className={classes.list}>\r\n                {\r\n              [can_pay_70,\r\n              can_pay_60,\r\n              can_pay_50,\r\n              \"Puc pagar una quota a acordar personalment\",\r\n              \"No puc pagar la quota trimestral\",\r\n              \"Puc aportar una segona quota per un altre nen/a (desgravació fiscal)\",\r\n              \"Puc fer-me teamer (1 €/mes)\",\r\n              \"Puc fer donatius puntuals (desgravació fiscal)\",\r\n              \"Puc fer donatius regulars (desgravació fiscal)\",\r\n              \"Puc ajudar en tasques puntuals\",\r\n              \"Puc ajudar a la Campanya RISUONA (donació d'instruments)\",\r\n              \"Puc fer serveis professionals relacionats amb els meus estudis o professió\"].map(option => (\r\n                  <Box><ListItem key={option} alignItems=\"flex-start\">\r\n                      <ListItemText id=\"description\"\r\n                                          primary={option}/>\r\n                      <ListItemSecondaryAction>\r\n\r\n                      <Checkbox\r\n                    edge=\"start\"\r\n                    disableRipple\r\n                    tabIndex={-1}\r\n                    checked={raw_economic_comments.includes(option)}\r\n                    onClick={(event) => {\r\n                        if (!raw_economic_comments.includes(option)) {\r\n                             setRawEconomicComments([...raw_economic_comments, option]);\r\n                        } else {\r\n                            setRawEconomicComments( raw_economic_comments.filter((x) => x !== option));\r\n                        }\r\n                    }}\r\n                    inputProps={{ 'aria-label': 'primary checkbox' }}\r\n                  />\r\n\r\n                  </ListItemSecondaryAction>\r\n\r\n\r\n\r\n                        </ListItem>\r\n                        <Divider/></Box>\r\n\r\n              ))\r\n          }\r\n            </List>\r\n\r\n\r\n      </div>\r\n               }\r\n\r\n               {activeStep === 6 &&\r\n      <div>\r\n          <Box className={[classes.line, classes.composite]}>\r\n                             <DirtyTextField\r\n                                label={t(\"other_comments\")}\r\n                                style={{flex: 1}}\r\n                                multiline\r\n                                formik={formik}\r\n                                rowsMax={8}\r\n                                noDirty={true}\r\n                                name=\"other_comments\"\r\n                            />\r\n                        </Box>\r\n          <Box my={2}>\r\n          <FormControlLabel\r\n                        control={\r\n                            <Checkbox\r\n                                defaultValue={false}\r\n                                defaultChecked={false}\r\n                                checked={formik.values['image_agreement']}\r\n                                name={'image_agreement'}\r\n                                value={formik.values['image_agreement']}\r\n                                onChange={formik.handleChange}\r\n                                onBlur={formik.handleBlur}\r\n                            />\r\n                        }\r\n                        key={'image_agreement'}\r\n                        label={isUnderage(formik.values['birth_date'])?\r\n                        \"En cas de matricular-lo, autoritzo l’ús de la imatge de l’estudiant, menor d'edat, per a que pugui aparèixer a materials escrits o multimèdia corresponents a activitats educatives organitzades per Xamfrà.\"\r\n                        : \"En cas de matricular-me, autoritzo l’ús de la meva imatge per a que pugui aparèixer a materials escrits o multimèdia corresponents a activitats educatives organitzades per Xamfrà.\" }\r\n                      />\r\n</Box>\r\n          <Box textAlign=\"center\">\r\n                      <ReCAPTCHA sitekey={RECAPTCHA}\r\n                                 onChange={onChange}\r\n                                 theme={themeCtx.theme? \"dark\": \"light\"}\r\n                                 className={classes.recaptcha}\r\n                                 style={{\r\n                                     display: \"inline-block\",\r\n                                     margin: \"0 auto\",\r\n  width: \"fit-content\"\r\n                                 }}\r\n                      />\r\n                <Box my={2}><Button\r\n                              size=\"medium\"\r\n                              variant=\"contained\"\r\n                              aria-label={t(\"finish\")}\r\n                              startIcon={<DoneIcon/>}\r\n                              color=\"primary\"\r\n                              type=\"submit\"\r\n                          disabled={formik.isSubmitting || recaptcha === null || !fieldsToValidatePerStep[activeStep].every(f => (!formik.errors[f]))}>\r\n                              {t(\"finish\")}\r\n                          </Button></Box>\r\n\r\n              </Box>\r\n      </div>\r\n               }\r\n\r\n              </div>\r\n\r\n\r\n              </Box>\r\n\r\n<Box py={5}/>\r\n<BottomNavigation\r\n  showLabels\r\n  style={{\r\n      position: 'fixed',\r\n    bottom: 0,\r\n      width: '100%'\r\n  }}\r\n>\r\n  <MobileStepper\r\n                          variant=\"dots\"\r\n                          steps={steps.length}\r\n                          position=\"static\"\r\n                          style={{\r\n                              width:\"100%\",\r\n                              margin: 0,\r\n                              backgroundColor: theme.palette.primary.light,\r\n                          }}\r\n                          color={theme.palette.primary.contrastText}\r\n                          activeStep={activeStep}\r\n                          nextButton={\r\n                              <Box>\r\n{activeStep !== steps.length -1 &&\r\n    <Box>\r\n                            <Tooltip title={t(\"next\")}><IconButton size=\"small\"\r\n                                    onClick={handleNext}\r\n                                    disabled={canNotGoNext}\r\n                            aria-label={t(\"next\")}>\r\n                                <NavigateNextIcon /></IconButton></Tooltip>\r\n\r\n                            <Tooltip title={t(\"skip\")}>\r\n                               <IconButton\r\n                                size=\"small\"\r\n                                onClick={handleSkip}\r\n                                aria-label={t(\"skip\")}\r\n\r\n                                disabled={!isStepOptional(activeStep)}>\r\n                              <SkipNextIcon/>\r\n                               </IconButton></Tooltip></Box>}\r\n\r\n                                  {activeStep === steps.length -1 && <Tooltip title={t(\"finish\")}>\r\n                                      <IconButton\r\n                                          size=\"small\"\r\n                                          onClick={() => {}}\r\n                                          aria-label={t(\"finish\")}\r\n                                          type=\"submit\"\r\n                                          disabled={formik.isSubmitting || recaptcha === null || !fieldsToValidatePerStep[activeStep].every(f => (!formik.errors[f]))}>\r\n                                          <DoneIcon/>\r\n                                      </IconButton>\r\n\r\n                                  </Tooltip>}\r\n                              </Box>\r\n                          }\r\n                          backButton={\r\n                              <Tooltip title={t(\"back\")}>\r\n                            <IconButton\r\n                                size=\"small\"\r\n                                onClick={handleBack}\r\n                                aria-label={t(\"back\")}\r\n                                disabled={activeStep === 0}>\r\n                              <NavigateBeforeIcon/>\r\n                            </IconButton></Tooltip>\r\n\r\n                          }\r\n                        />\r\n</BottomNavigation>\r\n\r\n             </form>\r\n          )}\r\n                    </div>\r\n\r\n\r\n\r\n        </Box>\r\n\r\n\r\n\r\n\r\n        );\r\n\r\n}\r\n\r\nexport default PreEnrolmentPage;","import Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport React from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nexport default function HomeButton({...props}){\r\n    const {t} = useTranslation();\r\n    let history = useHistory();\r\n\r\n    return  <Tooltip title={t(\"home\")}\r\n                     style={{float: 'right'}} {...props}>\r\n                <IconButton\r\n                    color=\"inherit\"\r\n                    aria-label={t(\"home\")}\r\n                    onClick={() => history.replace(\"/home\")}>\r\n                    <HomeIcon/>\r\n                </IconButton>\r\n            </Tooltip>;\r\n}","import React, {useEffect, useRef, useState} from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {textSchedulesForCourse} from \"../../utils/localized-weekdays\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {userContext} from \"../../_context/user-context\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  welcomeMessage: {\r\n    '-webkit-touch-callout': 'none',\r\n    '-webkit-user-select': 'none',\r\n    '-khtml-user-select': 'none',\r\n    '-moz-user-select': 'none',\r\n    '-ms-user-select': 'none',\r\n    'user-select': 'none'\r\n}\r\n}));\r\n\r\nexport default function WelcomeTitle({course}) {\r\n  const classes = useStyles();\r\n  const userCtx = React.useContext(userContext);\r\n  const {t} = useTranslation();\r\n\r\n  const hi = \"😄\";\r\n  const hiii = \"🥰\";\r\n  const [welcomeEmoji, setWelcomeEmoji] = useState(hi);\r\n  const switchWelcomeEmoji = () => {\r\n      setWelcomeEmoji(welcomeEmoji == hi? hiii: hi);\r\n  }\r\n  return (\r\n    <Box p={4}\r\n      display=\"flex\"\r\n      justifyContent=\"center\"\r\n      alignItems=\"center\">\r\n          <Typography variant=\"h4\" className={classes.welcomeMessage}>\r\n              {t(\"hi\")} {userCtx.teacher === undefined? '': userCtx.teacher.name} \r\n          </Typography>\r\n          <Typography variant=\"h4\" className={classes.welcomeMessage} onClick={switchWelcomeEmoji} onMouseOver={() => setWelcomeEmoji(hiii)} onMouseOut={() => setWelcomeEmoji(hi)}>\r\n              {welcomeEmoji}\r\n          </Typography>\r\n      </Box>\r\n  );\r\n}","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {textSchedulesForCourse} from \"../../utils/localized-weekdays\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\"\r\n  },\r\n  title: {\r\n    fontSize: 14,\r\n  },\r\n  pos: {\r\n    marginBottom: 12,\r\n  },\r\n  action: {\r\n    float: \"bottom\"\r\n  },\r\n  flexGrow: {\r\n    flexGrow: 1 \r\n  }\r\n}));\r\n\r\nexport default function CourseCard(props) {\r\n  const classes = useStyles();\r\n  let history = useHistory();\r\n  const { course = null} = props;\r\n  const loading = course === null;\r\n  const {t} = useTranslation();\r\n\r\n  const courseId = course === null? null: course[\"id\"];\r\n  const handleViewCourse = () => history.replace(`/home/courses?id=${courseId}`);\r\n  const handleTakeAttendance = () => history.replace(`/attendance?id=${courseId}`)\r\n  return (\r\n    <Card className={classes.root}>\r\n        <CardContent>\r\n        <Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n            {loading? <Skeleton/> : t(\"course\")}\r\n          </Typography>\r\n\r\n          <Typography variant=\"h5\" component=\"h2\">\r\n            {loading? <Skeleton/> : course[\"name\"]}\r\n          </Typography>\r\n\r\n          <Typography className={classes.pos} color=\"textSecondary\">\r\n            {loading? <Skeleton/> : textSchedulesForCourse(course)}\r\n          </Typography>\r\n          \r\n        </CardContent>\r\n        <div className={classes.flexGrow} />\r\n        <CardActions className={classes.action}>\r\n          {loading? <Skeleton variant=\"rect\" width={75} height={30} />:\r\n          <Button variant=\"outlined\" size=\"small\" onClick={handleViewCourse}>{t(\"view\")}</Button>}\r\n          {loading? <Skeleton variant=\"rect\" width={210} height={30} />:\r\n          <Button variant=\"outlined\" color=\"secondary\" size=\"small\" onClick={handleTakeAttendance}>{t(\"take attendance\")}</Button>}\r\n        </CardActions>\r\n      </Card>\r\n  );\r\n}","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    \r\n  }));\r\n  \r\n  export default function MoreButton(props) {\r\n    const classes = useStyles();\r\n    const {t} = useTranslation();\r\n  \r\n    return (\r\n        <Chip\r\n          label={t(\"load-more\")}\r\n          clickable\r\n          variant=\"outlined\"\r\n          icon={<MoreHorizIcon/>}\r\n          {...props}\r\n        />\r\n    );\r\n  }","import React, {useEffect, useRef, useState} from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {textSchedulesForCourse} from \"../../utils/localized-weekdays\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {userContext} from \"../../_context/user-context\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  welcomeMessage: {\r\n    '-webkit-touch-callout': 'none',\r\n    '-webkit-user-select': 'none',\r\n    '-khtml-user-select': 'none',\r\n    '-moz-user-select': 'none',\r\n    '-ms-user-select': 'none',\r\n    'user-select': 'none'\r\n}\r\n}));\r\n\r\nexport default function NotATeacherTitle({course}) {\r\n  const classes = useStyles();\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Box p={4}\r\n      display=\"flex\"\r\n      justifyContent=\"center\"\r\n      alignItems=\"center\">\r\n          <Typography variant=\"h4\" className={classes.welcomeMessage}>\r\n          🎓 {t(\"teachers-only-zone\")} 🎓\r\n          </Typography>\r\n      </Box>\r\n  );\r\n}","import React, {useEffect, useState} from 'react';\r\nimport * as yup from 'yup';\r\nimport XamfraHeader from '../_components/xamfra.header.component';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport HomeButton from '../_components/home_button';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport WelcomeTitle from \"./components/WelcomeTitle\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useSnackbar} from \"notistack\";\r\nimport {useErrorHandler} from \"../_helpers/handle-response\";\r\nimport {useNormik} from \"../_helpers/normik\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport useTheme from \"@material-ui/core/styles/useTheme\";\r\nimport CourseCard from \"./components/CourseCard.js\";\r\nimport TeacherCoursesService from \"../_services/teachers_courses.service\";\r\nimport {userContext} from \"../_context/user-context\";\r\nimport MoreButton from \"./components/MoreButton\";\r\nimport NotATeacherTitle from './components/NotATeacherTitle';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        flexGrow: 1,\r\n        \r\n    },\r\n    rootBase: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        height: \"100vh\",\r\n    },\r\n    more: {\r\n        width: '100%',\r\n        textAlign: 'center'\r\n    }\r\n}));\r\n\r\nconst TeacherDashboardPage = (props) => {\r\n    const {t} = useTranslation();\r\n    const classes = useStyles();\r\n    const {enqueueSnackbar} = useSnackbar();\r\n    const theme = useTheme();\r\n\r\n\r\n    const errorHandler = useErrorHandler();\r\n    \r\n    const formik = useNormik(false,{\r\n        initialValues: {},\r\n        validationSchema: yup.object({}),\r\n        enableReinitialize: true,\r\n        onSubmit: (values, {setStatus, setSubmitting}) => {\r\n            setStatus();\r\n            setSubmitting(false);\r\n        }\r\n    });\r\n\r\n    const themeCtx = React.useContext(themeContext);\r\n\r\n    const [courses, setCourses] = useState([]);\r\n    const [maxPage, setMaxPage] = useState(null);\r\n    const [loadedUntilPage, setLoadedUntilPage] = useState(0);\r\n    const [attemptLoadedUntilPage, setAttemptLoadedUntilPage] = useState(1);\r\n    const [attemptingLoad, setAttemptingLoad] = useState(false);\r\n\r\n    const loading = attemptingLoad && loadedUntilPage == 0;\r\n\r\n    const incrementPage = (i=1) => {\r\n        if (maxPage === null) return;\r\n        if (loadedUntilPage >= maxPage) return;\r\n        setAttemptLoadedUntilPage(loadedUntilPage+1);\r\n    }\r\n    \r\n    const userCtx = React.useContext(userContext);\r\n    useEffect(() => {\r\n        if (userCtx.teacher === null || userCtx.teacher === undefined) return;\r\n        \r\n        const page = attemptLoadedUntilPage;\r\n        setAttemptingLoad(true);\r\n        TeacherCoursesService.getAll(null, page, null, null, userCtx.teacher.id).then(...errorHandler({})).then(newCourses => {\r\n            setCourses([...courses, ...newCourses[\"data\"]]);\r\n            setMaxPage(newCourses[\"_pagination\"][\"totalPages\"]);\r\n            setLoadedUntilPage(page);\r\n        }).finally(() => setAttemptingLoad(false));\r\n    }, [attemptLoadedUntilPage, userCtx.teacher]);\r\n\r\n    \r\n    return (\r\n        <Box className={classes.rootBase}>\r\n            <XamfraHeader>\r\n                <TranslateButton/>\r\n                <ThemeButton/>\r\n                <HomeButton/>\r\n            </XamfraHeader>\r\n\r\n            <Box p={4} className={classes.root}>\r\n            {\r\n            (userCtx.teacher === null || userCtx.teacher === undefined) && \r\n              <NotATeacherTitle/>\r\n            }\r\n\r\n            {\r\n            !(userCtx.teacher === null || userCtx.teacher === undefined) && \r\n            <Box>\r\n                <WelcomeTitle/>\r\n\r\n                    <Grid container spacing={3} justify=\"left\">\r\n                   \r\n                   {\r\n                       loading &&  [1,2,3,4,5,6,7,8,9, 10].map(_ => <Grid xs={12} sm={6} md={3} key={\"loading\"} item>\r\n                       <CourseCard course={null}/>\r\n                   </Grid> )\r\n                   }\r\n                    {courses.map(course =>  \r\n                    <Grid xs={12} sm={6} md={3} key={course.id} item>\r\n                <CourseCard course={course}/>\r\n            </Grid> \r\n                )}\r\n            \r\n            \r\n        </Grid>\r\n            <Box p={2} className={classes.more}>\r\n            {loadedUntilPage < maxPage && <MoreButton onClick={incrementPage} disabled={attemptingLoad}/>}\r\n            </Box>\r\n        </Box>\r\n            }\r\n            </Box>\r\n        </Box>\r\n        );\r\n}\r\n\r\nexport default TeacherDashboardPage;","import Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Brightness4Icon from \"@material-ui/icons/Brightness4\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport React from \"react\";\r\nimport {themeContext} from \"../_context/theme-context\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\nexport default function NotFound({}){\r\n    const themeCtx = React.useContext(themeContext);\r\n    const {t} = useTranslation();\r\n\r\n    return  <Typography variant=\"h1\">Nope, not found... 👻</Typography>;\r\n}","import serviceFactory from \"./service-factory\";\r\n\r\n\r\nexport default new (serviceFactory('attendances'))();\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {Checkbox, Box, ListItem, ListItemIcon, ListItemText, Tooltip} from \"@material-ui/core\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormHelperText from '@material-ui/core/FormHelperText';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport { styled } from \"@material-ui/core/styles\";\r\nimport InsertCommentIcon from '@material-ui/icons/InsertComment';\r\nimport {STATUS_ATTENDANCE, STATUS_ABSENT, STATUS_ABSENT_JUSTIFIED} from './status';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport OutlinedInput from \"@material-ui/core/OutlinedInput\";\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    formControl: {\r\n        [theme.breakpoints.down('sm')]: {minWidth: '50%', maxWidth: '50%'},\r\n        [theme.breakpoints.up('sm')]: {minWidth: '25%', maxWidth: '25%'}\r\n    },\r\n    selectStatus: {\r\n        '&:before': {\r\n            borderColor: 'red',\r\n        },\r\n        '&:after': {\r\n            borderColor: 'red',\r\n        }\r\n    },\r\n    root: {\r\n        width: '100%'\r\n    }\r\n  }));\r\n\r\nexport default function AttendanceItem({student, attendance, setAttendance, handleOpenCommentBox}) {\r\n    \r\n    const classes = useStyles();\r\n    const labelId = `checkbox-list-label-${student[\"id\"]}`;\r\n    const { t } = useTranslation();\r\n\r\n    const status = attendance === null? null: attendance[\"status\"];\r\n    const setStatus = (newStatus) => setAttendance({...attendance, status: newStatus});\r\n    \r\n    const handleChange = (event) => {\r\n        setStatus(event.target.value);\r\n      };\r\n      const toggleStatus = () => {\r\n          if (status === STATUS_ATTENDANCE) return setStatus(STATUS_ABSENT);\r\n          setStatus(STATUS_ATTENDANCE);\r\n      }\r\n\r\n      const useOutlinedInputStyles = makeStyles(theme => ({\r\n        root: {\r\n          \"& $notchedOutline\": {\r\n            borderColor: status === STATUS_ATTENDANCE? theme.palette.neutral.status.success: status === STATUS_ABSENT? theme.palette.neutral.status.error: theme.palette.neutral.status.dirty  \r\n          },\r\n        },\r\n        focused: {},\r\n        notchedOutline: {}\r\n      }));\r\n      const outlinedInputClasses = useOutlinedInputStyles();\r\n\r\n    return (\r\n        <ListItem key={student['id']} role={undefined} dense button onClick={toggleStatus} className={classes.root}>\r\n            <FormControl variant=\"outlined\" className={classes.formControl}>\r\n        \r\n            <Select\r\n            labelId=\"demo-simple-select-outlined-label\"\r\n            id=\"demo-simple-select-outlined\"\r\n            value={status}\r\n            onChange={handleChange}\r\n            className={classes.selectStatus}\r\n            onClick={(e) => e.stopPropagation()}\r\n            input={\r\n                <OutlinedInput\r\n                  id=\"outlined-age-simple\"\r\n                  classes={outlinedInputClasses}\r\n                />}\r\n            >\r\n                <MenuItem value={STATUS_ATTENDANCE}>{t(\"attended\")}</MenuItem>\r\n                <MenuItem value={STATUS_ABSENT}>{t(\"absent\")}</MenuItem>\r\n                <MenuItem value={STATUS_ABSENT_JUSTIFIED}>{t(\"absent-justified\")}</MenuItem>\r\n                </Select>\r\n            </FormControl>\r\n            <Box px={2}>\r\n            <Tooltip title={t(\"add-comment\")}>\r\n                <IconButton color=\"secondary\" aria-label={t(\"add-comment\")} onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handleOpenCommentBox();\r\n                    }}>\r\n                    <InsertCommentIcon />\r\n                </IconButton>\r\n            </Tooltip>\r\n            </Box>\r\n            <ListItemText id={labelId} primary={student[\"full_name\"]} />\r\n        </ListItem>\r\n    );\r\n}","export const STATUS_ATTENDANCE = 0;\r\nexport const STATUS_ABSENT = 1;\r\nexport const STATUS_ABSENT_JUSTIFIED = 2;\r\n","import React from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport {Button} from \"@material-ui/core\";\r\n\r\nexport default function CommentDialog({commentBox, setCommentBoxValue, handleCloseCommentBox, commentBoxValue, handleCloseCancelCommentBox}){\r\n    const { t } = useTranslation();\r\n\r\n    return <Dialog open={commentBox} onClose={handleCloseCommentBox} aria-labelledby=\"form-dialog-title\">\r\n    <DialogTitle id=\"form-dialog-title\">{t(\"comment\")}</DialogTitle>\r\n    <DialogContent>\r\n      <TextField\r\n        value={commentBoxValue}\r\n        onChange={(event) => {\r\n          setCommentBoxValue(event.target.value);\r\n        }}\r\n        autoFocus\r\n        margin=\"dense\"\r\n        multiline\r\n        rows={4}\r\n        variant=\"outlined\"\r\n        fullWidth\r\n      />\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button onClick={handleCloseCancelCommentBox} color=\"primary\">\r\n        {t(\"cancel\")}\r\n      </Button>\r\n      <Button onClick={handleCloseCommentBox} color=\"primary\">\r\n        {t(\"save\")}\r\n      </Button>\r\n    </DialogActions>\r\n</Dialog>;\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {Checkbox, ListItem, ListItemIcon, Button, ListItemText, Tooltip} from \"@material-ui/core\";\r\nimport CourseStudentsDataService from \"../../_services/course_students.service\";\r\nimport {attendanceService} from \"../../_services/course_attendance.service\";\r\nimport AttendanceService from \"../../_services/attendance.service\";\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport dataService from \"../../_services/courses.service\";\r\nimport * as yup from \"yup\";\r\nimport {useFormik} from \"formik\";\r\nimport {useErrorHandler} from \"../../_helpers/handle-response\";\r\nimport EmailTo from \"../../_components/emailTo.component\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport DirtyTextField from \"../../_components/dirtytextfield.component\";\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport List from \"@material-ui/core/List\";\r\nimport {STATUS_ATTENDANCE, STATUS_ABSENT, STATUS_ABSENT_JUSTIFIED} from './status';\r\nimport AttendanceItem from './attendance.component.item';\r\nimport DoneAllIcon from '@material-ui/icons/DoneAll';\r\nimport EventAvailableIcon from '@material-ui/icons/EventAvailable';\r\nimport EventBusyIcon from '@material-ui/icons/EventBusy';\r\nimport CommentDialog from './commentDialog';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100%',\r\n    [theme.breakpoints.down('sm')]: {paddingBottom: '100px'}\r\n  },\r\n    textBox: {\r\n      width: \"100%\",\r\n        border: \"red\"\r\n    },\r\n    line: {\r\n        width: \"100%\",\r\n        marginTop: theme.spacing(1)\r\n    },\r\n    composite: {\r\n        display: \"flex\", flexDirection: \"row\", flex: 1, flexWrap: \"wrap\",\r\n        gap: theme.spacing(1), width: \"100%\"\r\n    },\r\n    chip: {\r\n      margin: theme.spacing(0.5)\r\n    },\r\n    chips: {\r\n      marginBottom: theme.spacing(1)\r\n    },\r\n    in: {\r\n      marginBottom: theme.spacing(1)\r\n    },fabs: {\r\n    position: 'fixed',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4),\r\n  },fab: {\r\n    marginLeft: theme.spacing(2),\r\n  }\r\n}));\r\n\r\nfunction areArraysEqualSets(a1, a2) {\r\n  const superSet = {};\r\n  for (const i of a1) {\r\n    const e = i + typeof i;\r\n    superSet[e] = 1;\r\n  }\r\n\r\n  for (const i of a2) {\r\n    const e = i + typeof i;\r\n    if (!superSet[e]) {\r\n      return false;\r\n    }\r\n    superSet[e] = 2;\r\n  }\r\n\r\n  for (let e in superSet) {\r\n    if (superSet[e] === 1) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n\r\nexport default function Attendance({...other}) {\r\n  const classes = useStyles();\r\n  const { t } = useTranslation();\r\n\r\n  const id = new URLSearchParams(window.location.search).get('id');\r\n\r\n  const [initialAttendances, setInitialAttendances] = useState(null);\r\n  const [attendances, setAttendances] = useState(null);\r\n  const resetAttendances = () => setAttendances(createEmptyAttendances(students, initialAttendances, date));\r\n\r\n\r\n  const getAddedStudentIds = () => {\r\n    const studentsInInitial = Object.keys(initialAttendances);\r\n    return Object.keys(attendances).filter(studentId => !studentsInInitial.includes(studentId) && \r\n    (attendances[studentId]['status'] !== null || attendances[studentId]['comment'] !== null))\r\n  }\r\n\r\n  const hasNewAttendances = () => {\r\n    const addedStudentIds = getAddedStudentIds();\r\n    if (addedStudentIds.length === 0) return false;\r\n    return true;\r\n  }\r\n\r\n  const getNewAttendances = () => {\r\n    const addedStudentIds = getAddedStudentIds();\r\n    if (addedStudentIds.length === 0) return null;\r\n\r\n    const filtered = Object.keys(attendances)\r\n      .filter(key => addedStudentIds.includes(key))\r\n      .reduce((obj, key) => {\r\n        obj[key] = attendances[key];\r\n        return obj;\r\n      }, {});\r\n    return filtered;\r\n  }\r\n\r\n  const hasChanges = (initial, updated) => {\r\n    console.log(\"iu\", initial, updated);\r\n    if (initial['student_id'] !== updated['student_id']) throw new Error(`student id has changed from ${initial['student_id']} to ${updated['student_id']}`);\r\n    if (initial['course_id'] !== updated['course_id']) throw new Error(`course id has changed from ${initial['course_id']} to ${updated['course_id']}`);\r\n    if (initial['date'] !== updated['date']) return true;\r\n    if (initial['comment'] !== updated['comment']) return true;\r\n    if (initial['status'] !== updated['status']) return true;\r\n    return false;\r\n  }\r\n\r\n  const hasChangesGlobal = () => {\r\n    if (initialAttendances === null) return false;\r\n    if (attendances === null) return false;\r\n    if (hasNewAttendances()) return true;\r\n    if (hasUpdatedAttendances()) return true;\r\n    return false;\r\n  }\r\n\r\n  const [dirty, setDirty] = useState(false);\r\n  useEffect(() => {\r\n    setDirty(hasChangesGlobal());\r\n  }, [initialAttendances, attendances]);\r\n\r\n  const hasUpdatedAttendances = () => Object.keys(initialAttendances).some(key => \r\n    hasChanges(initialAttendances[key], attendances[key]));\r\n\r\n  const getUpdatedAttendances = () => {\r\n    const filtered = Object.keys(initialAttendances)\r\n      .reduce((obj, key) => {\r\n        if (hasChanges(initialAttendances[key], attendances[key])) obj[key] = attendances[key];\r\n        return obj;\r\n      }, {});\r\n    return filtered;\r\n  }\r\n\r\n  const [students, setStudents] = useState(null);\r\n  const [courseId, setCourseId] = useState(id);\r\n  const [allDone, setAllDone] = useState(true);\r\n  \r\n\r\n  useEffect(() => {\r\n    if (attendances === null) return;\r\n    const allDone = !Object.keys(attendances).some(studentId => attendances[studentId]['status'] !== STATUS_ATTENDANCE);\r\n    setAllDone(allDone);\r\n  }, [attendances]);\r\n\r\n    const createEmptyAttendances = (students, attendances, date) => {\r\n      if (attendances === null) return;\r\n      if (students === null) return;\r\n      \r\n      const newAttendances = {...attendances};\r\n\r\n      students.forEach(student => {\r\n        const id = student['id'];\r\n        if (attendances[id] === undefined) {\r\n          newAttendances[id] = {\r\n            status: null,\r\n            comment: null,\r\n            course_id: courseId,\r\n            student_id: id,\r\n            date: date\r\n          };\r\n        } \r\n      });\r\n      return newAttendances;\r\n    }\r\n\r\n    const loadAttendances = () => {\r\n      if (courseId === null) return;\r\n      if (formik.values[\"start\"] === '') return;\r\n      if (students === null) return;\r\n      \r\n      AttendanceService \r\n        .getAll(null,  \"*\", null, {\r\n            course_id: courseId,\r\n            date: formik.values[\"start\"]\r\n          }\r\n        )\r\n        .then(...errorHandler({}))\r\n        .then(function (res) {\r\n          const newAttendances = res[\"data\"].reduce((a,x) => ({...a, [x['student_id']]: x}), {});\r\n          setInitialAttendances(newAttendances);\r\n          setAttendances(createEmptyAttendances(students, newAttendances, date));\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (courseId === null) return;\r\n        CourseStudentsDataService\r\n            .getAll(null, '*', [\"full_name\", \"id\"], {enrolment_status: \"enrolled\"}, courseId)\r\n            .then(...errorHandler({}))\r\n            .then(function (res) {\r\n                setStudents(res[\"data\"]);\r\n            });\r\n    }, [courseId]);\r\n\r\n    \r\n  const errorHandler = useErrorHandler();\r\n  const today = new Date().toISOString().split(\"T\")[0];\r\n\r\nconst formik = useFormik({\r\n      initialValues: {start: today, course_id: id},\r\n      validationSchema: yup.object({}),\r\n      enableReinitialize: true,\r\n      onSubmit: (values, {setStatus, setSubmitting}) => {\r\n          setSubmitting(true);\r\n      }\r\n  });\r\n  const date = formik.values['start'];\r\n\r\n  useEffect(loadAttendances, [formik.values[\"start\"], courseId, students]);\r\n\r\n  const markAll = (targetStatus) => {\r\n    const newAttendances = {...attendances};\r\n    Object.keys(newAttendances).map(function(studentId, index) {\r\n      newAttendances[studentId]['status'] = targetStatus;\r\n    });\r\n    setAttendances(newAttendances);\r\n  }\r\n\r\n  const setAttendance = (studentId, attendance) => {\r\n    const newAttendances = {...attendances};\r\n    newAttendances[studentId] = attendance;\r\n    setAttendances(newAttendances);\r\n  }\r\n\r\n  const [commentBox, setCommentBox] = useState(false);\r\n  const handleCloseCancelCommentBox = () => {\r\n    setCommentBox(false);\r\n  }\r\n  const handleCloseCommentBox = () => {\r\n    handleCloseCancelCommentBox();\r\n    setAttendance(commentBoxId, {...attendances[commentBoxId], comment: commentBoxValue});\r\n  }\r\n  const handleOpenCommentBox = (studentId) => {\r\n    setCommentBoxValue(attendances[studentId]['comment']);\r\n    setCommentBox(true);\r\n    setCommentBoxId(studentId);\r\n  }\r\n  const [commentBoxValue, setCommentBoxValue] = useState(null);\r\n  const [commentBoxId, setCommentBoxId] = useState(null);\r\n\r\n  \r\n\r\n  return (\r\n      <div>\r\n        <CommentDialog \r\n          commentBox={commentBox}\r\n          handleCloseCommentBox={handleCloseCommentBox}\r\n          commentBoxValue={commentBoxValue}\r\n          handleCloseCancelCommentBox={handleCloseCancelCommentBox}\r\n          setCommentBoxValue={setCommentBoxValue}\r\n          />\r\n         \r\n          {false && <EmailTo\r\n            formik={formik}\r\n            style={{width: \"100%\"}}\r\n            options={[]}\r\n            addTo={x => {setCourseId(x.id)}}\r\n            name={\"course_id\"}\r\n            label={t(\"courses\")}\r\n        />}\r\n        <Box p={2}>\r\n          <h1>{t(\"attendance\")}</h1>\r\n          <Box className={[classes.line, classes.composite]}>\r\n            \r\n              <DirtyTextField\r\n                  label={t(\"date\")}\r\n                  type=\"date\"\r\n                  style={{flex: 1}}\r\n                  noDirty={true}\r\n                  name=\"start\"\r\n                  formik={formik}\r\n                  InputLabelProps={{shrink: true}}/>\r\n          </Box>\r\n        </Box>\r\n        \r\n          {students && <List className={classes.root}>\r\n            \r\n      {attendances && students && students.map((student) => <AttendanceItem\r\n        student={student}\r\n        setAttendance={(x) => setAttendance(student['id'], x)}\r\n        handleOpenCommentBox={() => handleOpenCommentBox(student['id'])}\r\n        attendance={attendances[student['id']] ?? null} \r\n      />)}\r\n    </List>}\r\n          <div className={classes.fabs}>\r\n          <Tooltip title={t(\"mark-all\")}>\r\n                <Fab className={classes.fab} color=\"secondary\" onClick={() => {\r\n                    markAll(allDone? STATUS_ABSENT: STATUS_ATTENDANCE);\r\n                  }} disabled={formik.isSubmitting}>\r\n                    {allDone? <EventBusyIcon/>: <EventAvailableIcon/>}\r\n                </Fab>\r\n            </Tooltip>\r\n              <Tooltip title={t(\"reset\")}>\r\n                <Fab className={classes.fab} color=\"secondary\" onClick={resetAttendances} disabled={formik.isSubmitting || !dirty}>\r\n                    <CloseIcon/>\r\n                </Fab>\r\n            </Tooltip>\r\n           <Tooltip title={t(\"save\")}>\r\n                <Fab className={classes.fab} color=\"primary\" onClick={() => {\r\n                  let promises = [];\r\n\r\n                  const newAttendances = getNewAttendances();\r\n                  if (newAttendances !== null) {\r\n                    Object.keys(newAttendances).forEach(studentId => {\r\n                      const attendance = newAttendances[studentId];\r\n                      promises.push(AttendanceService.post(attendance))\r\n                    })\r\n                  }\r\n                  \r\n\r\n                  const updatedAttendances = getUpdatedAttendances();\r\n                  if (updatedAttendances !== null) {\r\n                    Object.keys(updatedAttendances).forEach(studentId => {\r\n                      const attendance = updatedAttendances[studentId];\r\n                      const initialAttendance = initialAttendances[studentId];\r\n                      promises.push(AttendanceService\r\n                        .patch({\r\n                          id:initialAttendance['id'], \r\n                          body:attendance, \r\n                          initial_values:initialAttendance\r\n                        }));\r\n                    })\r\n                  }\r\n\r\n                  Promise.all(promises)\r\n                  .then(...errorHandler({}))\r\n                  .then(function (res) {\r\n                    loadAttendances();\r\n                  })\r\n                }} disabled={formik.isSubmitting || !dirty}>\r\n                    <SaveIcon/>\r\n                </Fab>\r\n            </Tooltip>\r\n          </div>\r\n\r\n      </div>\r\n  );\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport XamfraHeader from '../_components/xamfra.header.component';\r\nimport HomeButton from '../_components/home_button';\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport ThemeButton from \"../_components/theme_button.component\";\r\nimport TranslateButton from \"../_components/translate_button.component\";\r\nimport Attendance from \"./components/attendance.component\";\r\nimport TeacherDashboardButton from '../_components/teacher_dashboard_button';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    list: {\r\n        flexGrow: 4\r\n    },\r\n    listCard: {\r\n        height: '100%'\r\n    },\r\n    header: {\r\n    },\r\n    rootBase: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        height: \"100vh\",\r\n        minHeight: 0,\r\n        alignItems: 'stretch'\r\n    },\r\n    more: {\r\n        width: '100%',\r\n        textAlign: 'center'\r\n    }\r\n}));\r\n\r\nconst AttendancePage = (props) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Box className={classes.rootBase}>\r\n            <XamfraHeader>\r\n            <HomeButton/>\r\n                <TranslateButton/>\r\n                <ThemeButton/>\r\n                <TeacherDashboardButton/>\r\n            </XamfraHeader>\r\n            <Box p={2}>\r\n                <Attendance/>\r\n            </Box>\r\n        </Box>\r\n        );\r\n}\r\n\r\nexport default AttendancePage;","import React, {useState} from 'react';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport {createMuiTheme} from '@material-ui/core/styles';\r\nimport {ThemeProvider} from '@material-ui/styles';\r\nimport {darkTheme, lightTheme} from '../theme';\r\nimport {SnackbarProvider} from 'notistack';\r\n\r\nimport PrivateRoute from '../_components/PrivateRoute';\r\nimport HomePage from '../HomePage/HomePage';\r\nimport LoginPage from '../LoginPage/LoginPage';\r\nimport {BrowserRouter, Route, Router, Switch} from 'react-router-dom';\r\nimport {userContext} from '../_context/user-context';\r\nimport {themeContext} from '../_context/theme-context';\r\nimport SignupPage from \"../SignupPage/SignupPage\";\r\nimport ResetPage from \"../ResetPage/ResetPage\";\r\nimport PreEnrolmentPage from \"../PreEnrolmentPage/PreEnrolmentPage\";\r\nimport TeacherDashboardPage from \"../TeacherDashboardPage/TeacherDashboardPage\";\r\nimport NotFound from \"../_components/not_found\";\r\nimport AttendancePage from '../AttendancePage/AttendancePage';\r\n\r\nfunction App() {\r\n    const [theme, setTheme] = useState(localStorage.getItem(\"darkTheme\") === \"true\");\r\n    const appliedTheme = createMuiTheme(theme ? darkTheme : lightTheme);\r\n\r\n\r\n    const [user, setUser] = useState({logged: false, ping: true});\r\n    const [needs, _setNeeds] = useState([]);\r\n    const setNeeds = (needs) => {\r\n        if (!Array.isArray(needs)) return _setNeeds([]);\r\n        return _setNeeds(needs);\r\n    }\r\n    const [teacher, setTeacher] = useState(null);\r\n    const routerRef = React.createRef();\r\n\r\n\r\n    return (\r\n      <ThemeProvider theme={appliedTheme}>\r\n        <CssBaseline />\r\n        <SnackbarProvider maxSnack={3}>\r\n            <userContext.Provider value={{\r\n                user: user, \r\n                setUser: setUser, \r\n                \r\n                needs: needs, \r\n                setNeeds: setNeeds,\r\n                \r\n                teacher: teacher,\r\n                setTeacher: setTeacher}}>\r\n                <themeContext.Provider value={{theme: theme, switchTheme: () => {\r\n                    localStorage.setItem(\"darkTheme\", (!theme).toString());\r\n                    setTheme(!theme);\r\n                }, label: theme? \"dark\": \"light\"}}>\r\n                    <BrowserRouter  ref={routerRef} basename=\"/app\">\r\n                        <Switch>\r\n                        <PrivateRoute path={'/home'} baseRouter={routerRef} component={HomePage}/>\r\n                        <Route path={'/login'} component={LoginPage}/>\r\n                        <Route path={'/signup'} component={SignupPage}/>\r\n                        <Route path={'/password-reset'} component={ResetPage}/>\r\n                        <Route path={'/prematricula'} component={PreEnrolmentPage}/>\r\n                        <PrivateRoute path={'/teacher-dashboard'} component={TeacherDashboardPage}/>\r\n                        <PrivateRoute path={'/attendance'} component={AttendancePage}/>\r\n                        <Route component={NotFound}/>\r\n                        </Switch>\r\n                    </BrowserRouter>\r\n                </themeContext.Provider>\r\n            </userContext.Provider>\r\n        </SnackbarProvider>\r\n      </ThemeProvider>\r\n    );\r\n}\r\n\r\nexport default App\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App/App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport {Helmet} from 'react-helmet';\r\nimport \"./i18nextConf\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n      <Helmet>\r\n          <title>centrífuga4</title>\r\n                <base href={`${process.env.PUBLIC_URL}/`}/>\r\n          <link nonce=\"{{csp_nonce()}}\" rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap\" />\r\n          <link nonce=\"{{csp_nonce()}}\" rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\r\n          <meta\r\n              name=\"viewport\"\r\n              content=\"minimum-scale=1, initial-scale=1, width=device-width\"/>\r\n      </Helmet>\r\n      <App/>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}